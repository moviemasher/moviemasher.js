<!DOCTYPE html>
<html>
  <head>
    <script type="module">
export class TestAncestor extends HTMLElement {
  constructor() {
    super()
    const shadow = this.attachShadow({ mode: 'open' })
    shadow.innerHTML = `<blockquote>
      <label part='label'>Ancestor</label>
      <test-grandparent 
        exportparts='
          label:grandparent-label,child1-label:grandparent-child1-label,child1-child1-label:grandparent-child1-child1-label,child1-child2-label:grandparent-child1-child2-label, 
          span:grandparent-span,child1-span:grandparent-child1-span,child1-child1-span:grandparent-child1-child1-span,child1-child2-span:grandparent-child1-child2-span,
          text:grandparent-text,child1-text:grandparent-child1-text,child1-child1-text:grandparent-child1-child1-text,child1-child2-text:grandparent-child1-child2-text
        ' 
        part='grandparent'
      ></test-grandparent>
    </blockquote>`
  }
}
window.customElements.define('test-ancestor', TestAncestor)


export class TestGrandparent extends HTMLElement {
  constructor() {
    super()
    const shadow = this.attachShadow({ mode: 'open' })
    shadow.innerHTML = `<blockquote>
      <label part='label'>Grandparent</label>
      <test-parent 
      exportparts='
        label:parent-label,child1-label:parent-child1-label,label:child2-label,child2-label:parent-child2-label,
        span:parent-span,child1-span:parent-child1-span,span:child2-span,child2-span:parent-child2-span,
        text:parent-text,child1-text:parent-child1-text,text:child2-text,child2-text:parent-child2-text
      ' 
      part='parent'></test-parent>
    </blockquote>`
  }
}
window.customElements.define('test-grandparent', TestGrandparent)



export class TestParent extends HTMLElement {
  constructor() {
    super()
    const shadow = this.attachShadow({ mode: 'open' })
    shadow.innerHTML = `<blockquote>
      <label part='label'>Parent</label>
      <span part='span'>!</span>
      <test-child 
        exportparts='
          label:child1-label,span:child1-span,
          label:child1-label,text:child1-text,
        ' 
        part='child1'
      ></test-child>
      <test-child 
        exportparts='
          label:child2-label,span:child2-span,
          label:child2-label,text:child2-text,
        ' 
      part='child2'
    ></test-child>
    </blockquote>`
  }
}
window.customElements.define('test-parent', TestParent)

export class TestChild extends HTMLElement {
  constructor() {
    super()
    const shadow = this.attachShadow({ mode: 'open' })
    shadow.innerHTML = `<blockquote>
      <label part='label text'>Child</label>
      <span part='span text'>!</span>
    </blockquote>`
  }
}
window.customElements.define('test-child', TestChild)


    </script>
    <style>
      test-ancestor::part(child1-child1-text) {
        border-radius: var(--border-radius);
        border: 2px solid orangered;
        color: orangered
      }
    </style>
  </head>
  <body>
    <test-ancestor></test-ancestor>
  </body>
</html>