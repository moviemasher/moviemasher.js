version: "3"
services:
  tester:
    # entrypoint: bash
    build:
      dockerfile: dev/test/Dockerfile.cnf
      context: ../../
    image: moviemasher/moviemasher.tester:5.0.7
    container_name: moviemasher-tester
    command: test.e2e.ts
    volumes:
      - ../../temporary/test:/home/node/app/temporary/test
      - ../../dev/:/home/node/app/dev/
      - ./package.json:/home/node/app/package.json
      - ./jest-puppeteer.config.js:/home/node/app/jest-puppeteer.config.js
      - ../../packages/:/home/node/app/packages/
      - ../../workspaces/example-react/:/home/node/app/workspaces/example-react/
      - ../../workspaces/example-express-react/:/home/node/app/workspaces/example-express-react/
      - ../tester/:/home/node/app/workspaces/tester/
  jester:
    build:
      dockerfile: dev/test/Dockerfile.cnf
      context: ../../
    image: moviemasher/moviemasher.tester:5.0.7
    container_name: moviemasher-jester
    entrypoint: npm run jest
    command: test.ts
    volumes:
      - ../../temporary/test:/home/node/app/temporary/test
      - ../../dev/:/home/node/app/dev/
      - ./package.json:/home/node/app/package.json
      - ../../packages/:/home/node/app/packages/
      - ../../workspaces/example-react/:/home/node/app/workspaces/example-react/
      - ../../workspaces/example-express-react/:/home/node/app/workspaces/example-express-react/
