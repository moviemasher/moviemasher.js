"use strict";(self.webpackChunk_moviemasher_example_supabase=self.webpackChunk_moviemasher_example_supabase||[]).push([[94],{6094:function(e,n,r){r.r(n),r.d(n,{ActivityType:function(){return ee},ClientClass:function(){return b},ClientDefaultArgs:function(){return T},ClientDisabledArgs:function(){return A},Config:function(){return M},DecodeOperation:function(){return E},DragElementPoint:function(){return X},DragElementRect:function(){return K},DragSuffix:function(){return k},EncodeOperation:function(){return y},Operations:function(){return P},ReadOperation:function(){return v},TranscodeOperation:function(){return h},TransferTypeFiles:function(){return H},WriteOperation:function(){return m},assertDragDefinitionObject:function(){return j},assertDragOffsetObject:function(){return N},audioBufferPromise:function(){return _},audioDataPromise:function(){return R},clientInstance:function(){return S},config:function(){return O},dragData:function(){return z},dragMediaType:function(){return q},dragType:function(){return J},dragTypes:function(){return W},dropFilesFromList:function(){return Y},dropType:function(){return L},droppingPositionClass:function(){return G},fetchPromise:function(){return w},imageDataPromise:function(){return B},isDragDefinitionObject:function(){return V},isDragOffsetObject:function(){return F},isOperation:function(){return g},isTransferType:function(){return x},jsonPromise:function(){return I},pixelFromFrame:function(){return $},pixelPerFrame:function(){return Q},videoDataPromise:function(){return C}});var t,o,i,a,u,s=r(885),d=r(1413),c=r(5671),p=r(3144),f=r(4942),l=r(2994),v="read",m="write",h="transcode",y="encode",E="decode",P=[v,m,h,y,E],g=function(e){return P.includes(e)},A=(t={},(0,f.Z)(t,v,!1),(0,f.Z)(t,m,!1),(0,f.Z)(t,E,!1),(0,f.Z)(t,y,!1),(0,f.Z)(t,h,!1),t),T=(i={},(0,f.Z)(i,E,{autoDecode:(o={},(0,f.Z)(o,l.AudioType,[{type:l.ProbeType,options:{types:[l.DurationProbe]}}]),(0,f.Z)(o,l.ImageType,[{type:l.ProbeType,options:{types:[l.AlphaProbe,l.SizeProbe]}}]),(0,f.Z)(o,l.VideoType,[{type:l.ProbeType,options:{types:[l.DurationProbe,l.SizeProbe,l.AlphaProbe,l.AudibleProbe]}}]),o)}),(0,f.Z)(i,y,{}),(0,f.Z)(i,v,{autoGet:{type:l.MashType,order:{created_at:l.OrderDecending}},getRequest:{endpoint:{pathname:l.Endpoints.data.definition.get}},listRequest:{endpoint:{pathname:l.Endpoints.data.definition.retrieve}}}),(0,f.Z)(i,h,{autoTranscode:(0,f.Z)({},l.AudioType,[{type:l.AudioType,options:{outputType:l.AudioType}}])}),(0,f.Z)(i,m,{accept:l.RawTypes.map((function(e){return"".concat(e,"/*")})),saveRequest:{endpoint:{pathname:l.Endpoints.data.definition.put}},deleteRequest:{endpoint:{pathname:l.Endpoints.data.definition.delete}},uploadRequest:{endpoint:{pathname:l.Endpoints.data.definition.retrieve}},uploadResponseIsRequest:!0,uploadCookedTypes:[]}),i),b=function(){function e(n){(0,c.Z)(this,e),this.options=n}return(0,p.Z)(e,[{key:"accept",value:function(e){var n=this.clientArgs(e).write;if(n){var r=n.accept;return(0,l.isArray)(r)?r.join(","):r}}},{key:"enabled",value:function(e){return(g(e)?[e]:P).every((function(e){}))}},{key:"get",value:function(e){throw new Error("Method not implemented.")}},{key:"list",value:function(e){throw new Error("Method not implemented.")}},{key:"save",value:function(e,n){var r=this.clientArgs(n);if((0,l.isMashMedia)(e))return this.saveMash(e,r);var t={step:0,steps:2,media:e,completed:0};this.saveMedia(e,t,r);return Promise.resolve({})}},{key:"clientArgs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.options,r=void 0===n?{}:n;return(0,d.Z)((0,d.Z)((0,d.Z)({},T),r),e)}},{key:"saveMash",value:function(e,n){var r=this,t=e.definitionIds.filter(l.idIsTemporary).map((function(n){return e.media.fromId(n)})),o={step:0,steps:1,mash:e,media:e,completed:0};return this.saveMedias(t,o,n).then((function(t){return t.error?t:r.saveMediaRow(e,o,n)}))}},{key:"errorPromise",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l.ErrorName.Internal;return Promise.resolve((0,l.error)(e))}},{key:"saveMediaRow",value:function(e,n,r){var t=e.id,o=(e.type,r[m]);if(!o)return this.errorPromise();var i=o.saveRequest;if(!i)return this.errorPromise();var a=(0,d.Z)({},i);a.init||(a.init={});var u={definition:(0,d.Z)({id:t},e.toJSON())};return a.init.body=u,(0,l.requestRecordPromise)(a).then((function(r){(0,l.assertIdentified)(r);r.id;var t=r.error;return n.step++,{error:t,data:e}}))}},{key:"saveAutoDecodings",value:function(e,n,r){return Promise.resolve((0,l.error)(l.ErrorName.ClientDisabledDelete))}},{key:"upload",value:function(e,n,r){return Promise.resolve((0,l.error)(l.ErrorName.ClientDisabledDelete))}},{key:"saveUpload",value:function(e,n,r){var t=e.id;return(0,l.idIsTemporary)(t)?this.upload(e,n,r):this.saveMediaRow(e,n,r)}},{key:"saveAutoTranscodings",value:function(e,n,r){return Promise.resolve((0,l.error)(l.ErrorName.ClientDisabledDelete))}},{key:"saveMedia",value:function(e,n,r){return Promise.resolve((0,l.error)(l.ErrorName.ClientDisabledDelete))}},{key:"updateMedia",value:function(e,n,r){var t=e.id,o=e.id||r.id;(0,l.assertPopulatedString)(o);var i=r||n.media.fromId(t),a=i.id,u=a!==o;return console.log(this.constructor.name,"updateDefinition",u,e),u&&(n.media.updateDefinitionId(i.id,o),console.log(this.constructor.name,"updateDefinition called updateDefinitionId",i.id,o),Object.assign(i,e),(0,l.isMedia)(i)&&(delete i.file,delete i.request.response,(0,l.isVideoMedia)(i)?delete i.loadedVideo:(0,l.isUpdatableDurationDefinition)(i)?delete i.loadedAudio:(0,l.isImageMedia)(i)&&delete i.loadedImage)),u?(n.tracks.flatMap((function(e){return e.clips})).forEach((function(e){e.containerId===a&&e.setValue(t,"containerId"),e.contentId===a&&e.setValue(t,"contentId")})),n.reload()||Promise.resolve()):Promise.resolve()}},{key:"saveMedias",value:function(e,n,r){var t=this,o=Promise.resolve({});return e.forEach((function(e){o=o.then((function(o){return o.error?o:t.saveMedia(e,n,r)}))})),o}},{key:"decode",value:function(e){return Promise.resolve({type:l.ProbeType})}},{key:"encode",value:function(e,n){throw new Error("Method not implemented.")}},{key:"transcode",value:function(e){var n=(0,l.transcodingInstance)({type:l.VideoType,id:"",request:{endpoint:{}}});return Promise.resolve(n)}}]),e}(),S=function(){return new b(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})},M=((u=M||{}).SUPABASE_PROJECT_URL="MOVIEMASHER_SUPABASE_PROJECT_URL",u.SUPABASE_ANON_KEY="MOVIEMASHER_SUPABASE_ANON_KEY",u.SUPABASE_BUCKET="MOVIEMASHER_SUPABASE_BUCKET",u.SUPABASE_EXPIRES="MOVIEMASHER_SUPABASE_EXPIRES",u.SUPABASE_TABLE="MOVIEMASHER_SUPABASE_TABLE",u),D=(a={},(0,f.Z)(a,"MOVIEMASHER_SUPABASE_PROJECT_URL",""),(0,f.Z)(a,"MOVIEMASHER_SUPABASE_BUCKET","media"),(0,f.Z)(a,"MOVIEMASHER_SUPABASE_TABLE","media"),(0,f.Z)(a,"MOVIEMASHER_SUPABASE_ANON_KEY",""),(0,f.Z)(a,"MOVIEMASHER_SUPABASE_EXPIRES",60),a),O=function(e,n){return((0,l.isString)(n)||(0,l.isNumber)(n))&&(D[e]=n),D[e]||""},R=function(e){var n=e.endpoint;(0,l.assertEndpoint)(n);var r=(0,l.endpointUrl)(n);return(0,l.assertPopulatedString)(r,"url"),function(e){return fetch(e).then((function(e){return e.blob()})).then((function(e){return new Promise((function(n,r){var t=new FileReader;t.onload=function(){n(t.result)},t.onerror=r,t.readAsArrayBuffer(e)}))}))}(r).then(_)},_=function(e){return l.AudibleContextInstance.decode(e).then((function(e){return{data:e}})).catch((function(e){return(0,l.errorCaught)(e)}))},I=function(e){return w(e).then((function(e){return e.json()}))},w=function(e){var n,r=e.endpoint,t=e.init,o=void 0===t?{}:t;(0,l.assertEndpoint)(r);var i="Content-Type",a="application/json";switch(o.method||(o.method="POST"),o.headers||(o.headers={}),(n=o.headers)[i]||(n[i]=a),o.headers[i]){case a:o.body=JSON.stringify(o.body);break;case"multipart/form-data":var u=new FormData;Object.entries(o.body).forEach((function(e){var n=(0,s.Z)(e,2),r=n[0],t=n[1];(0,l.isUndefined)(t)||u.set(r,t instanceof Blob?t:String(t))})),o.body=u,delete o.headers[i]}var d=(0,l.urlForEndpoint)(r);return fetch(d,o)},B=function(e){var n=e.endpoint;(0,l.assertEndpoint)(n);var r=(0,l.endpointUrl)(n),t=new Image;return t.src=r,new Promise((function(e){t.onerror=function(){e((0,l.error)(l.ErrorName.Url))},t.onload=function(){e({data:t})}}))},C=function(e){var n=e.endpoint;(0,l.assertEndpoint)(n);var r=(0,l.endpointUrl)(n);return new Promise((function(e){var n=function(e){var n=globalThis.document;n||(0,l.errorThrow)(l.ErrorName.Environment);var r=n.createElement("video");return r.src=e,r}(r);n.oncanplay=function(){n.oncanplay=null,n.onerror=null;var r=n.videoWidth,t=n.clientWidth,o=n.videoHeight,i=n.clientHeight,a=r||t,u=o||i;n.width=a,n.height=u,e({data:n})},n.onerror=function(n){e((0,l.errorCaught)(n))},n.autoplay=!1,n.load()}))},U=function(e,n){return fetch(e,n).then((function(e){return e.arrayBuffer()}))},Z=function(e,n){var r=e.endpoint,t=e.init;(0,l.assertEndpoint)(r);var o={init:t,endpoint:(0,l.endpointAbsolute)(r)};switch(n){case l.ImageType:return B(o);case l.AudioType:return function(e){var n=e.endpoint,r=e.init;(0,l.assertEndpoint)(n);var t=(0,l.endpointUrl)(n);return U(t,r).then(_)}(o);case l.VideoType:return C(o);case l.FontType:return function(e){var n=e.endpoint,r=e.init;(0,l.assertEndpoint)(n);var t=(0,l.endpointUrl)(n),o=fetch(t,r).then((function(e){var n=e.headers.get("content-type")||"";return!(0,l.isPopulatedString)(n)||n.startsWith(l.FontType)?e.arrayBuffer():((0,l.assertTrue)(n.startsWith(l.CssContentType)),e.text().then((function(e){var n=(0,l.urlFromCss)(e);return U(n)})))})),i=function(e){return e.replaceAll(/[^a-z0-9]/gi,"_")}(t);return o.then((function(e){return new FontFace(i,e).load()})).then((function(e){var n=globalThis.document.fonts;return n.add(e),n.ready.then((function(){return{data:e}}))}))}(o);case l.RecordType:case l.RecordsType:return I(o)}(0,l.errorThrow)(n,"LoadType","type")};l.Plugins[l.ProtocolType][l.HttpProtocol]={promise:Z,type:l.HttpProtocol},l.Plugins[l.ProtocolType][l.HttpsProtocol]={promise:Z,type:l.HttpsProtocol};l.Plugins[l.ProtocolType][l.BlobProtocol]={promise:function(e,n){switch(n){case l.AudioType:return R(e);case l.ImageType:return B(e);case l.VideoType:return C(e);case l.JsonType:return I(e);default:return Promise.resolve({path:""})}},type:l.BlobProtocol};var k="/x-moviemasher",F=function(e){return(0,l.isObject)(e)&&"offset"in e};function N(e){F(e)||(0,l.errorThrow)(e,"DragOffsetObject")}var V=function(e){return F(e)&&"mediaObject"in e&&(0,l.isObject)(e.mediaObject)};function j(e){V(e)||(0,l.errorThrow)(e,"DragDefinitionObject")}var H="Files",x=function(e){return(0,l.isString)(e)&&e.endsWith(k)},L=function(e){if(e)return e.types.find(x)},q=function(e){var n=e.split("/"),r=(0,s.Z)(n,1)[0];return(0,l.assertMediaType)(r),r},J=function(e){var n=L(e);if(n){var r=n.split("/"),t=(0,s.Z)(r,1)[0];return(0,l.isMediaType)(t)?t:void 0}},W=function(e){return e.types.filter((function(e){return e===H||x(e)}))},z=function(e,n){var r=n?"".concat(n).concat(k):W(e).find(x);if(!r)return{};var t=e.getData(r);return t?JSON.parse(t):{}},K=function(e){return e.getBoundingClientRect()},X=function(e,n){var r=n instanceof Element?K(n):n,t=r.x,o=r.y,i=e.clientY;return{x:e.clientX-t,y:i-o}},Y=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=[],t=e.length;if(!t)return r;for(var o=(0,l.isPopulatedObject)(n),i=n.extensions,a=void 0===i?{}:i,u=n.uploadLimits,s=a,d=void 0===u?{}:u,c=0;c<t;c++){var p=e.item(c);if(p){var f=p.name,v=p.size,m=p.type,h=(0,l.mediaTypeFromMime)(m);if((0,l.isRawType)(h)){var y=d[h];if(!o||(0,l.isAboveZero)(y)&&1024*y*1024>v){var E=f.toLowerCase().split(".").pop(),P=(0,l.isPopulatedString)(E),g=s[h];!o&&P||P&&(0,l.isArray)(g)&&g.includes(E)?r.push(p):r.push({label:f,value:E,error:"import.extension"})}else r.push({label:f,value:"".concat(y,"MB"),error:"import.bytes"})}else r.push({label:f,value:h,error:"import.type"})}}return console.log("dropFilesFromList infos",r),r},G=function(e){if((0,l.isUndefined)(e))return"";switch(e){case l.DroppingPosition.After:return l.ClassDroppingAfter;case l.DroppingPosition.Before:return l.ClassDroppingBefore;case l.DroppingPosition.None:return""}return l.ClassDropping},Q=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!e||!n)return 0;var t=n/e,o=Math.min(1,t),i=Math.max(1,t);return 1===r?i:r?o+(i-o)*r:o},$=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ceil";if(!e||!n)return 0;var t=e*n;return(0,l.roundWithMethod)(t,r)},ee=function(e){return e.Analyze="analyze",e.Complete="complete",e.Error="error",e.Load="load",e.Render="render",e}(ee||{})}}]);
//# sourceMappingURL=94.e67b6f9d.chunk.js.map