"use strict";(self.webpackChunk_moviemasher_example_supabase=self.webpackChunk_moviemasher_example_supabase||[]).push([[128],{128:function(e,t,n){n.r(t),n.d(t,{Activity:function(){return ke},ActivityContent:function(){return Se},ActivityContentContext:function(){return De},ActivityContentContextDefault:function(){return be},ActivityContext:function(){return Ee},ActivityContextDefault:function(){return ye},ActivityDefaultProps:function(){return Fe},ActivityGroup:function(){return fe},ActivityGroups:function(){return me},ActivityItem:function(){return xe},ActivityLabel:function(){return Pe},ActivityPicked:function(){return Ne},ActivityPicker:function(){return Me},ActivityProgress:function(){return Ie},Bar:function(){return Oe},BooleanTypeInput:function(){return Ft},Browser:function(){return et},BrowserContent:function(){return rt},BrowserContext:function(){return Ve},BrowserContextDefault:function(){return Le},BrowserControl:function(){return st},BrowserDefaultProps:function(){return pt},BrowserPicker:function(){return ct},Button:function(){return tn},ClipContext:function(){return mt},ClipContextDefault:function(){return ft},ClipItem:function(){return Tt},ColorGroupInput:function(){return Qt},CreateEditedControl:function(){return kt},DataGroupInputs:function(){return Kt},DataTypeInputs:function(){return Gt},DefinitionContext:function(){return nt},DefinitionContextDefault:function(){return tt},DefinitionDrop:function(){return Lt},DefinitionItem:function(){return dt},DefinitionSelect:function(){return Vt},EditorRedoButton:function(){return bt},EditorRemoveButton:function(){return Dt},EditorUndoButton:function(){return St},EmptyElement:function(){return At},EncodeControl:function(){return xt},IconTypeInput:function(){return Ht},InputContext:function(){return zt},InputContextDefault:function(){return Bt},Inspector:function(){return un},InspectorContent:function(){return dn},InspectorContext:function(){return It},InspectorContextDefault:function(){return Mt},InspectorDefaultProps:function(){return mn},InspectorMovable:function(){return Yt},InspectorPicked:function(){return pn},InspectorPicker:function(){return fn},InspectorProperties:function(){return en},InspectorProperty:function(){return $t},Masher:function(){return hn},MasherContext:function(){return Te},MasherContextDefault:function(){return ge},MasherDefaultProps:function(){return Hn},Mashing:function(){return Wn},MovablesGroupInput:function(){return nn},NumericTypeInput:function(){return Wt},OpacityGroupInput:function(){return rn},OptionGroupInput:function(){return ln},OptionTypeInput:function(){return Xt},Panel:function(){return Ae},PanelContent:function(){return qn},PanelFoot:function(){return je},PanelHead:function(){return Un},Panels:function(){return Vn},PercentTypeInput:function(){return Ut},Player:function(){return zn},PlayerButton:function(){return Tn},PlayerContent:function(){return gn},PlayerContext:function(){return En},PlayerContextDefault:function(){return yn},PlayerDefaultProps:function(){return Sn},PlayerNotPlaying:function(){return bn},PlayerPlaying:function(){return kn},PlayerTime:function(){return Dn},PlayerTimeControl:function(){return Cn},PointGroupInput:function(){return an},Problems:function(){return we},RgbTypeInput:function(){return _t},SaveControl:function(){return Pt},SelectEditedControl:function(){return Ot},SizeGroupInput:function(){return cn},Slider:function(){return qt},TextTypeInput:function(){return Jt},Timeline:function(){return Ln},TimelineAddClipControl:function(){return Gn},TimelineAddTrackControl:function(){return Rn},TimelineContent:function(){return On},TimelineContext:function(){return Et},TimelineContextDefault:function(){return yt},TimelineDefaultProps:function(){return Bn},TimelineDefaultZoom:function(){return Fn},TimelineScrubber:function(){return In},TimelineScrubberElement:function(){return xn},TimelineSizer:function(){return wn},TimelineTrack:function(){return Pn},TimelineTrackIcon:function(){return An},TimelineTracks:function(){return Mn},TimelineZoom:function(){return jn},TimelineZoomer:function(){return Nn},TrackContext:function(){return ht},TrackContextDefault:function(){return vt},TweenInputKey:function(){return jt},VideoView:function(){return Xn},View:function(){return ie},ViewControl:function(){return Rt},activityLabel:function(){return pe},assertActivityGroup:function(){return he},elementSetPreviewSize:function(){return vn},isActivityGroup:function(){return ve},labelInterpolate:function(){return de},labelLookup:function(){return se},labelObjects:function(){return ce},labelTranslate:function(){return ue},labels:function(){return le},panelOptionsStrict:function(){return Re},propsMediaTypes:function(){return it},propsSelectTypes:function(){return ot},sessionGet:function(){return _n},sessionSet:function(){return Jn},useApiDefinitions:function(){return Qe},useClient:function(){return Ue},useClip:function(){return Ct},useDefinition:function(){return ut},useEditor:function(){return _e},useEditorActivity:function(){return Ce},useEditorDefinitions:function(){return qe},useListeners:function(){return Zt},useRefresh:function(){return $e}});var r,a,i,o,c=n(9142),l=n(4165),s=n(5861),u=n(4942),d=n(2982),p=n(885),f=n(4925),m=n(7762),v=n(1413),h=n(2791),y=n(2994),E=n(827),Z=n(5083),g=["initialPicked","initialCollapsed","className"],T=["children"],C=["collapsed"],k=["id","className","children"],b=["initialPicked"],D=["className","children"],S=["children","type","types","className","id"],x=["children"],P=["className","iconRatio"],w=["className"],N=["children"],M=["children"],I=["children","type"],O=["children"],R=["children"],A=["children"],j=["children"],G=["children"],B=["type","types","children","className"],z=["selectType","selectedItems"],F=["property","className","removeHandler","index","movable","selected","select"],L=["useView","selected"],V=["disabled","className"],H=["movableGenerator","selectedMovable","property"],W=["selectType","selectedItems"],q=["selectType","selectedItems"],U=["selectType","selectedItems"],_=["selectType","selectedItems","dataGroup"],J=["editType","clientOptions","previewSize","icons","mashMedia"],X=["children","className"],K=["className","children"],Q=["className","inactive","styleHeight","styleWidth"],Y=["className"],$=["children"],ee=["className","icons"],te=["zoom","children"],ne=["children"],re=["disabled"],ae=["panels"],ie=h.forwardRef((function(e,t){return h.createElement("div",(0,v.Z)({ref:t},e))})),oe=/{{([a-z0-9_]*)}}/,ce={internal:"Internal Error",client:{internal:"Internal Client Error"},import:{bytes:"Size above {{value}}",extension:"Extension {{value}}",type:"Type {{value}}",size:"Dimensions {{value}}",duration:"Duration {{value}}",render:"{{value}}",displaySize:"{{width}}x{{height}}"}},le={audible:"Audible",clip:"Clip",update:"Save",delete:"Remove {{type}}",unlabeled:"Unlabeled {{type}}",analyze:"Analyzing...",load:"Loading...",complete:"Completed",create:"New",render:"Render",view:"View",open:"Open...",undo:"Undo",redo:"Redo",mash:"Mash"},se=function(e){var t,n=ce,r=e.split("."),a=(0,m.Z)(r);try{for(a.s();!(t=a.n()).done;){var i=n[t.value];if((0,y.isString)(i))return i;n=i}}catch(o){a.e(o)}finally{a.f()}return""},ue=function(e){return e.includes(".")?se(e):le[e]||e},de=function(e,t){var n=ue(e),r=n.match(oe);return r&&r.forEach((function(e,r){if(r){var a="{{".concat(e,"}}"),i=ue(t[e]);n=n.replace(a,i)}})),n},pe=function(e){if(!(0,y.isObject)(e))return"";e.label;var t=e.error,n=e.type,r=e.value;return t?r?de(t,{value:r}):ue(t):ue(n)},fe=((o=fe||{}).Active="active",o.Error="error",o.Complete="complete",o),me=Object.values(fe),ve=function(e){return(0,y.isPopulatedString)(e)&&me.includes(e)};function he(e,t){ve(e)||(0,y.errorThrow)(e,"ActivityGroup",t)}var ye={label:"",activities:[],allActivities:[],picked:"active",pick:y.EmptyMethod},Ee=h.createContext(ye),Ze=h.createContext({collapsed:!1,changeCollapsed:function(){}}),ge={streaming:!1,setStreaming:y.EmptyMethod,current:{},changeDefinition:y.EmptyMethod,drop:function(){return Promise.resolve([])},editorIndex:{},icons:{}},Te=h.createContext(ge),Ce=function(){var e=h.useContext(Te).editor;(0,y.assertDefined)(e);var t=h.useRef([]),n=e.eventTarget,r=function(e){var n=e.type;if((0,y.isEventType)(n)&&e instanceof CustomEvent){var r=e.detail,a=r.id,i=r.type,o=t.current,c=o.find((function(e){return e.id===a})),l=c||{id:a,activityGroup:"active",infos:[]};l.infos.unshift(r),i===E.ActivityType.Complete?l.activityGroup="complete":i===E.ActivityType.Error&&(l.activityGroup="error"),c||o.unshift(l)}},a=h.useSyncExternalStore((function(e){return n.addEventListener(y.EventType.Active,e),function(){n.removeEventListener(y.EventType.Active,e)}}),(function(){return t.current})),i=function(){return n.addEventListener(y.EventType.Active,r),function(){n.removeEventListener(y.EventType.Active,r)}};return h.useEffect((function(){return i()}),[]),[e,a]};function ke(e){var t=e.initialPicked,n=void 0===t?"active":t,r=e.initialCollapsed,a=void 0!==r&&r,i=e.className,o=(0,f.Z)(e,g);he(n);var c=h.useState(a),l=(0,p.Z)(c,2),s=l[0],u=l[1],d=h.useState(""),m=(0,p.Z)(d,2),E=m[0],Z=(m[1],Ce()),T=(0,p.Z)(Z,2),C=(T[0],T[1]),k=h.useState(n),b=(0,p.Z)(k,2),D=b[0],S=b[1],x={activities:h.useMemo((function(){return C.filter((function(e){return e.activityGroup===D}))}),[D,C.length]),allActivities:C,picked:D,pick:S,label:E},P={collapsed:s,changeCollapsed:u},w=[];i&&w.push(i),s&&w.push(y.ClassCollapsed);var N=(0,v.Z)((0,v.Z)({},o),{},{className:w.join(" ")});return h.createElement(Ee.Provider,{value:x},h.createElement(Ze.Provider,{value:P},h.createElement(ie,(0,v.Z)({},N))))}var be={infos:[],activityGroup:"active",id:""},De=h.createContext(be);function Se(e){var t=h.useContext(Ee),n=h.useContext(Ze).collapsed,r=t.activities;if(n)return null;var a=e.children,i=(0,f.Z)(e,T),o=h.Children.only(a);(0,y.assertTrue)(h.isValidElement(o));var c=r.map((function(e){var t={children:h.cloneElement(o),value:e,key:e.id};return h.createElement(De.Provider,(0,v.Z)({},t))})),l=(0,v.Z)((0,v.Z)({},i),{},{children:c});return h.createElement(ie,(0,v.Z)({},l))}function xe(e){var t=e.collapsed,n=(0,f.Z)(e,C),r=h.useState(!!t),a=(0,p.Z)(r,2),i={collapsed:a[0],changeCollapsed:a[1]};return h.createElement(Ze.Provider,{value:i},h.createElement(ie,(0,v.Z)({},n)))}function Pe(e){var t=h.useContext(Ze).collapsed,n=h.useContext(De).infos,r=(0,p.Z)(n,1)[0],a=(n.find((function(e){return e.label}))||{label:""}).label||r.type,i=(0,v.Z)({},e);if(t)i.children=a;else{var o=[a].concat((0,d.Z)(n.map((function(e){return pe(e)}))));i.children=o.map((function(e,t){return h.createElement(ie,{key:t,children:e})}))}return h.createElement(ie,(0,v.Z)({},i))}var we={child:"single child element expected"};function Ne(e){var t=h.useContext(Ee),n=e.id,r=e.children;if(he(n),n!==t.picked)return null;var a=h.Children.only(r);return(0,y.assertTrue)(h.isValidElement(a),we.child),a}function Me(e){var t=e.id,n=e.className,r=e.children,a=(0,f.Z)(e,k);he(t);var i=h.Children.only(r);(0,y.assertTrue)(h.isValidElement(i),we.child);var o=h.useContext(Ee),c=o.picked,l=o.pick,s=[];n&&s.push(n),t===c&&s.push(y.ClassSelected);var u=(0,v.Z)((0,v.Z)({},a),{},{className:s.join(" "),key:"activity-picker-".concat(t),onClick:function(){return l(t)}});return h.cloneElement(i,u)}function Ie(e){var t=h.useContext(Ee),n=h.useContext(De),r=n.infos,a=(n.id,[]),i=0,o=0;if((0,y.isPopulatedArray)(r)){var c=(0,p.Z)(r,1)[0],l=c.step,s=c.steps;(0,y.isPositive)(l)&&(0,y.isAboveZero)(s)&&(o=l,i=s)}else{var u=t.allActivities,d=t.label;(0,y.isPopulatedString)(d)&&a.push(h.createElement("label",{key:"label"},d));var f=u.filter((function(e){return"active"===e.activityGroup}));f.length&&f.forEach((function(e){var t=e.infos,n=(0,p.Z)(t,1)[0];(0,y.assertObject)(n,"info");var r=n.step,a=n.steps;(0,y.isPositive)(a)&&(i+=a),(0,y.isPositive)(r)&&(o+=r)}))}if(i){var m=o/i,E={value:m,max:1,children:"".concat(Math.round(100*m),"%"),key:"progress"};a.push(h.createElement("progress",(0,v.Z)({},E)))}var Z=(0,v.Z)((0,v.Z)({},e),{},{key:"activity-progress",children:a});return h.createElement(ie,(0,v.Z)({},Z))}function Oe(e){var t=e.before,n=e.content,r=e.after,a=e.props,i=void 0===a?{}:a;if(!(t||n||r))return null;var o=[t,n,r].filter(Boolean);return i.children=o,h.createElement(ie,(0,v.Z)({},i))}var Re=function(e){var t,n,r,a,i,o,c,l,s;return e.header||(e.header={}),(t=e.header).props||(t.props={}),(n=e.header.props).key||(n.key="header"),(r=e.header.props).className||(r.className="head"),e.content||(e.content={}),(a=e.content).props||(a.props={}),(i=e.content.props).key||(i.key="content"),(o=e.content.props).className||(o.className="content"),e.footer||(e.footer={}),(c=e.footer).props||(c.props={}),(l=e.footer.props).key||(l.key="footer"),(s=e.footer.props).className||(s.className="foot"),e.props||(e.props={}),(0,y.assertPopulatedObject)(e.icons),e};function Ae(e){var t=e.children,n=e.className,r=e.collapsed,a=h.useState(!!r),i=(0,p.Z)(a,2),o=i[0],c=i[1],l=[];n&&l.push(n),o&&l.push("collapsed");var s={children:t,className:l.join(" ")},u={collapsed:o,changeCollapsed:c};return h.createElement(Ze.Provider,{value:u},h.createElement(ie,(0,v.Z)({},s)))}function je(e){if(h.useContext(Ze).collapsed)return null;var t=e.before,n=e.content,r=e.after,a=e.props,i=void 0===a?{}:a;if(!(t||n||r))return null;var o=[t,n,r].filter(Boolean);return i.children=o,h.createElement(ie,(0,v.Z)({},i))}function Ge(e){var t=h.useContext(Ze),n=t.collapsed,r=t.changeCollapsed,a=(0,v.Z)((0,v.Z)({},e),{},{onClick:function(){r(!n)}});return h.createElement(ie,(0,v.Z)({},a))}function Be(e){return h.useContext(Ze).collapsed?null:h.createElement(h.Fragment,null,e.children)}function ze(e){return h.useContext(Ze).collapsed?h.createElement(h.Fragment,null,e.children):null}var Fe=function(){var e,t,n,r,a,i,o=Re(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),c=o.icons;(e=o.props).key||(e.key="activity"),(t=o.props).className||(t.className="panel activity"),(n=o.props).initialPicked||(n.initialPicked="active"),(0,y.isUndefined)(o.props.initialCollapsed)&&(o.props.initialCollapsed=!0),(r=o.header).content||(r.content=[h.createElement(ie,{key:"panel-icon",children:c.activity}),h.createElement(Be,{key:"not-collapsed"},h.createElement(ie,{key:"view"})),h.createElement(ze,{key:"collapsed"},h.createElement(Ie,{key:"progress",className:"progress"})),h.createElement(Ge,{key:"collapse-control"},h.createElement(Be,{key:"not-collapsed",children:c.collapse}),h.createElement(ze,{key:"collapsed",children:c.collapsed}))]),(a=o.content).children||(a.children=h.createElement(xe,{className:"item",collapsed:!0},h.createElement(Ge,{key:"collapse-control"},h.createElement(Be,{key:"not-collapsed",children:c.collapse}),h.createElement(ze,{key:"collapsed",children:c.collapsed})),h.createElement(Pe,{key:"label",className:"label"}),h.createElement(Ne,{key:"active",id:"active"},h.createElement(Ie,{key:"progress"})),h.createElement(Ne,{key:"error",id:"error",children:c.error}),h.createElement(Ne,{key:"complete",id:"complete",children:c.complete}))),(i=o.footer).content||(i.content=[h.createElement(Me,{key:"active",id:"active",className:y.ClassButton,children:c.active}),h.createElement(Me,{key:"error",id:"error",className:y.ClassButton,children:c.error}),h.createElement(Me,{key:"complete",id:"complete",className:y.ClassButton,children:c.complete})]);var l=h.createElement(h.Fragment,null,h.createElement(Oe,(0,v.Z)({},o.header)),h.createElement(Se,(0,v.Z)({},o.content.props),o.content.children),h.createElement(je,(0,v.Z)({},o.footer)));return(0,v.Z)((0,v.Z)({},o.props),{},{children:l})},Le={addPicker:y.EmptyMethod,refresh:y.EmptyMethod,definitions:[],pick:y.EmptyMethod,picked:"",removePicker:y.EmptyMethod},Ve=h.createContext(Le),He=y.EventType.Added,We=y.EventType.Resize,qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=h.useContext(Te).editor;(0,y.assertDefined)(t);var n=t.media,r=h.useRef({}),a=t.eventTarget,i=function(e){var t=e.type;if((0,y.isEventType)(t)&&e instanceof CustomEvent){var n=e.detail.definitionTypes;if((0,y.isPopulatedArray)(n)){var a=n,i=r.current;Object.keys(i).filter((function(e){return a.some((function(t){return e.includes(t)}))})).forEach((function(e){return delete i[e]}))}}},o=h.useSyncExternalStore((function(e){return a.addEventListener(He,e),a.addEventListener(We,e),function(){a.removeEventListener(He,e),a.removeEventListener(We,e)}}),(function(){var t,a=e.join("-")||"empty";return(t=r.current)[a]||(t[a]=function(){var t=e.map((function(e){return n.byType(e)}));return 1===t.length?t[0]:t.flat()}())})),c=function(){return a.addEventListener(He,i),function(){a.removeEventListener(He,i)}};return h.useEffect((function(){return c()}),[]),o},Ue=function(){return h.useContext(Te).client},_e=function(){return h.useContext(Te).editor},Je="api-definitions",Xe="disabled",Ke="empty",Qe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Ue();if(!t.enabled(E.ReadOperation))return[];var n=_e();(0,y.assertDefined)(n);var r=h.useRef({}),a=n.eventTarget,i=function(n){switch(n){case Ke:case Xe:break;default:!function(n){var i={type:e};t.list(i).then((function(e){var t;console.debug("DataDefinitionRetrieveResponse",y.Endpoints.data.definition.retrieve,e),e.error;var i=e.data;i&&((t=r.current[n]).push.apply(t,(0,d.Z)(i)),a.dispatchEvent(new CustomEvent(Je)))}))}(n)}return[]};return h.useSyncExternalStore((function(e){return a.addEventListener(Je,e),function(){a.removeEventListener(Je,e)}}),(function(){var t=e.length?e.join("-"):Ke;return r.current[t]||(r.current[t]=i(t))}))},Ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=qe(e),n=Qe(e).filter((function(e){return!t.some((function(t){return t.id===e.id}))}));return[].concat((0,d.Z)(t),(0,d.Z)(n))},$e=function(){var e=h.useState(0),t=(0,p.Z)(e,2),n=t[0],r=t[1];return[function(){r((new Date).valueOf())},n]};function et(e){var t=e.initialPicked,n=void 0===t?"container":t,r=(0,f.Z)(e,b),a=h.useState({}),i=(0,p.Z)(a,2),o=i[0],c=i[1],l=h.useContext(Te).changeDefinition,s=$e(),d=(0,p.Z)(s,1)[0],m=h.useState(n),E=(0,p.Z)(m,2),Z=E[0],g=E[1],T={value:{refresh:d,definitions:Ye(o[Z]),picked:Z,pick:function(e){(0,y.assertPopulatedString)(e),l(),g(e)},addPicker:function(e,t){c((function(n){return(0,v.Z)((0,v.Z)({},n),{},(0,u.Z)({},e,t))}))},removePicker:function(e){c((function(t){return(0,v.Z)((0,v.Z)({},t),{},(0,u.Z)({},e,[]))}))}},children:h.createElement(ie,(0,v.Z)({},r))};return h.createElement(Ve.Provider,(0,v.Z)({},T))}var tt={},nt=h.createContext(tt);function rt(e){var t=h.useState(!1),n=(0,p.Z)(t,2),r=n[0],a=n[1],i=e.className,o=e.children,c=(0,f.Z)(e,D),l=h.useContext(Te),s=h.useContext(Ve).definitions||[],u=l.drop,d=function(e){return!!e&&(0,E.dragTypes)(e).includes(E.TransferTypeFiles)},m=function(e){(0,y.eventStop)(e),a(!1)},Z=[];i&&Z.push(i),r&&Z.push(y.ClassDropping);var g=h.Children.only(o);(0,y.assertTrue)(h.isValidElement(g));var T=(0,v.Z)((0,v.Z)({},c),{},{className:Z.join(" "),key:"browser-content",children:function(){var e=g.props;return s.map((function(t){var n=(0,v.Z)((0,v.Z)({},e),{},{key:t.id}),r={children:h.cloneElement(g,n),value:{definition:t},key:t.id};return h.createElement(nt.Provider,(0,v.Z)({},r))}))}(),onDrop:function(e){m(e);var t=e.dataTransfer;d(t)&&u(t.files)},onDragOver:function(e){(0,y.eventStop)(e),a(d(e.dataTransfer))},onDragLeave:m});return h.createElement(ie,(0,v.Z)({},T))}var at=function(e,t,n){return e?[e]:t?(0,y.isString)(t)?t.split(",").map((function(e){return e.trim()})):t:n?n.map((function(e){return e.name})):[]},it=function(e,t,n){var r=at(e,t);return n&&!r.length&&r.push(n),r.filter((function(e){return(0,y.isMediaType)(e)})).map((function(e){return e}))},ot=function(e,t,n){var r=at(e,t);return n&&!r.length&&r.push(n),r.filter((function(e){return(0,y.isSelectType)(e)})).map((function(e){return e}))};function ct(e){var t=e.children,n=e.type,r=e.types,a=e.className,i=e.id,o=(0,f.Z)(e,S);(0,y.assertPopulatedString)(i);var c=h.useContext(Ve),l=c.pick,s=c.picked,u=c.addPicker,d=c.removePicker,p=[];a&&p.push(a),s===i&&p.push(y.ClassSelected),h.useEffect((function(){return u(i,it(n,r,i)),function(){d(i)}}),[]);var m=(0,v.Z)((0,v.Z)({},o),{},{className:p.join(" "),key:"browser-picker-".concat(i),onClick:function(){l(i)}}),E=h.Children.only(t);return(0,y.assertTrue)(h.isValidElement(E),we.child),h.cloneElement(E,m)}var lt="upload-control-id";function st(e){var t=e.children,n=(0,f.Z)(e,x),r=h.useRef(null),a=Ue(),i=h.useContext(Te).drop,o=(0,v.Z)({accept:a.accept(),multiple:!0,id:lt,onChange:function(e){var t=e.currentTarget.files;t&&i(t)},type:"file",key:"browser-control-input",ref:r},n),c=h.createElement("input",(0,v.Z)({},o));if(!h.isValidElement(t))return c;var l={children:[h.Children.only(t),c],key:"browser-control",htmlFor:lt};return h.createElement("label",(0,v.Z)({},l))}var ut=function(){return h.useContext(nt).definition};function dt(e){var t=e.className,n=e.iconRatio,r=(0,f.Z)(e,P),a=n||.25,i=h.useRef(null),o=h.useRef(null),c=h.useContext(Ve).refresh,u=h.useContext(Te),d=u.editor,p=u.changeDefinition,m=u.current;(0,y.assertTrue)(d);var Z=ut(),g=Z.id,T=Z.label,C=function(){var e=(0,s.Z)((0,l.Z)().mark((function e(){var t,n,r,o;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=d.rect,(n=i.current)&&(0,y.sizeAboveZero)(t)){e.next=3;break}return e.abrupt("return");case 3:return r=(0,y.sizeCeil)((0,y.sizeScale)((0,y.sizeCopy)(t),a,a)),e.next=6,Z.definitionIcon(r);case 6:(o=e.sent)&&n.replaceChildren(o);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();h.useEffect((function(){C()}),[]),i.current&&C();var k=function(e){e.stopPropagation(),p(Z),c()},b=(0,v.Z)((0,v.Z)({},r),{},{className:t,children:function(){var e=[h.createElement(ie,{key:"icon",ref:i})];return T&&e.unshift(h.createElement("label",{key:"label"},T)),e}(),ref:o,key:g});return e.draggable&&(b.onDragStart=function(e){k(e);var t=o.current.getBoundingClientRect().left,n={offset:e.clientX-t,mediaObject:Z.toJSON()},r=JSON.stringify(n),a=e.dataTransfer;a&&(a.effectAllowed="copy",a.setData(Z.type+E.DragSuffix,r))},b.onPointerDown=k,b.className=function(){var e=[];return t&&e.push(t),m.mediaId===g&&e.push(y.ClassSelected),e.join(" ")}()),h.createElement(ie,(0,v.Z)({},b))}var pt=function(){var e,t,n,r,a,i,o,c,l=Re(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),s=l.icons;(e=l.props).key||(e.key="browser"),(t=l.props).className||(t.className="panel browser"),(n=l.props).initialPicked||(n.initialPicked="container"),(r=l.header).content||(r.content=[h.createElement(ie,{key:"panel-icon",children:s.browser})]),(a=l.footer).content||(a.content=[h.createElement(ct,{key:"effect",id:"effect",className:y.ClassButton,children:s.effect}),h.createElement(ct,{key:"container",id:"container",className:y.ClassButton,children:s.container}),h.createElement(ct,{key:"content",id:"content",className:y.ClassButton,children:s.content})]),(i=l.footer).before||(i.before=[h.createElement(ct,{key:"video",id:"video",types:"video,videosequence",className:y.ClassButton,children:s.browserVideo}),h.createElement(ct,{key:"audio",id:"audio",className:y.ClassButton,children:s.browserAudio}),h.createElement(ct,{key:"image",id:"image",className:y.ClassButton,children:s.browserImage}),h.createElement(ct,{key:"font",id:"font",className:y.ClassButton,children:s.browserText})]),(o=l.footer).after||(o.after=[h.createElement(st,{key:"import",children:s.import})]),(c=l.content).children||(c.children=h.createElement(dt,{draggable:!0,className:"definition preview"}));var u=h.createElement(h.Fragment,null,h.createElement(Oe,(0,v.Z)({},l.header)),h.createElement(rt,(0,v.Z)({},l.content.props),l.content.children),h.createElement(Oe,(0,v.Z)({},l.footer)));return(0,v.Z)((0,v.Z)({},l.props),{},{children:u})},ft={prevClipEnd:0},mt=h.createContext(ft),vt={},ht=h.createContext(vt),yt={dragTypeValid:function(){return!1},frame:0,frames:0,onDragLeave:y.EmptyMethod,onDrop:y.EmptyMethod,rect:y.RectZero,refreshed:0,refresh:y.EmptyMethod,scale:0,scroll:{x:0,y:0},setDroppingClip:y.EmptyMethod,setDroppingPosition:y.EmptyMethod,setDroppingTrack:y.EmptyMethod,setRect:y.EmptyMethod,setScroll:y.EmptyMethod,setZoom:y.EmptyMethod,zoom:1},Et=h.createContext(yt),Zt=function(e){var t=_e().eventTarget,n=function(t){var n=t.type,r=e[n];r&&r(t)},r=function(){return Object.keys(e).forEach((function(e){t.addEventListener(e,n)})),function(){Object.keys(e).forEach((function(e){t.removeEventListener(e,n)}))}};h.useEffect((function(){return r()}),[])},gt=500;function Tt(e){var t,n=e.className,r=(0,f.Z)(e,w),a=h.useRef(null),i=h.useRef(null),o=_e(),c=h.useContext(ht),l=h.useContext(Et),s=$e(),d=(0,p.Z)(s,2),m=d[0],Z=d[1],g=h.useRef({}).current,T=h.useContext(mt),C=l.droppingPosition,k=l.droppingClip,b=l.scale,D=l.selectedClip,S=l.onDrop,x=l.dragTypeValid,P=l.setDroppingPosition,N=l.setDroppingClip,M=l.setDroppingTrack,I=l.onDragLeave,O=c.track,R=T.clip,A=T.prevClipEnd;(0,y.assertTrue)(R);var j=function(){var e=a.current,t=null===e||void 0===e?void 0:e.parentNode;return t instanceof HTMLDivElement?t.offsetHeight:0},G=h.useState(j),B=(0,p.Z)(G,2),z=B[0],F=B[1],L=R.label,V=R.frame,H=R.frames,W=function(){if(!(0,y.isAboveZero)(b)||!(0,y.isAboveZero)(H))return 0;var e=(0,E.pixelFromFrame)(H,b,"floor"),t=g.width;return e&&e!==t&&(g.width=e,m()),e},q=W();Zt((t={},(0,u.Z)(t,y.EventType.Action,(function(e){if(!g.redraw){var t=e.type;if((0,y.isEventType)(t)&&e instanceof CustomEvent&&t===y.EventType.Action){var n=e.detail;if(n){var r=n.action;if(r){var a=r.target;if((0,y.isObject)(a)){switch(a){case R:case R.container:case R.content:break;default:if("color"===r.property)break;return}m()}}}}}})),(0,u.Z)(t,y.EventType.Save,m),t));var U=function(){var e=g.width,t=g.redraw;delete g.timeout,delete g.redraw;var n=a.current,r=o.mashMedia,i=n&&r&&e&&e===W();if((t||!i)&&(m(),!i))return Promise.resolve();var c=function(){var e=o.rect,t={width:z*(e.width/e.height),height:z};return(0,y.sizeCeil)(t)}(),s=function(e){var t=e.width,n=e.height;return{width:Math.max(t,q),height:n}}(c),u=R.clipIcon(s,l.scale,2);return u?u.then((function(t){var a=W();t&&e>=a&&n.replaceChildren(function(e,t,n){var r=(0,y.colorToRgb)(e),a=(0,y.colorRgbDifference)(r),i=(0,y.colorFromRgb)(a),o=(0,y.svgPolygonElement)(t,"",e),c={x:t.width,y:0,width:n,height:t.height},s=(0,y.svgPolygonElement)(c,"",i),u={width:t.width+n,height:t.height},d=(0,y.idGenerate)("pattern"),p=(0,y.svgPatternElement)(u,d,[o,s]),f=(0,y.svgDefsElement)([p]),m={width:l.rect.width,height:z},v=(0,y.svgPolygonElement)(m,"",(0,y.svgUrl)(d));return(0,y.svgSvgElement)(m,[f,v])}(r.color,c,2),t)})):Promise.resolve()};h.useEffect((function(){if(!z)return F(j);var e=a.current,t=o.mashMedia;if(e&&t){if(g.timeout)return void(g.redraw||(g.redraw=!0));g.timeout=setTimeout(U,gt)}}),[Z,b,z]);var _=function(e){e.stopPropagation(),o.selection.set(R)},J={width:q};A>-1&&(J.marginLeft=(0,E.pixelFromFrame)(V-A,b,"floor"));var X=(0,v.Z)((0,v.Z)({},r),{},{style:J,className:function(){var e=R===D,t=[];return n&&t.push(n),e&&t.push(y.ClassSelected),k===R&&t.push((0,E.droppingPositionClass)(C)),t.join(" ")}(),onPointerDown:_,onDragStart:function(e){_(e);var t=e.dataTransfer,n=e.clientX,r=i.current;if(t&&r){var a={offset:n-r.getBoundingClientRect().left},o=JSON.stringify(a);t.effectAllowed="move",t.setData("clip"+E.DragSuffix,o)}},onDragEnd:function(e){(0,y.eventStop)(e);var t=e.dataTransfer;t&&("none"===t.dropEffect&&o.removeClip(R))},onDragOver:function(e){(0,y.eventStop)(e);var t=e.dataTransfer;if(t){var n=x(t,R),r=n?y.DroppingPosition.At:y.DroppingPosition.None;M(n?O:void 0),N(n?R:void 0),P(r)}},onDragLeave:I,onDrop:S,onClick:function(e){return e.stopPropagation()},draggable:!0,ref:i,children:function(){var e={key:"clip-previews",ref:a},t={width:q,height:z};if((0,y.sizeAboveZero)(t)){var n=t.width,r=t.height;e.width=n,e.height=r,e.viewBox="0 0 ".concat(n," ").concat(r)}var i=[h.createElement("svg",(0,v.Z)({},e))];return L&&i.unshift(h.createElement("label",{key:"label"},L)),i}()});return h.createElement(ie,(0,v.Z)({},X))}var Ct=function(){return h.useContext(mt).clip};function kt(e){var t,n=e.children,r=(0,f.Z)(e,N),a=_e(),i=function(){return a.can(y.MasherAction.Save)},o=h.useState(i),c=(0,p.Z)(o,2),l=c[0],s=c[1],d=function(){s(i())};Zt((t={},(0,u.Z)(t,y.EventType.Action,d),(0,u.Z)(t,y.EventType.Loaded,d),(0,u.Z)(t,y.EventType.Save,d),t));var m=(0,v.Z)((0,v.Z)({},r),{},{onClick:function(){l||a.create()},disabled:l});return h.cloneElement(h.Children.only(n),m)}function bt(e){var t=h.useState(!0),n=(0,p.Z)(t,2),r=n[0],a=n[1],i=_e();Zt((0,u.Z)({},y.EventType.Action,(function(){a(!i.can(y.MasherAction.Redo))})));var o=e.children,c=(0,f.Z)(e,M),l=(0,v.Z)((0,v.Z)({},c),{},{onClick:function(){i.redo()},disabled:r});return h.cloneElement(h.Children.only(o),l)}function Dt(e){var t=e.children,n=e.type,r=(0,f.Z)(e,I),a=n||y.SelectType.Clip;(0,y.assertSelectType)(a);var i=_e(),o=h.useState(!i.selection[a]),c=(0,p.Z)(o,2),l=c[0],s=c[1];Zt((0,u.Z)({},y.EventType.Selection,(function(){s(!i.selection[a])})));var d=h.Children.only(t),m=(0,v.Z)((0,v.Z)((0,v.Z)({},r),d.props),{},{onClick:function(){if(!l){var e=i.selection[a];(0,y.isEffect)(e)?i.removeEffect(e):(0,y.isClip)(e)?i.removeClip(e):(0,y.isTrack)(e)&&i.removeTrack(e)}},disabled:l});return h.cloneElement(d,m)}function St(e){var t=_e(),n=h.useState(!0),r=(0,p.Z)(n,2),a=r[0],i=r[1];Zt((0,u.Z)({},y.EventType.Action,(function(){i(!t.can(y.MasherAction.Undo))})));var o=e.children,c=(0,f.Z)(e,O),l=(0,v.Z)((0,v.Z)({},c),{},{onClick:function(){t.undo()},disabled:a});return h.cloneElement(h.Children.only(o),l)}function xt(e){var t,n=Ue(),r=e.children,a=(0,f.Z)(e,R),i=_e(),o=function(){return!i.can(y.MasherAction.Render)},c=h.useState(o),l=(0,p.Z)(c,2),s=l[0],d=l[1],m=function(){return d(o())};if(Zt((t={},(0,u.Z)(t,y.EventType.Save,m),(0,u.Z)(t,y.EventType.Loaded,m),(0,u.Z)(t,y.EventType.Action,m),t)),!n.enabled(E.EncodeOperation))return null;var Z=(0,v.Z)((0,v.Z)({},a),{},{onClick:function(){if(!s){var e=i.mashMedia;(0,y.assertMashMedia)(e),d(!0),n.encode(e)}},disabled:s});return h.cloneElement(h.Children.only(r),Z)}function Pt(e){var t,n=_e(),r=Ue(),a=function(){return!n.can(y.MasherAction.Save)},i=h.useState(a),o=(0,p.Z)(i,2),c=o[0],l=o[1],s=function(){l(a())};if(Zt((t={},(0,u.Z)(t,y.EventType.Action,s),(0,u.Z)(t,y.EventType.Save,s),t)),!r.enabled(E.WriteOperation))return null;var d=e.children,m=(0,f.Z)(e,A),Z=(0,v.Z)((0,v.Z)({},m),{},{onClick:function(){if(!c){l(!0);var e=n.mashMedia;(0,y.assertMashMedia)(e),r.save(e)}},disabled:c});return h.cloneElement(h.Children.only(d),Z)}var wt={enabled:!1,servers:{},endpointPromise:function(){return Promise.resolve({})}},Nt=h.createContext(wt),Mt={actionCount:0,selectedInfo:{tweenDefined:{},tweenSelected:{},selectedType:y.SelectType.None,selectTypes:[]},selectedItems:[],changeSelected:y.EmptyMethod,changeTweening:y.EmptyMethod},It=h.createContext(Mt);function Ot(e){var t,n,r,a=_e(),i=h.useState(!1),o=(0,p.Z)(i,2),c=o[0],l=o[1],s=h.useState((function(){return[]})),m=(0,p.Z)(s,2),E=m[0],Z=m[1],g=h.useState((null===(t=a.mashMedia)||void 0===t?void 0:t.id)||""),T=(0,p.Z)(g,2),C=T[0],k=T[1],b=h.useContext(Nt),D=h.useContext(It).selectedInfo.selectedType,S=h.useState((null===(n=a.mashMedia)||void 0===n?void 0:n.label)||""),x=(0,p.Z)(S,2),P=x[0],w=x[1],N=function(){return a.can(y.MasherAction.Save)},M=h.useState(N),I=(0,p.Z)(M,2),O=I[0],R=I[1],A=b.enabled,G=b.servers,B=b.endpointPromise,z=function(){R(N())};Zt((r={},(0,u.Z)(r,y.EventType.Action,(function(){var e=a.mashMedia;(0,y.assertObject)(e,"mashMedia");var t=e.label;P!==t&&(Z((function(e){return(0,d.Z)(e)})),w(t)),z()})),(0,u.Z)(r,y.EventType.Loaded,(function(e){var t=e.type;if((0,y.isEventType)(t)&&(0,y.isSelectType)(t)&&t===D){var n=a.mashMedia;(0,y.assertObject)(n,"mashMedia");var r=n.id,i=n.label;Z((function(e){var t=e.filter((function(e){return(0,y.isPopulatedString)(e.label)})),a=t.findIndex((function(e){return e.id===r}));return(0,y.isPositive)(a)?t.splice(a,1,n):t.push(n),k(r),w(i),t}))}})),(0,u.Z)(r,y.EventType.Save,z),r));if(h.useEffect((function(){if(A&&G[y.ServerType.Data]&&!c){l(!0);var e={partial:!0},t=y.Endpoints.data[a.editType].retrieve;console.debug("RetrieveRequest",t,e),B(t,e).then((function(e){console.debug("RetrieveResponse",t,e);var n=e.described,r=e.error;r?console.error("RetrieveResponse",t,r):Z((function(e){var t=(0,d.Z)(e);return n.forEach((function(e){var n=e.id,r=e.label;t.find((function(e){return e.id===n}))||!(0,y.isPopulatedString)(r)||t.push(e)})),t}))}))}}),[G,A]),E.length<2)return null;var F=e.children,L=(0,f.Z)(e,j),V=h.Children.only(F);(0,y.assertTrue)(h.isValidElement(V));var H={key:"mashMedia-select",onChange:function(e){if(!O){var t=e.target.selectedIndex,n=E[t];(0,y.assertObject)(n,"described[selectedIndex]");var r={id:n.id},i=a.editType,o=y.Endpoints.data[i].get;console.debug("GetRequest",o,r),B(o,r).then((function(e){console.debug("GetResponse",o,e);var t=e.error,n=e.mash;if(!t)return a.load(n);console.error("GetResponse",o,t)}))}},disabled:O,children:function(){var e=a.editType,t=a.mashMedia,n=[h.createElement("optgroup",{key:"group",label:ue("open")})];if(!t)return n;var r=t.id,i=t.label;return n.push.apply(n,(0,d.Z)(E.map((function(t){var n=t.label,a=t.id,o=a===r?i:n,c={children:(0,y.isPopulatedString)(o)?o:de("unlabeled",{type:e}),value:a,key:a};return h.createElement("option",(0,v.Z)({},c))})))),n}(),value:C},W=(0,v.Z)((0,v.Z)({},L),{},{children:[V,h.createElement("select",(0,v.Z)({},H))]});return h.createElement(ie,(0,v.Z)({},W))}function Rt(e){var t,n=_e(),r=function(){var e=n.mashMedia;return!(0,y.isMashMedia)(e)||!e.encodings.length},a=h.useState(r),i=(0,p.Z)(a,2),o=i[0],c=i[1],l=function(){return c(r())};Zt((t={},(0,u.Z)(t,y.EventType.Render,l),(0,u.Z)(t,y.EventType.Loaded,l),t));var s=e.children,d=(0,f.Z)(e,G),m=(0,v.Z)((0,v.Z)({},d),{},{onClick:function(){if(!o){var e=n.mashMedia;(0,y.assertMashMedia)(e);var t=e.encodings,r=(0,p.Z)(t,1)[0].request.endpoint;(0,y.assertEndpoint)(r);var a=(0,y.endpointUrl)(r);window.open(a)}},disabled:o});return h.cloneElement(h.Children.only(s),m)}var At=h.createElement((function(e){return null}),{key:"empty"}),jt="tween-input-key",Gt=(r={},(0,u.Z)(r,y.DataType.Boolean,At),(0,u.Z)(r,y.DataType.ContainerId,At),(0,u.Z)(r,y.DataType.ContentId,At),(0,u.Z)(r,y.DataType.DefinitionId,At),(0,u.Z)(r,y.DataType.FontId,At),(0,u.Z)(r,y.DataType.Frame,At),(0,u.Z)(r,y.DataType.Icon,At),(0,u.Z)(r,y.DataType.Number,At),(0,u.Z)(r,y.DataType.Percent,At),(0,u.Z)(r,y.DataType.Rgb,At),(0,u.Z)(r,y.DataType.String,At),(0,u.Z)(r,y.DataType.Option,At),r),Bt={value:"",name:"",property:{type:y.DataType.String,name:"",defaultValue:""}},zt=h.createContext(Bt);function Ft(){var e=h.useContext(zt),t=e.changeHandler,n=e.property,r=e.value,a=e.name;if(!n)return null;var i={type:"checkbox",name:a,checked:!!r};return t?i.onChange=function(e){t(a,e.target.checked)}:i.disabled=!0,h.createElement("input",(0,v.Z)({},i))}function Lt(e){var t=e.type,n=e.types,r=e.children,a=e.className,i=(0,f.Z)(e,B),o=h.Children.only(r);(0,y.assertTrue)(h.isValidElement(o));var c=h.useState(!1),u=(0,p.Z)(c,2),d=u[0],m=u[1],Z=h.useContext(zt),g=h.useContext(Te),T=g.drop,C=g.editor;(0,y.assertDefined)(C);var k=Z.changeHandler,b=Z.value,D=Z.name;(0,y.assertTrue)(k);var S=C.media,x=it(t,n),P=function(e){var t=e.dataTransfer;if((0,y.assertTrue)(t),(0,E.dragTypes)(t).includes(E.TransferTypeFiles))return!0;var n=(0,E.dragType)(t);return!!(0,y.isMediaType)(n)&&x.includes(n)},w=function(){var e=(0,s.Z)((0,l.Z)().mark((function e(t){var n,r,a,i,o,c,s,u;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,y.eventStop)(t),m(!1),P(t)){e.next=2;break}return e.abrupt("return");case 2:if(n=t.dataTransfer,(0,y.assertTrue)(n),!(0,E.dragTypes)(n).includes(E.TransferTypeFiles)){e.next=7;break}return e.next=6,T(n.files).then((function(e){if(e.length){var t="containerId"===D?e.filter(y.isContainerDefinition):e,n=(0,p.Z)(t,1)[0];n&&((0,y.assertTrue)(S.installed(n.id),"".concat(n.type," installed")),k(D,n.id))}}));case 6:return e.abrupt("return");case 7:if(r=(0,E.dropType)(n),a=n.getData(r),i=JSON.parse(a),o=i.mediaObject,!(0,y.isMediaObject)(o)){e.next=13;break}if(c=S.define(o),s=(0,p.Z)(c,1),u=s[0],"containerId"!==D||(0,y.isContainerDefinition)(u)){e.next=12;break}return e.abrupt("return");case 12:k(D,o.id);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=h.useMemo((function(){var e=[];return a&&e.push(a),d&&e.push(y.ClassDropping),e.join(" ")}),[d]),M=(0,v.Z)((0,v.Z)({},i),{},{className:N,children:function(){if(!b)return null;(0,y.assertPopulatedString)(b);var e=S.fromId(b);(0,y.assertMedia)(e);var t={definition:e,key:e.id},n={children:h.cloneElement(o,t),value:{definition:e}};return h.createElement(nt.Provider,(0,v.Z)({},n))}(),onDragLeave:function(){m(!1)},onDragOver:function(e){var t=P(e);m(t),t&&e.preventDefault()},onDrop:w,value:String(b),key:"".concat(D,"-drop")});return h.createElement(ie,(0,v.Z)({},M))}function Vt(){var e=h.useContext(zt),t=e.changeHandler,n=e.value,r=e.name,a=_e().media;(0,y.assertTrue)(t);var i={children:a.byType(y.FontType).map((function(e){var t=e.id,n=e.label;return h.createElement("option",(0,v.Z)({},{value:t,children:n,key:t}))})),name:r,onChange:function(e){t(r,e.target.value)},value:String(n),key:"".concat(r,"-select")};return h.createElement("select",(0,v.Z)({},i))}function Ht(){var e=h.useContext(zt),t=h.useContext(Te).icons,n=Object.keys(t),r=e.changeHandler,a=e.property,i=e.value,o=e.name;if(!a)return null;var c={children:n.map((function(e){return h.createElement("option",(0,v.Z)({},{value:e,children:e,key:e}))})),name:o,value:String(i),key:"".concat(o,"-select")};return r?c.onChange=function(e){r(o,e.target.value)}:c.disabled=!0,h.createElement("select",(0,v.Z)({},c))}function Wt(){var e=h.useContext(zt),t=_e(),n=e.changeHandler,r=e.property,a=e.value,i=e.name,o=e.time;if(!r)return null;var c=r.min,u=r.max,d=r.step,p={type:"number",name:i,value:String(a)};return(0,y.isDefined)(c)&&(p.min=c),(0,y.isDefined)(u)&&(p.max=u),(0,y.isDefined)(d)&&(p.step=d),n?p.onChange=function(){var e=(0,s.Z)((0,l.Z)().mark((function e(r){var a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.target.value,e.t0=o,!e.t0){e.next=5;break}return e.next=5,t.goToTime(o);case 5:n(i,a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}():p.disabled=!0,h.createElement("input",(0,v.Z)({},p))}function qt(e){var t=e.className,n=e.onChange,r=(0,v.Z)({},e),a=["slider"];if(t&&a.push(t),r.className=a.join(" "),n){r.onChange=function(e){n(e,e.currentTarget.valueAsNumber)}}return h.createElement("input",(0,v.Z)({type:"range"},r))}function Ut(){var e=_e(),t=h.useContext(zt),n=t.changeHandler,r=t.property,a=t.value,i=t.name,o=t.time,c=t.defaultValue;if(!r)return null;var u=r.max,d=r.min,p=r.step,f=r.defaultValue,m={value:(0,y.isDefined)(a)?a:(0,y.isDefined)(c)?c:f,min:(0,y.isNumber)(d)?d:0,max:(0,y.isNumber)(u)?u:1,step:(0,y.isNumber)(p)?p:.01,name:i};if(n){var E=function(){var t=(0,s.Z)((0,l.Z)().mark((function t(r,a){var c;return(0,l.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=(0,y.isArray)(a)?a[0]:a,t.t0=o,!t.t0){t.next=5;break}return t.next=5,e.goToTime(o);case 5:n(i,c);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();m.onChange=E}else m.disabled=!0;return h.createElement(qt,(0,v.Z)({className:"slider"},m))}function _t(){h.useContext(Te).icons;var e=h.useContext(zt),t=_e(),n=e.changeHandler,r=e.property,a=e.value,i=e.name,o=e.time,c=e.defaultValue;if(!r)return null;var u=r.defaultValue,d=(0,y.isDefined)(a)?a:(0,y.isDefined)(c)?c:u,p={type:"color",name:i,value:String(d)};return n?p.onChange=function(){var e=(0,s.Z)((0,l.Z)().mark((function e(r){var a;return(0,l.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.target.value,e.t0=o,!e.t0){e.next=5;break}return e.next=5,t.goToTime(o);case 5:n(i,a);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}():p.disabled=!0,h.createElement("input",(0,v.Z)({},p))}function Jt(){var e=h.useContext(zt),t=e.changeHandler,n=e.property,r=e.value,a=e.name;if(!n)return null;var i={name:a,type:"text",value:String(r)};return t?i.onChange=function(e){t(a,e.target.value)}:i.disabled=!0,h.createElement("input",(0,v.Z)({},i))}function Xt(){var e=h.useContext(zt),t=e.changeHandler,n=e.property,r=e.value,a=e.name,i=n.options;(0,y.assertPopulatedArray)(i);var o={children:i.map(String).map((function(e){return h.createElement("option",(0,v.Z)({},{value:e,children:e,key:e}))})),name:a,value:String(r),key:"".concat(a,"-select")};return t?o.onChange=function(e){t(a,e.target.value)}:o.disabled=!0,h.createElement("select",(0,v.Z)({},o))}Gt[y.DataType.Boolean]=h.createElement(Ft,null),Gt[y.DataType.ContainerId]=h.createElement(Lt,{types:y.ContainerTypes,className:"definition-drop"},h.createElement(dt,{className:"definition preview"})),Gt[y.DataType.ContentId]=h.createElement(Lt,{types:y.ContentTypes,className:"definition-drop"},h.createElement(dt,{className:"definition preview"})),Gt[y.DataType.FontId]=h.createElement(Vt,null),Gt[y.DataType.Icon]=h.createElement(Ht,null),Gt[y.DataType.Number]=h.createElement(Wt,null),Gt[y.DataType.Frame]=h.createElement(Wt,null),Gt[y.DataType.Percent]=h.createElement(Ut,null),Gt[y.DataType.Rgb]=h.createElement(_t,null),Gt[y.DataType.String]=h.createElement(Jt,null),Gt[y.DataType.Option]=h.createElement(Xt,null);var Kt=(a={},(0,u.Z)(a,y.DataGroup.Size,At),(0,u.Z)(a,y.DataGroup.Point,At),(0,u.Z)(a,y.DataGroup.Opacity,At),(0,u.Z)(a,y.DataGroup.Color,At),(0,u.Z)(a,y.DataGroup.Effects,At),(0,u.Z)(a,y.DataGroup.Timing,At),a);function Qt(e){var t=h.useContext(Te).icons,n=_e(),r=e.selectType,a=e.selectedItems,i=(0,f.Z)(e,z);(0,y.assertSelectType)(r);var o=h.useContext(It),c=a||o.selectedItems,l=o.changeTweening,s=o.selectedInfo,u=s.tweenDefined,d=s.tweenSelected,p=s.onEdge,m=s.time,E=s.nearStart,Z=s.timeRange;(0,y.assertTimeRange)(Z),(0,y.assertTime)(m);var g=u[y.DataGroup.Color],T=d[y.DataGroup.Color],C=(0,y.selectedPropertyObject)(c,y.DataGroup.Color,r),k=C.color,b=C["color".concat(y.PropertyTweenSuffix)],D=T?b:k,S=D.property,x=D.changeHandler,P=D.value,w=D.name,N=S.type,M=S.name,I=w||M,O=Gt[N],R={property:S,value:P,name:I,changeHandler:x};R.time=(0,y.tweenInputTime)(Z,p,E,g,T),T&&(R.defaultValue=k.value);var A=[y.ClassSelected,y.ClassButton].join(" "),j={children:t.start,className:T?y.ClassButton:A,key:"start",onClick:function(){n.goToTime(Z.startTime),l(y.DataGroup.Color,!1)}},G={key:"end",className:T?A:y.ClassButton,children:g?t.end:t.endUndefined,onClick:function(){n.goToTime(Z.lastTime),l(y.DataGroup.Color,!0)}},B={key:"context",value:R,children:O},F=(0,v.Z)((0,v.Z)({},i),{},{key:"inspector-".concat(r,"-").concat(I),children:[t.color,h.createElement(zt.Provider,(0,v.Z)({},B)),h.createElement(ie,{className:"start-end",key:"start-end"},h.createElement(ie,(0,v.Z)({},j)),h.createElement(ie,(0,v.Z)({},G)))]});return h.createElement(ie,(0,v.Z)({},F))}function Yt(e){var t=e.property,n=e.className,r=e.removeHandler,a=e.index,i=e.movable,o=e.selected,c=e.select,l=(0,f.Z)(e,F),s=o===i,u=h.useContext(Te).icons,d=function(){s||c(i)},p=[n||"movable"];s&&p.push(y.ClassSelected);var m=[],Z=i.value("label"),g=i.value("icon");if((0,y.isPopulatedString)(g)){var T=u[g];T&&m.push(T)}(0,y.isPopulatedString)(Z)&&m.push(Z);var C=(0,v.Z)((0,v.Z)({},l),{},{children:m,className:p.join(" "),onMouseDown:d,onDragStart:function(e){s||d();var n=JSON.stringify({index:a}),r=e.dataTransfer;r&&(r.effectAllowed="move",r.setData("".concat(t).concat(E.DragSuffix),n))},onDragEnd:function(e){var t=e.dataTransfer;t&&("none"===t.dropEffect&&r(i))},onClick:function(e){return e.stopPropagation()},draggable:!0});return h.createElement(ie,(0,v.Z)({},C))}function $t(e){var t=e.defaultValue,n=e.changeHandler,r=e.time,a=e.property,i=e.value,o=e.name,c=a.type,l=a.defaultValue,s={key:"context",value:{property:a,value:i,changeHandler:n,name:o,time:r,defaultValue:(0,y.isDefined)(t)?t:l},children:Gt[c]};return h.createElement(zt.Provider,(0,v.Z)({},s))}function en(e){var t=h.useContext(Te).icons,n=h.useContext(It),r=e.selectedItems,a=n.selectedItems,i=r||a,o=[],c=[],l={};return i.forEach((function(n){if((0,y.isSelectedProperty)(n)){var r=n.property,a=n.changeHandler,s=n.selectType,u=n.value,d=n.name,p=r.name,f=r.group;if(f){var m=[f,s].join("-");return void(l[m]||(l[m]=!0,c.push(h.cloneElement(Kt[f],{selectType:s,selectedItems:i}))))}var E=d||p,Z=(0,v.Z)({key:"inspector-".concat(s,"-").concat(E),property:r,value:u,changeHandler:a,name:E},e),g=t[E],T=h.createElement($t,(0,v.Z)({},Z));if(g){var C=[T];C.unshift(g);var k={children:C,className:"row",key:"icon-".concat(s,"-").concat(E)};o.push(h.createElement(ie,(0,v.Z)({},k)))}else o.push(T)}else{var b=n.name;(0,y.assertDataGroup)(b);var D={key:"inspector-".concat(b),selectedMovable:n};c.push(h.cloneElement(Kt[b],D))}})),h.createElement(h.Fragment,null,o,c)}function tn(e){var t=e.useView,n=e.selected,r=(0,f.Z)(e,L);if(!t)return h.createElement("button",(0,v.Z)({},r));var a=r.disabled,i=r.className,o=(0,f.Z)(r,V),c=[y.ClassButton];i&&c.push(i),a?c.push(y.ClassDisabled):n&&c.push(y.ClassSelected);var l=(0,v.Z)((0,v.Z)({},o),{},{className:c.join(" ")});return h.createElement(ie,(0,v.Z)({},l))}function nn(e){var t=e.movableGenerator,n=e.selectedMovable,r=e.property,a=(0,f.Z)(e,H);(0,y.assertPopulatedObject)(n);var i=_e(),o=h.useContext(Te),c=h.useState(!1),l=(0,p.Z)(c,2),s=l[0],u=l[1],d=h.useState(null),m=(0,p.Z)(d,2),Z=m[0],g=m[1],T=h.useRef(null),C=h.useMemo((function(){var e=["list"];return s&&e.push(y.ClassDropping),e.join(" ")}),[s]),k=o.icons,b=n.value,D=n.addHandler,S=n.removeHandler,x=n.moveHandler,P=Z&&b.includes(Z)?Z:null;P!==Z&&g(P);var w=function(e){var t;return!(null===(t=(0,E.dropType)(e.dataTransfer))||void 0===t||!t.startsWith(r))},N={children:b.map((function(e,t){var n={key:e.id,selected:P,select:g,movable:e,index:t,removeHandler:S,property:r};return h.createElement(Yt,(0,v.Z)({},n))})),ref:T,onDragLeave:function(){u(!1)},onDragOver:function(e){var t=w(e);u(t),t&&e.preventDefault()},onDrop:function(e){if(u(!1),w(e)){e.preventDefault();var t=e.dataTransfer;if(t){var n=(0,E.dropType)(t),r=t.getData(n),a=JSON.parse(r).index,i=function(e){var t=e.target;if(t&&t instanceof HTMLDivElement){var n=t.getAttribute("index");if(n)return Number(n)}return b.length}(e);i!==a&&((0,y.assertDefined)(P),x(P,i))}}},onClick:function(){g(null)},key:"view",className:C},M={disabled:!P,onClick:function(){S(P)},key:"remove-button",children:k.remove},I=[k[r],h.createElement(tn,(0,v.Z)({},M))];if(t){var O={key:"add-button",children:k.add,onClick:function(){D(t({}))}};I.push(h.createElement(tn,(0,v.Z)({},O)))}var R={className:"icons",children:I,key:"icons"},A=(0,v.Z)((0,v.Z)({},a),{},{key:"".concat(r,"s-view"),className:"row",children:[h.createElement(ie,(0,v.Z)({},R)),h.createElement(ie,(0,v.Z)({},N))]}),j=h.createElement(ie,(0,v.Z)({},A));if(!P)return j;var G={selectedItems:P.selectedItems(i.actions),key:"movable-properties"};return h.createElement(h.Fragment,null,j,h.createElement(en,(0,v.Z)({},G)))}function rn(e){var t=h.useContext(Te).icons,n=_e(),r=e.selectType,a=e.selectedItems,i=(0,f.Z)(e,W);(0,y.assertSelectType)(r);var o=h.useContext(It),c=a||o.selectedItems,l=o.changeTweening,s=o.selectedInfo,u=s.tweenDefined,d=s.tweenSelected,p=s.onEdge,m=s.time,E=s.nearStart,Z=s.timeRange;(0,y.assertTimeRange)(Z),(0,y.assertTime)(m);var g=u[y.DataGroup.Opacity],T=d[y.DataGroup.Opacity],C=(0,y.selectedPropertyObject)(c,y.DataGroup.Opacity,r),k=C.opacity,b=C["opacity".concat(y.PropertyTweenSuffix)],D=T?b:k,S=D.property,x=D.changeHandler,P=D.value,w=D.name,N=S.type,M=S.name,I=w||M,O=Gt[N],R={property:S,value:P,name:I,changeHandler:x};R.time=(0,y.tweenInputTime)(Z,p,E,g,T),T&&(R.defaultValue=k.value);var A=[y.ClassSelected,y.ClassButton].join(" "),j={children:t.start,className:T?y.ClassButton:A,key:"start",onClick:function(){n.goToTime(Z.startTime),l(y.DataGroup.Opacity,!1)}},G={key:"end",className:T?A:y.ClassButton,children:g?t.end:t.endUndefined,onClick:function(){n.goToTime(Z.lastTime),l(y.DataGroup.Opacity,!0)}},B={key:"context",value:R,children:O},z=(0,v.Z)((0,v.Z)({},i),{},{key:"inspector-".concat(r,"-").concat(I),children:[t.opacity,h.createElement(zt.Provider,(0,v.Z)({},B)),h.createElement(ie,{className:"start-end",key:"start-end"},h.createElement(ie,(0,v.Z)({},j)),h.createElement(ie,(0,v.Z)({},G)))]});return h.createElement(ie,(0,v.Z)({},z))}function an(e){var t=h.useContext(Te).icons,n=_e(),r=e.selectType,a=e.selectedItems,i=(0,f.Z)(e,q);(0,y.assertSelectType)(r);var o=h.useContext(It),c=a||o.selectedItems,l=o.changeTweening,s=o.selectedInfo,u=s.tweenDefined,d=s.tweenSelected,p=s.onEdge,m=s.time,E=s.nearStart,Z=s.timeRange;(0,y.assertTimeRange)(Z),(0,y.assertTime)(m);var g=u[y.DataGroup.Point],T=d[y.DataGroup.Point],C=(0,y.selectedPropertyObject)(c,y.DataGroup.Point,r),k=(0,y.selectedPropertiesScalarObject)(C),b=C.offE,D=C.offW,S=C.offN,x=C.offS,P=C.x,w=C.y,N=C["x".concat(y.PropertyTweenSuffix)],M=C["y".concat(y.PropertyTweenSuffix)],I=T?N:P,O=T?M:w,R=k.offE,A=k.offW,j=k.offN,G=k.offS,B={},z=[I,O],F=(0,y.tweenInputTime)(Z,p,E,g,T);z.forEach((function(e){if(e){var t=e.property,n=e.changeHandler,a=e.value,i=e.name,o=t.type,c=t.name,l=i||c,s=l.replace(y.PropertyTweenSuffix,""),u=Gt[o],d="inspector-".concat(r,"-").concat(l),p={property:t,value:a,name:l,changeHandler:n,time:F};T&&(p.defaultValue=k[s]);var f={key:d,value:p,children:u};B[s]=h.createElement(zt.Provider,(0,v.Z)({},f))}else console.error("PointInput",I,O)}));var L=[y.ClassSelected,y.ClassButton].join(" "),V={children:t.start,className:T?y.ClassButton:L,key:"start",onClick:function(){n.goToTime(Z.startTime),l(y.DataGroup.Point,!1)}},H={key:"end",className:T?L:y.ClassButton,children:g?t.end:t.endUndefined,onClick:function(){n.goToTime(Z.lastTime),l(y.DataGroup.Point,!0)}},W=[t.point,h.createElement(ie,{className:"start-end",key:"".concat(r,"-point-start-end")},h.createElement(ie,(0,v.Z)({},V)),h.createElement(ie,(0,v.Z)({},H)))],U=[h.createElement(ie,{key:"horz-icon",children:t.horz,className:y.ClassButton})],_=[h.createElement(ie,{key:"vert-icon",children:t.vert,className:y.ClassButton})];if(b){var J={key:"lock-east",className:y.ClassButton,children:R?t.unlock:t.lock,onClick:function(){b.changeHandler("offE",!R)}},X=h.createElement(ie,(0,v.Z)({},J));U.push(X)}if(U.push(B.x),D){var K={key:"lock-west",className:y.ClassButton,children:A?t.unlock:t.lock,onClick:function(){D.changeHandler("offW",!A)}},Q=h.createElement(ie,(0,v.Z)({},K));U.push(Q)}if(S){var Y={key:"lock-north",className:y.ClassButton,children:j?t.unlock:t.lock,onClick:function(){S.changeHandler("offN",!j)}},$=h.createElement(ie,(0,v.Z)({},Y));_.push($)}if(_.push(B.y),x){var ee={key:"lock-south",className:y.ClassButton,children:G?t.unlock:t.lock,onClick:function(){x.changeHandler("offS",!G)}},te=h.createElement(ie,(0,v.Z)({},ee));_.push(te)}var ne=[h.createElement(ie,{key:"x",children:U}),h.createElement(ie,{key:"y",children:_})],re=(0,v.Z)({},i);return h.createElement("fieldset",(0,v.Z)({},re),h.createElement("legend",{key:"legend"},h.createElement(ie,null,W)),ne)}Kt[y.DataGroup.Color]=h.createElement(Qt,{className:"color tween row",key:"color-group-input"}),Kt[y.DataGroup.Effects]=h.createElement(nn,{property:"effect",key:"effects-group-input"}),Kt[y.DataGroup.Opacity]=h.createElement(rn,{className:"opacity tween row",key:"opacity-group-input"}),Kt[y.DataGroup.Point]=h.createElement(an,{key:"point-input"});var on=(i={},(0,u.Z)(i,y.Orientation.H,"width"),(0,u.Z)(i,y.Orientation.V,"height"),i);function cn(e){var t=h.useContext(Te).icons,n=_e(),r=e.selectType,a=e.selectedItems,i=(0,f.Z)(e,U);(0,y.assertSelectType)(r,"selectType");var o=h.useContext(It),c=a||o.selectedItems,l=o.selectedInfo,s=o.changeTweening,u=l.tweenDefined,d=l.tweenSelected,p=l.onEdge,m=l.time,E=l.nearStart,Z=l.timeRange;(0,y.assertTimeRange)(Z),(0,y.assertTime)(m);var g=u[y.DataGroup.Size],T=d[y.DataGroup.Size],C=(0,y.selectedPropertyObject)(c,y.DataGroup.Size,r),k=C.lock,b=C.width,D=C.height,S=C["width".concat(y.PropertyTweenSuffix)],x=C["height".concat(y.PropertyTweenSuffix)],P=T?S:b,w=T?x:D,N=(0,y.selectedPropertiesScalarObject)(C),M=N.lock;(0,y.assertString)(M,"lockValue");var I=(0,y.isOrientation)(M)?M:void 0,O={},R=[P,w],A=(0,y.tweenInputTime)(Z,p,E,g,T);R.forEach((function(e){var t=e.property,n=e.changeHandler,a=e.value,i=e.name,o=t.type,c=t.name,l=i||c,s=l.replace(y.PropertyTweenSuffix,""),u=Gt[o],d="inspector-".concat(r,"-").concat(l),p={property:t,value:a,name:l,time:A};T&&(p.defaultValue=N[s]),I&&s===on[I]||(p.changeHandler=n);var f={key:d,value:p,children:u};O[s]=h.createElement(zt.Provider,(0,v.Z)({},f))}));var j={key:"lock-width",className:y.ClassButton,children:I===y.Orientation.H?t.lock:t.unlock,onClick:function(){var e=I===y.Orientation.H?"":y.Orientation.H;k.changeHandler("lock",e)}},G=h.createElement(ie,(0,v.Z)({},j)),B={key:"lock-height",className:y.ClassButton,children:I===y.Orientation.V?t.lock:t.unlock,onClick:function(){var e=I===y.Orientation.V?"":y.Orientation.V;k.changeHandler("lock",e)}},z=[y.ClassSelected,y.ClassButton].join(" "),F=h.createElement(ie,(0,v.Z)({},B)),L={children:t.start,className:T?y.ClassButton:z,key:"start",onClick:function(){n.goToTime(Z.startTime),s(y.DataGroup.Size,!1)}},V={key:"end",className:T?z:y.ClassButton,children:g?t.end:t.endUndefined,onClick:function(){n.goToTime(Z.lastTime),s(y.DataGroup.Size,!0)}},H=[t.size,h.createElement(ie,{className:"start-end",key:"".concat(r,"-size-start-end")},h.createElement(ie,(0,v.Z)({},L)),h.createElement(ie,(0,v.Z)({},V)))],W=[h.createElement(ie,{key:"width-icon",children:t.width,className:y.ClassButton}),O.width,G],q=[h.createElement(ie,{key:"height-icon",children:t.height,className:y.ClassButton}),O.height,F],_=[h.createElement(ie,{key:"width",children:W}),h.createElement(ie,{key:"height",children:q})],J=(0,v.Z)({},i);return h.createElement("fieldset",(0,v.Z)({},J),h.createElement("legend",{key:"legend"},h.createElement(ie,null,H)),_)}function ln(e){var t=h.useContext(Te).icons,n=e.selectType,r=e.selectedItems,a=e.dataGroup,i=(0,f.Z)(e,_);(0,y.assertSelectType)(n);var o=h.useContext(It),l=r||o.selectedItems,s=(0,y.selectedPropertyObject)(l,a,n),u=Object.fromEntries(Object.entries(s).map((function(t){var n=(0,p.Z)(t,2),r=n[0],a=n[1],i=a.property,o=a.changeHandler,c=a.selectType,l=a.value,s=a.name,u=i.name,d=s||u,f=(0,v.Z)({key:"inspector-".concat(c,"-group-").concat(d),property:i,value:l,changeHandler:o,name:d},e);return[r,h.createElement($t,(0,v.Z)({},f))]}))),d=u[a],m=(0,f.Z)(u,[a].map(c.Z)),E=t[a];if(!(0,y.isPopulatedObject)(m))return h.createElement(ie,(0,v.Z)({},{key:a,children:[E,d],className:"row"}));var Z=[E];d&&Z.push(d);var g=Object.entries(m).map((function(e){var n=(0,p.Z)(e,2),r=n[0],a=n[1],i=t[r],o=[a];i&&o.unshift(h.createElement(ie,{key:"".concat(r,"-icon"),children:i,className:y.ClassButton}));var c={key:"".concat(r,"-view"),children:o};return h.createElement(ie,(0,v.Z)({},c))})),T=(0,v.Z)({},i);return h.createElement("fieldset",(0,v.Z)({},T),h.createElement("legend",{key:"legend"},h.createElement(ie,null,Z)),g)}Kt[y.DataGroup.Size]=h.createElement(cn,{key:"size-group-input"});var sn={dataGroup:y.DataGroup.Timing,key:"".concat(y.DataGroup.Timing,"-group-input")};function un(e){var t,n=_e(),r=h.useState((function(){return 0})),a=(0,p.Z)(r,2),i=a[0],o=a[1],c=h.useRef({tweenDefined:{},tweenSelected:{},selectedType:y.SelectType.None,selectTypes:[]}),l=h.useState((function(){return y.SelectTypes})),s=(0,p.Z)(l,2),f=s[0],m=s[1],E=h.useState((function(){return[]})),Z=(0,p.Z)(E,2),g=Z[0],T=Z[1],C=function(){o((function(e){return e+1}))},k=function(){var e=n.selection,t=e.selectTypes,r=e.clip,a=e.mash,i=c.current,o=i.selectedType,l=i.selectTypes,s=f.find((function(e){return t.includes(e)}));(0,y.assertSelectType)(s),s!==o&&(i.selectedType=s),(0,y.arraySet)(l,t);var u=n.selection.selectedItems([s]),d={};if(r&&a){var m=u.filter((function(e){if((0,y.isSelectedProperty)(e)){var t=e.property,n=e.name,r=t.tweenable,a=t.group;return r&&a&&n?n.endsWith(y.PropertyTweenSuffix):void 0}}));if(m.forEach((function(e){var t=e.property,n=e.value,r=t.group;(0,y.assertDataGroup)(r),d[r]=(0,y.isDefined)(n)})),m.length){var v=a.time,h=a.quantize,E=r.timeRange(h);i.time=v,i.timeRange=E;var Z=E.frame+Math.round(E.frames/2),g=(0,y.timeFromArgs)(Z,h),k=(0,y.timeEqualizeRates)(g,v),b=(0,p.Z)(k,2),D=b[0],S=b[1];i.nearStart=D.frame>S.frame;var x=i.nearStart?E.startTime:E.lastTime;i.onEdge=v.equalsTime(x)}}i.tweenDefined=d,T(u),C()};Zt((t={},(0,u.Z)(t,y.EventType.Action,C),(0,u.Z)(t,y.EventType.Selection,k),t));var b=h.useCallback((function(e){(0,y.assertSelectType)(e),m((function(t){var n=t.indexOf(e);(0,y.assertPositive)(n);var r=[e];return n&&r.push.apply(r,(0,d.Z)(t.slice(0,n))),n<t.length-1&&r.push.apply(r,(0,d.Z)(t.slice(n+1))),(0,y.assertTrue)(r.length===t.length,"type lengths match"),(0,y.arraySet)(t,r),k(),t})),c.current.selectedType=e,T(n.selection.selectedItems([e]))}),[]),D=(0,v.Z)((0,v.Z)({},Mt),{},{actionCount:i,selectedItems:g,changeSelected:b,changeTweening:function(e,t){c.current.tweenSelected[e]=t,k()},selectedInfo:c.current});return h.createElement(It.Provider,{value:D},h.createElement(ie,(0,v.Z)({},e)))}function dn(e){return h.createElement(ie,(0,v.Z)({},e))}function pn(e){var t=h.useContext(It).selectedInfo.selectedType,n=e.type,r=e.types,a=e.children,i=ot(n,r);return(0,y.assertPopulatedArray)(i),i.includes(t)?h.createElement(h.Fragment,null,a):null}function fn(e){var t=e.id,n=e.children,r=e.className;(0,y.assertSelectType)(t);var a=h.useContext(It),i=a.changeSelected,o=a.selectedInfo,c=o.selectTypes,l=o.selectedType;if(!c.includes(t))return null;var s=[];(0,y.isPopulatedString)(r)&&s.push(r),l===t&&s.push(y.ClassSelected);var u={children:n,onClick:function(){i(t)},className:s.join(" ")};return h.createElement(ie,(0,v.Z)({},u))}Kt[y.DataGroup.Timing]=h.createElement(ln,(0,v.Z)({},sn));var mn=function(){var e,t,n,r,a,i=Re(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),o=i.icons;(e=i.props).key||(e.key="inspector"),(t=i.props).className||(t.className="panel inspector"),(n=i.header).content||(n.content=[h.createElement(ie,{key:"panel-icon",children:o.inspector}),h.createElement(St,{key:"undo"},h.createElement(tn,null,o.undo,ue("undo"))),h.createElement(bt,{key:"redo"},h.createElement(tn,null,o.redo,ue("redo")))]),(r=i.footer).content||(r.content=[h.createElement(fn,{key:"mash",className:y.ClassButton,id:"mash"},o.mmTube),h.createElement(fn,{key:"clip",className:y.ClassButton,id:"clip"},o.clip),h.createElement(fn,{key:"container",className:y.ClassButton,id:"container"},o.container),h.createElement(fn,{key:"content",className:y.ClassButton,id:"content"},o.content)]);var c=[h.createElement(en,{key:"properties"})],l=[y.SelectType.Clip,y.SelectType.Track];c.push(h.createElement(pn,{type:"mash",key:"inspector-mash"},h.createElement(ie,null,h.createElement(xt,{key:"render-process"},h.createElement(tn,null,ue("render"),o.render)),h.createElement(Rt,{key:"view-control"},h.createElement(tn,null,ue("view"),o.view))))),l.forEach((function(e){c.push(h.createElement(pn,{key:"".concat(e,"-delete"),type:e},h.createElement(Dt,{type:e},h.createElement(tn,null,de("delete",{type:e}),o.remove))))})),(a=i.content).children||(a.children=h.createElement(h.Fragment,null,c));var s=h.createElement(h.Fragment,null,h.createElement(Oe,(0,v.Z)({},i.header)),h.createElement(dn,(0,v.Z)({},i.content.props),i.content.children),h.createElement(Oe,(0,v.Z)({},i.footer)));return(0,v.Z)((0,v.Z)({},i.props),{},{children:s})},vn=function(e,t){if(t&&e){var n=t.width,r=t.height;e.style.setProperty("--preview-width","".concat(n,"px")),e.style.setProperty("--preview-height","".concat(r,"px"))}};function hn(e){var t=e.editType,n=void 0===t?y.VideoType:t,r=e.clientOptions,a=void 0===r?E.ClientDisabledArgs:r,i=e.previewSize,o=e.icons,c=void 0===o?{}:o,l=e.mashMedia,s=(0,f.Z)(e,J);console.log("Masher",n,i);var u=h.useRef((0,E.clientInstance)(a)),d=h.useRef((0,y.editorInstance)({editType:n})),m=h.useRef({}),Z=h.useRef({}),g=h.useRef(null),T=h.useRef(null),C=h.useContext(Nt),k=h.useState(!1),b=(0,p.Z)(k,2),D=b[0],S=b[1],x=h.useState(!1),P=(0,p.Z)(x,2),w=P[0],N=P[1],M=u.current,I=d.current,O=m.current,R=Z.current,A=C.endpointPromise,j=C.servers;h.useEffect((function(){vn(T.current,i)}),[i]);var G=function(e){var t=e||l||{mash:{id:(0,y.idTemporary)(),media:[]}};console.log("Masher.editorLoad",e,l,t);var n=g.current;(0,y.assertObject)(n,"svg"),I.svgElement=n;var r=t.mash;I.load(r)};h.useEffect((function(){if(console.debug("Masher useEffect",D),M.enabled(E.ReadOperation)){if(!D){S(!0);var e={};console.debug("DataDefaultRequest",y.Endpoints.data[n].default,e),A(y.Endpoints.data[n].default,e).then((function(e){var t,r;console.debug("DataDefaultResponse",y.Endpoints.data[n].default,e);e.previewSize;console.log("Masher DataDefaultResponse",null===(t=j.file)||void 0===t?void 0:t.prefix),null!==(r=j.file)&&void 0!==r&&r.prefix&&((0,y.urlBaseInitialize)(String(j.file.prefix)),console.log("Masher DataDefaultResponse",j.file.prefix)),G(e)}))}}else G()}),[D]);var B=function(e){R.mediaId=null===e||void 0===e?void 0:e.id},z={client:M,editor:I,streaming:w,setStreaming:N,current:R,editorIndex:O,drop:function(e,t){return console.log("Masher drop",e,t),e?(console.log("Masher drop editorIndex = ",t),(0,y.isClip)(e)?(console.log("Masher drop Clip"),Promise.resolve([])):(0,y.isEffect)(e)?(console.log("Masher drop Effect"),Promise.resolve([])):(0,y.isMediaObject)(e)?(console.log("Masher drop DefinitionObject"),function(e,t){return I.addMedia(e,t)}(e,t)):(0,y.isMashAndMediaObject)(e)?(console.log("Masher drop MashAndMediaObject"),Promise.resolve([])):function(e,t){var n=(0,E.dropFilesFromList)(e,j.file);if(n.length){var r=[],a=[],i=I.eventTarget;if(n.forEach((function(e){e instanceof File?a.push(e):r.push(e)})),r.length&&r.forEach((function(e){var t=(0,v.Z)({id:(0,y.idGenerate)("activity-error"),type:E.ActivityType.Error},e);i.emit(y.EventType.Active,t)})),a.length)return I.addFiles(a,t)}else console.log("Masher.dropFiles no info");return Promise.resolve([])}(e,t).then((function(e){console.log("Masher.dropFiles",e);var t=(0,p.Z)(e,1)[0];return(0,y.isMedia)(t)&&B(t),e}))):Promise.resolve([])},changeDefinition:B,icons:c},F=(0,v.Z)((0,v.Z)({},s),{},{onDrop:y.eventStop,ref:T});return h.createElement(Te.Provider,{value:z},h.createElement(ie,(0,v.Z)({},F)),h.createElement("svg",{style:{display:"none"},ref:g}))}var yn={paused:!1,changePaused:y.EmptyMethod,changeVolume:y.EmptyMethod,volume:0},En=h.createContext(yn),Zn=10;function gn(e){var t,n=e.children,r=e.className,a=(0,f.Z)(e,X),i=_e(),o=h.useState((function(){return(0,y.rectCopy)(i.rect)})),c=(0,p.Z)(o,2),l=c[0],s=c[1],m=h.useRef(null),Z=h.useRef(null),g=h.useContext(Te),T=h.useState(!1),C=(0,p.Z)(T,2),k=C[0],b=C[1],D=h.useContext(En).disabled,S=g.drop,x=h.useRef({}).current,P=h.useState(new ResizeObserver((function(){var e=Z.current;if(e){var t=(0,y.rectRound)(e.getBoundingClientRect());s((function(){return i.rect=t,(0,y.rectCopy)(t)}))}}))),w=(0,p.Z)(P,1)[0];h.useEffect((function(){var e=Z.current;return e&&w.observe(e),function(){w.disconnect()}}),[]);var N=function(){var e=x.redraw;return delete x.timeout,delete x.redraw,i.previewItems(!D).then((function(t){(function(e){var t=m.current;t&&t.replaceChildren.apply(t,(0,d.Z)(e))})(t),e&&I()}))},M=function(){N().then(y.EmptyMethod)},I=function(){var e=m.current,t=i.rect;if(e&&(0,y.sizeAboveZero)(t)){if(x.timeout)return void(x.redraw=!0);x.timeout=setTimeout(M,Zn)}};Zt((t={},(0,u.Z)(t,y.EventType.Draw,I),(0,u.Z)(t,y.EventType.Selection,I),t));var O=function(e){return!!e&&(!!(0,E.dragTypes)(e).includes(E.TransferTypeFiles)||(0,y.isMediaType)((0,E.dragType)(e)))},R=function(e){(0,y.eventStop)(e),b(!1)},A=[];r&&A.push(r),k&&A.push(y.ClassDropping);var j=(0,v.Z)((0,v.Z)({},a),{},{ref:Z,className:A.join(" "),key:"player-content",onDragOver:function(e){(0,y.eventStop)(e),b(O(e.dataTransfer))},onDrop:function(e){R(e);var t=e.dataTransfer;if(O(t)){var n=i.mashMedia;(0,y.assertObject)(n,"mashMedia");var r={clip:i.time.scale(n.quantize).frame,track:-1};if((0,E.dragTypes)(t).includes(E.TransferTypeFiles))S(t.files,r);else{var a=(0,E.dragType)(t);(0,y.assertMediaType)(a);var o=(0,E.dragData)(t,a);(0,E.assertDragDefinitionObject)(o);var c=o.mediaObject;(0,y.isMediaObject)(c)&&S(c,r)}}},onDragLeave:R,onPointerDown:function(){i.selection.unset(y.SelectType.Clip)}});if((0,y.sizeAboveZero)(l)){var G=[h.createElement("div",(0,v.Z)({},{ref:m,key:"svg",className:"svgs"}))];if(n){var B=h.Children.only(n);h.isValidElement(B)&&G.push(B)}j.children=G}return h.createElement(ie,(0,v.Z)({},j))}function Tn(e){var t=h.useContext(En),n=t.paused,r=t.changePaused,a=(0,v.Z)((0,v.Z)({},e),{},{key:"player-button",onClick:function(){r(!n)}});return h.createElement(ie,(0,v.Z)({},a))}function Cn(e){var t,n=_e(),r=function(){return n.timeRange.timeRange},a=h.useState(r),i=(0,p.Z)(a,2),o=i[0],c=i[1],l=function(){c(r())};Zt((t={},(0,u.Z)(t,y.EventType.Time,l),(0,u.Z)(t,y.EventType.Duration,l),t));var s=(0,v.Z)({value:o.frame,min:0,max:o.frames,step:1,onChange:function(e,t){var r=(0,y.isArray)(t)?t[0]:t;n.time=(0,y.timeFromArgs)(r,o.fps)},className:"frame slider"},e);return h.createElement(qt,(0,v.Z)({},s))}function kn(e){return h.useContext(En).paused?null:e.children}function bn(e){return h.useContext(En).paused?e.children:null}function Dn(e){var t,n=_e(),r=function(){return n.timeRange},a=h.useState(r),i=(0,p.Z)(a,2),o=i[0],c=i[1],l=function(){c(r())};Zt((t={},(0,u.Z)(t,y.EventType.Time,l),(0,u.Z)(t,y.EventType.Duration,l),t));var s=o.seconds,d=o.fps,f=o.lengthSeconds,m=[(0,y.stringSeconds)(s,d,f),"/",(0,y.stringSeconds)(f,d,f)],E=(0,v.Z)((0,v.Z)({},e),{},{key:"player-time",children:m});return h.createElement(ie,(0,v.Z)({},E))}var Sn=function(){var e,t,n,r,a,i=Re(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),o=i.icons;(e=i.props).key||(e.key="player"),(t=i.props).className||(t.className="panel player"),(n=i.content).children||(n.children=h.createElement(gn,(0,v.Z)({},i.content.props),h.createElement(ie,{key:"drop-box",className:"drop-box"}))),(r=i.header).content||(r.content=[h.createElement(ie,{key:"panel-icon",children:o.app}),h.createElement(Ot,{key:"select-mashMedia",className:"row",children:o.document}),h.createElement(Pt,{key:"save-process"},h.createElement(tn,{key:"button"},ue("update"),o.document)),h.createElement(kt,{key:"create-mashMedia"},h.createElement(tn,null,ue("create"),o.document))]),(a=i.footer).content||(a.content=[h.createElement(Tn,{key:"play-button",className:y.ClassButton},h.createElement(kn,{key:"playing"},o.pause),h.createElement(bn,{key:"not-playing"},o.play)),h.createElement(Cn,{key:"time-slider"}),h.createElement(Dn,{key:"time",className:"time"})]);var c=h.createElement(h.Fragment,null,h.createElement(Oe,(0,v.Z)({},i.header)),i.content.children,h.createElement(Oe,(0,v.Z)({},i.footer)));return(0,v.Z)((0,v.Z)({},i.props),{},{children:c})};function xn(e){var t=h.useContext(Et),n=t.scale,r=t.frame,a=h.useMemo((function(){return(0,v.Z)((0,v.Z)({},e),{},{style:{left:(0,E.pixelFromFrame)(r,n)}})}),[r,n]);return h.createElement(ie,(0,v.Z)({},a))}function Pn(e){var t=_e().selection.mash,n=e.className,r=e.children,a=(0,f.Z)(e,K),i=h.Children.only(r);(0,y.assertTrue)(h.isValidElement(i));var o=h.useContext(ht),c=h.useContext(Et),l=o.track,s=c.dragTypeValid,u=c.onDragLeave,d=c.onDrop,p=c.droppingTrack,m=c.setDroppingTrack,Z=c.droppingPosition,g=c.setDroppingPosition,T=c.setDroppingClip,C=c.selectedTrack,k=h.useMemo((function(){var e=l===C,t=[];return n&&t.push(n),e&&t.push(y.ClassSelected),p===l&&t.push((0,E.droppingPositionClass)(Z)),t.join(" ")}),[Z,p,C]);if(!t||!l)return null;var b=l.clips,D=l.dense,S=l.index,x=(0,v.Z)((0,v.Z)({},a),{},{className:k,children:function(){var e=D?-1:0,t=i.props;return b.map((function(n){var r=(0,v.Z)((0,v.Z)({},t),{},{key:n.id}),a={children:h.cloneElement(i,r),value:{clip:n,prevClipEnd:e},key:n.id},o=h.createElement(mt.Provider,(0,v.Z)({},a));return D||(e=n.frames+n.frame),o}))}(),onDragLeave:u,onDragOver:function(e){(0,y.eventStop)(e);var t=e.dataTransfer;if(t){var n=s(t),r=n?y.DroppingPosition.At:y.DroppingPosition.None;T(),m(n?l:void 0),g(r)}},onDrop:d,key:"track-".concat(S)});return h.createElement(ie,(0,v.Z)({},x))}function wn(e){var t=h.useRef(null),n=h.useContext(Et),r=h.useState(new ResizeObserver((function(){(0,n.setRect)(t.current.getBoundingClientRect())}))),a=(0,p.Z)(r,1)[0];h.useEffect((function(){var e=t.current;return e&&a.observe(e),function(){a.disconnect()}}),[t.current]);var i=(0,v.Z)((0,v.Z)({},e),{},{ref:t});return h.createElement(ie,(0,v.Z)({},i))}function Nn(e){var t=_e(),n=h.useContext(Et),r=function(){return!t.selection.mash},a=h.useState(r),i=(0,p.Z)(a,2),o=i[0],c=i[1];Zt((0,u.Z)({},y.EventType.Selection,(function(){c(r())})));var l=(0,v.Z)({disabled:o,key:"time-slider",value:n.zoom,min:0,max:1,step:.01,onChange:function(e,t){var r=(0,y.isArray)(t)?t[0]:t;n.zoom!==r&&n.setZoom(r)}},e);return h.createElement(qt,(0,v.Z)({className:"zoom slider"},l))}function Mn(e){var t,n=h.useState((function(){return 0})),r=(0,p.Z)(n,2),a=r[0],i=r[1],o=function(){i((function(e){return e+1}))},c=_e();Zt((t={},(0,u.Z)(t,y.EventType.Loaded,o),(0,u.Z)(t,y.EventType.Track,o),t));var l=e.children,s={key:"track-content",children:h.useMemo((function(){var e=c.selection.mash;if(!e)return[];var t=e.tracks;return(0,y.arrayReversed)(t).map((function(e,t){var n=e.identifier,r=e.index,a={children:h.Children.map(l,(function(e){if(!h.isValidElement(e))throw"TimelineTracks";return h.cloneElement(e,{key:"track-clone-".concat(t,"-").concat(r,"-").concat(n)})})),value:{track:e},key:"track-context-".concat(t,"-").concat(r,"-").concat(n)};return h.createElement(ht.Provider,(0,v.Z)({},a))}))}),[a])};return h.createElement(h.Fragment,(0,v.Z)({},s))}function In(e){var t=_e(),n=h.useRef(-1),r=h.useRef(null),a=h.useContext(Et),i=a.frames,o=a.scale,c=a.rect,l=e.className,s=e.inactive,d=e.styleHeight,m=e.styleWidth,Z=(0,f.Z)(e,Q),g=function(){return!t.selection.mash},T=h.useState(g),C=(0,p.Z)(T,2),k=C[0],b=C[1];Zt((0,u.Z)({},y.EventType.Selection,(function(){b(g())})));var D=c.width,S=c.height,x=h.useMemo((function(){var e=[];l&&e.push(l),k&&e.push(y.ClassDisabled);var a=(0,v.Z)((0,v.Z)({},Z),{},{ref:r,className:e.join(" ")});if(m||d){var c={};if(d&&(c.minHeight=S),m){var u=(0,E.pixelFromFrame)(i,o,"ceil");c.minWidth=Math.max(u,u)}a.style=c}return s||k||(a.onPointerDown=function(){var e=globalThis.window,a=function(){e.removeEventListener("pointermove",i),e.removeEventListener("pointerup",c)},i=function(e){(0,y.eventStop)(e);var a=r.current;if(a&&t.selection.mash){var i=e.clientX;if(n.current!==i){n.current=i;var c=a.getBoundingClientRect(),l=Math.max(0,Math.min(c.width,i-c.x)),s=(0,y.pixelToFrame)(l,o,"floor");t.time=(0,y.timeFromArgs)(s,t.selection.mash.quantize)}}},c=function(e){i(e),a()};return function(t){t.stopPropagation(),n.current=-1,e.addEventListener("pointermove",i),e.addEventListener("pointerup",c),i(t)}}()),a}),[i,o,D,S,k]);return h.createElement(ie,(0,v.Z)({},x))}function On(e){var t=e.className,n=(0,f.Z)(e,Y),r=h.useContext(Et),a=r.dragTypeValid,i=r.onDrop,o=r.setScroll,c=r.setDroppingClip,l=r.setDroppingTrack,s=r.setDroppingPosition,d=h.useRef(null),m=h.useState(!1),E=(0,p.Z)(m,2),Z=E[0],g=E[1],T=_e();Zt((0,u.Z)({},y.EventType.Loaded,(function(){var e;null===(e=d.current)||void 0===e||e.scrollTo(0,0)})));var C=function(e){(0,y.eventStop)(e),g(!1)},k=[];t&&k.push(t),Z&&k.push(y.ClassDropping);var b=(0,v.Z)((0,v.Z)({className:k.join(" ")},n),{},{onPointerDown:function(){T.selection.unset(y.SelectType.Track)},onScroll:function(){var e=d.current;if(e){var t=e.scrollLeft,n=e.scrollTop;o({x:t,y:n})}},onDragOver:function(e){(0,y.eventStop)(e);var t=e.dataTransfer;if(t){var n=a(t),r=n?y.DroppingPosition.At:y.DroppingPosition.None;c(),l(),s(r),g(n)}},onDragLeave:C,onDrop:function(e){C(e),i(e)},ref:d});return h.createElement(ie,(0,v.Z)({},b))}function Rn(e){var t=_e(),n=function(){return!t.selection.mash},r=h.useState(n),a=(0,p.Z)(r,2),i=a[0],o=a[1];Zt((0,u.Z)({},y.EventType.Selection,(function(){o(n())})));var c=e.children,l=(0,f.Z)(e,$),s=(0,v.Z)((0,v.Z)({},l),{},{disabled:i});return s.onClick=function(){t.addTrack()},h.cloneElement(h.Children.only(c),s)}function An(e){var t=e.className,n=e.icons,r=(0,f.Z)(e,ee),a=h.useContext(Et),i=h.useContext(ht),o=a.droppingTrack,c=a.droppingPosition,l=a.selectedTrack,s=i.track,u=h.useMemo((function(){var e=[];return t&&e.push(t),s===l&&e.push(y.ClassSelected),s===o&&e.push((0,E.droppingPositionClass)(c)),e.join(" ")}),[c,o,l]);if(!s)return null;var d=s.dense,p=s.index,m=d?n.trackDense:n.track,Z=(0,v.Z)((0,v.Z)({},r),{},{className:u,children:m,key:"track-icon-".concat(p)});return h.createElement(ie,(0,v.Z)({},Z))}function jn(e){var t=_e(),n=e.zoom,r=e.children,a=(0,f.Z)(e,te),i=h.useContext(Et),o=function(){return!t.selection.mash},c=h.useState(o),l=(0,p.Z)(c,2),s=l[0],d=l[1];Zt((0,u.Z)({},y.EventType.Selection,(function(){d(o())})));var m=(0,v.Z)((0,v.Z)({},a),{},{onClick:function(){i.setZoom(n)},disabled:s});return h.cloneElement(h.Children.only(r),m)}function Gn(e){var t=_e(),n=h.useContext(Te),r=n.current,a=n.drop,i=function(){return!t.selection.mash},o=h.useState(i),c=(0,p.Z)(o,2),l=c[0],s=c[1];Zt((0,u.Z)({},y.EventType.Selection,(function(){s(i())})));var d=e.children,m=(0,f.Z)(e,ne),E=(0,v.Z)((0,v.Z)({},m),{},{disabled:l});return E.onClick=function(){var e=t.selection,n=t.mashMedia,i=e.clip,o=e.track,c=r.mediaId||y.DefaultContentId;(0,y.assertPopulatedString)(c);var l={id:c},s={clip:0,track:-1};i&&o?(s.clip=o.dense?o.clips.indexOf(i):i.endFrame,s.track=o.index):s.clip=t.time.scale(n.quantize).frame,a(l,s)},h.cloneElement(h.Children.only(d),E)}var Bn=function(){var e,t,n,r,a,i=Re(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),o=i.icons;(e=i.props).key||(e.key="timeline"),(t=i.props).className||(t.className="panel timeline"),(n=i.header).content||(n.content=[h.createElement(ie,{key:"panel-icon",children:o.timeline})]),(r=i.footer).content||(r.content=[h.createElement(Gn,{key:"add-clip"},h.createElement(tn,{children:o.add})),h.createElement(Rn,{key:"add-track"},h.createElement(tn,{children:[o.add,o.trackDense]})),h.createElement(jn,{key:"zoom-out",zoom:0},h.createElement(tn,{useView:!0},o.zoomLess)),h.createElement(Nn,{key:"zoomer"}),h.createElement(jn,{key:"zoom-in",zoom:1},h.createElement(tn,{useView:!0},o.zoomMore))]),(a=i.content).children||(a.children=h.createElement(h.Fragment,null,h.createElement(In,{styleWidth:!0,inactive:!0,styleHeight:!0,className:"scrubber-bar"},h.createElement(xn,{className:"scrubber-element-bar"})),h.createElement(In,{styleWidth:!0,className:"scrubber-icon"},h.createElement(xn,{className:"scrubber-element-icon"})),h.createElement(Mn,null,h.createElement(An,{className:"track-icon",icons:o}),h.createElement(Pn,{className:"track"},h.createElement(Tt,{className:"clip preview"}))),h.createElement(wn,{className:"drop-box"})));var c=h.createElement(h.Fragment,null,h.createElement(Oe,(0,v.Z)({},i.header)),h.createElement(On,(0,v.Z)({},i.content.props),i.content.children),h.createElement(Oe,(0,v.Z)({},i.footer)));return(0,v.Z)((0,v.Z)({},i.props),{},{children:c})};function zn(e){var t,n=e.disabled,r=(0,f.Z)(e,re),a=_e(),i=h.useState(a.paused),o=(0,p.Z)(i,2),c=o[0],l=o[1],s=h.useState(a.volume),d=(0,p.Z)(s,2),m=d[0],E=d[1],Z=function(){l(a.paused)};Zt((t={},(0,u.Z)(t,y.EventType.Pause,Z),(0,u.Z)(t,y.EventType.Play,Z),(0,u.Z)(t,y.EventType.Volume,(function(){E(a.volume)})),t));var g={value:{paused:c,disabled:n,volume:m,changePaused:function(e){a.paused=e},changeVolume:function(e){a.volume=e}},children:h.createElement(ie,(0,v.Z)({},r))};return h.createElement(En.Provider,(0,v.Z)({},g))}var Fn=1;function Ln(e){var t,n=_e(),r=h.useContext(Te).drop,a=function(){var e;return(null===(e=n.selection.mash)||void 0===e?void 0:e.frame)||0},i=function(){var e;return(null===(e=n.selection.mash)||void 0===e?void 0:e.frames)||0},o=h.useState(i),c=(0,p.Z)(o,2),l=c[0],s=c[1],d=h.useState(a),f=(0,p.Z)(d,2),m=f[0],Z=f[1],g=h.useState(y.DroppingPosition.None),T=(0,p.Z)(g,2),C=T[0],k=T[1],b=h.useState(),D=(0,p.Z)(b,2),S=D[0],x=D[1],P=h.useState(),w=(0,p.Z)(P,2),N=w[0],M=w[1],I=h.useState(),O=(0,p.Z)(I,2),R=O[0],A=O[1],j=h.useState(0),G=(0,p.Z)(j,2),B=G[0],z=G[1],F=h.useState(),L=(0,p.Z)(F,2),V=L[0],H=L[1],W=h.useState(Fn),q=(0,p.Z)(W,2),U=q[0],_=q[1],J=h.useState(y.RectZero),X=(0,p.Z)(J,2),K=X[0],Q=X[1],Y=h.useState(y.RectZero),$=(0,p.Z)(Y,2),ee=$[0],te=$[1],ne=function(){z((function(e){return e+1}))};Zt((t={},(0,u.Z)(t,y.EventType.Loaded,(function(){_(Fn)})),(0,u.Z)(t,y.EventType.Action,ne),(0,u.Z)(t,y.EventType.Selection,(function(){H(n.selection.clip),A(n.selection.track)})),(0,u.Z)(t,y.EventType.Time,(function(){Z(a())})),(0,u.Z)(t,y.EventType.Duration,(function(){s(i())})),t));var re=function(e,t){var n=(0,E.dragTypes)(e);if(n.includes(E.TransferTypeFiles))return!0;var r=n.find(E.isTransferType);return!!r&&(!(!t&&!r.startsWith("clip"))||(0,E.dragMediaType)(r)!==y.EffectType)},ae=function(e){(0,y.eventStop)(e),k(y.DroppingPosition.None),x(void 0),M(void 0)},oe=K.width,ce=h.useMemo((function(){return oe?(0,E.pixelPerFrame)(l,oe,U):0}),[U,oe,l]),le={scroll:ee,setScroll:te,scale:ce,refreshed:B,refresh:ne,zoom:U,setZoom:_,rect:K,setRect:Q,droppingTrack:S,setDroppingTrack:x,droppingClip:N,setDroppingClip:M,droppingPosition:C,setDroppingPosition:k,onDragLeave:ae,onDrop:function(e){(0,y.eventStop)(e);var t=e.dataTransfer,a=e.clientX;if(console.log("Timeline onDrop",null===t||void 0===t?void 0:t.types),t&&re(t,N)){console.log("Timeline onDrop",t.types,N);var i=(0,E.dragTypes)(t).includes(E.TransferTypeFiles),o=!(null===S||void 0===S||!S.dense),c=S?S.index:-1,l=(null===S||void 0===S?void 0:S.clips)||[],s=i?{}:(0,E.dragData)(t),u=!i&&(0,E.isDragOffsetObject)(s),d=u?s.offset:0,p=function(e,t){if(!e)return-1;if(!N)return 0;var n=t.indexOf(N);return C===y.DroppingPosition.After?n+1:n}(o,l);if(!(0,y.isPositive)(p)){var f=a-K.x,m=(0,y.pixelToFrame)(Math.max(0,ee.x+(f-d)),ce);p=o?function(e,t){var n=t.length;if(!n)return 0;var r=t.findIndex((function(t){return e<t.frame+t.frames}));return r>-1?r:n}(m,l):m}var v={clip:p,track:c};if(i)r(t.files,v);else if(u)if(console.log("onDrop",s),(0,E.isDragDefinitionObject)(s)){var h=s.mediaObject;(0,y.isMediaObject)(h)&&r(h,v)}else{var Z=n.selection.clip;(0,y.assertClip)(Z),n.moveClip(Z,v)}ae(e)}else console.log("Timeline onDrop invalid",null===t||void 0===t?void 0:t.types,!!N)},dragTypeValid:re,selectedClip:V,selectedTrack:R,frame:m,frames:l},se={children:h.createElement(ie,(0,v.Z)({},e)),value:le};return h.createElement(Et.Provider,(0,v.Z)({},se))}function Vn(e){return h.createElement(ie,(0,v.Z)({},e))}var Hn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.className||(e.className="editor masher"),e.icons||(e.icons=Z.Icons);var t=e.panels,n=void 0===t?{}:t,r=(0,f.Z)(e,ae),a=n.player,i=void 0===a?{}:a,o=n.browser,c=void 0===o?{}:o,l=n.timeline,s=void 0===l?{}:l,u=n.inspector,d=void 0===u?{}:u,p=n.activity,m=void 0===p?{}:p,E=[];if(i&&(i.icons||(i.icons=e.icons),E.push(h.createElement(zn,(0,v.Z)({},Sn(i))))),c&&(c.icons||(c.icons=e.icons),E.push(h.createElement(et,(0,v.Z)({},pt(c))))),d||m){var g=[];m&&(m.icons||(m.icons=e.icons),g.push(h.createElement(ke,(0,v.Z)({},Fe(m))))),d&&(d.icons||(d.icons=e.icons),g.push(h.createElement(un,(0,v.Z)({},mn(d)))));var T={children:g,key:"panels",className:"panels"};E.push(h.createElement(Vn,(0,v.Z)({},T)))}return s&&(s.icons||(s.icons=e.icons),E.push(h.createElement(Ln,(0,v.Z)({},Bn(s))))),(0,v.Z)((0,v.Z)({className:"editor masher"},r),{},{editType:y.VideoType,children:E})};function Wn(e){var t=e.type,n=e.types,r=e.children,a=it(t,n),i=_e();return a.includes(i.editType)?h.createElement(h.Fragment,null,r):null}function qn(e){var t=e.children,n=e.className;return t?h.createElement(ie,(0,v.Z)({},{className:n,children:t})):null}function Un(e){var t=e.children,n=e.className;return t?h.createElement(ie,(0,v.Z)({},{className:n,children:t})):null}var _n=function(e){return globalThis.window.sessionStorage.getItem(e)||""},Jn=function(e,t){globalThis.window.sessionStorage.setItem(e,String(t))},Xn=h.forwardRef((function(e,t){return h.createElement("video",(0,v.Z)((0,v.Z)({},e),{},{ref:t}))}))}}]);
//# sourceMappingURL=128.d431e0d7.chunk.js.map