(self.webpackChunk_moviemasher_example_supabase=self.webpackChunk_moviemasher_example_supabase||[]).push([[982],{1982:function(e,t,i){var n=i(4704).default,r=i(3496).default,a=i(1588).default,o=i(3808).default,s=i(215).default,u=i(6115).default,c=i(1655).default,l=i(6389).default,h=i(6690).default,f=i(9728).default,d=i(861).default,p=i(7424).default,v=i(8416).default,m=i(2122).default,y=["response"],g=["undoSelection","redoSelection","type"],k=["type","name","defaultValue"],T=["filter"],b=["lock"],w=["clip"],F=["contentColors"],S=["contentColors"];!function(e){"use strict";var t,I,C,P,x,A,M,D,z,E,V={Environment:"error.environment",DecodeProbe:"decode.probe",Unknown:"error.unknown",Internal:"error.internal",Type:"error.type",Reference:"error.reference",Range:"error.range",Syntax:"error.syntax",Url:"error.url",Evaluation:"error.evaluation",ClientDisabledDelete:"client.disabled.delete",ClientDisabledGet:"client.disabled.get",ClientDisabledList:"client.disabled.list",ClientDisabledSave:"client.disabled.save",ImportType:"import.type",ImportDuration:"import.duration",ImportSize:"import.size",ImportFile:"import.file",ServerAuthentication:"server.authentication",ServerAuthorization:"server.authorization",FilterId:"filter.id",MediaId:"media.id",Unimplemented:"error.unimplemented",Frame:"error.frame",OutputDuration:"output.duration",OutputDimensions:"output.dimensions"},R=Object.values(V),O={Error:V.Unknown,EvalError:V.Evaluation,InternalError:V.Internal,RangeError:V.Range,ReferenceError:V.Reference,SyntaxError:V.Syntax,TypeError:V.Type,URIError:V.Url},_=function(e){return"string"===typeof e&&R.includes(e)},j=function(e,t){return"string"===typeof t?t:e},N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:V.Internal,i=arguments.length>2?arguments[2]:void 0,n=new Error(e);return Object.assign(n,{name:t,cause:i}),n},q=function(e){if(_(e))return B(e);if("string"===typeof e)return N(e);var t=e.message,i=void 0===t?"":t,n=e.name,r=void 0===n?V.Internal:n,a=i||String(r);return N(a,r,e)},B=function(e,t){return{name:e,message:j(e,t)}},U=function(e,t){return{error:B(e,t)}},L=function(e){return{error:q(e)}},G=function(e,t){return Promise.resolve(U(e,t))},H=function(e,t,i){var n=typeof e,r="undefined"!==n,a="object"===n,o=[i||(r?n:"value"),"is"];return o.push(a?e.constructor.name:n),r&&o.push(a?JSON.stringify(e):"'".concat(e,"'")),o.push("instead of",t),N(o.join(" "),V.Type)},W=function(e,t,i){var n=t?H(e,t,i):q(e),r=n.message,a=n.name,o=n.cause,s=N(r,a,o);throw console.trace(s.toString()),s},J=function(e){return"object"===typeof e};function K(e,t){J(e)||W(e,"Object",t)}var X=function(e){return"string"===typeof e};function Y(e,t){X(e)||W(e,"String",t)}var Z=function(e){return"undefined"===typeof e},$=function(e){return"number"===typeof e};function Q(e,t){$(e)||W(e,"Number",t)}var ee=function(e){return"boolean"===typeof e};function te(e,t){ee(e)||W(e,"Boolean",t)}var ie=function(e){return"function"===typeof e};function ne(e,t){ie(e)||W(e,"Method",t)}var re=function(e){return!Z(e)};function ae(e,t){re(e)||W(e,"Defined",t)}var oe=function(e){return $(e)&&Number.isNaN(e)},se=function(e){return $(e)&&!Number.isNaN(e)},ue=function(e){return Number.isInteger(e)};function ce(e,t){ue(e)||W(e,"Integer",t)}var le=function(e){return se(e)&&!ue(e)},he=function(e){return se(e)&&e>=0};function fe(e,t){he(e)||W(e,">= 0",t)}var de=function(e){return se(e)&&e<1},pe=function(e){return se(e)&&e>0};function ve(e,t){pe(e)||W(e,"> zero",t)}var me=function(e){return re(Array.isArray)?Array.isArray(e):e instanceof Array};function ye(e,t){me(e)||W(e,"Array",t)}var ge=function(e){return!!e.length},ke=function(e){return X(e)&&ge(String(e))};function Te(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";ke(e)||W(e,"populated string",t)}var be=function(e){return me(e)&&ge(e)};function we(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";be(e)||W(e,"populated array",t)}var Fe=function(e){return J(e)&&ge(Object.keys(e))};function Se(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value";Fe(e)||W(e,"populated array",t)}var Ie=function(e){return(se(e)||ke(e))&&!oe(Number(e))};function Ce(e){e||W(e,"true",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value")}var Pe=function(e){return J(e)&&"r"in e&&"g"in e&&"b"in e};function xe(e,t){Pe(e)||W(e,"Rgb",t)}var Ae=function(e){return J(e)&&"isRange"in e};function Me(e,t){Ae(e)||W(e,"Time",t)}var De=function(e){return Ae(e)&&e.isRange};function ze(e,t){De(e)||W(e,"TimeRange",t)}var Ee=function(e){return se(e)||X(e)},Ve=function(e){return!!Ee(e)&&(Ie(e)?!!Number(e):ke(e))};function Re(e,t){Ee(e)||W(e,"Value",t)}var Oe=function(e){return J(e)&&Object.values(e).every((function(e){return Ee(e)}))};function _e(e,t){Oe(e)||W(e,"ValueRecord",t)}var je=function(e){return J(e)&&!("error"in e)},Ne=function(e){return me(e)},qe=function(e){return J(e)&&"error"in e&&J(e.error)},Be="audio",Ue="effect",Le="font",Ge="image",He="mash",We="sequence",Je="video",Ke="audiostream",Xe="videostream",Ye="json",Ze="record",$e="records",Qe=[Be,Ue,Le,Ge,He,We,Je],et=function(e){return Qe.includes(e)};function tt(e,t){et(e)||W(e,"MediaType",t)}var it=[Le,Ge,Je,We],nt=function(e){return it.includes(e)};function rt(e,t){nt(e)||W(e,"TranscodingType",t)}var at=[Ue,He],ot=function(e){return X(e)&&at.includes(e)},st=[Be,Ge,Je],ut=function(e){return X(e)&&st.includes(e)},ct=[].concat(st,[Le,Ye]),lt=function(e){return ct.includes(e)};function ht(e,t){lt(e)||W(e,"LoadType",t)}var ft=[Le,Ge,Je,We],dt=function(e){return ft.includes(e)},pt=[Be,Je,We],vt=function(e){return pt.includes(e)},mt=[Le,Ge,We],yt=function(e){return mt.includes(e)};function gt(e,t){yt(e)||W(e,"ContainerType",t)}var kt=[Ge,Je,We,Be],Tt=function(e){return kt.includes(e)};function bt(e,t){Tt(e)||W(e,"ContentType",t)}var wt,Ft,St,It,Ct=[Ge,Je,We,Be],Pt=function(e){return Ct.includes(e)};function xt(e,t){Pt(e)||W(e,"EditType",t)}e.DroppingPosition=void 0,(It=e.DroppingPosition||(e.DroppingPosition={})).At="at",It.After="after",It.Before="before",It.None="none",e.ActionType=void 0,(St=e.ActionType||(e.ActionType={})).AddClipToTrack="addClipToTrack",St.AddTrack="addTrack",St.Change="change",St.ChangeFrame="changeFrame",St.ChangeMultiple="changeMultiple",St.Move="move",St.MoveClip="moveClip",St.RemoveClip="removeClip",e.AVType=void 0,(Ft=e.AVType||(e.AVType={})).Audio="audio",Ft.Both="both",Ft.Video="video",e.SelectType=void 0,(wt=e.SelectType||(e.SelectType={})).Clip="clip",wt.Container="container",wt.Content="content",wt.Mash="mash",wt.None="none",wt.Track="track";var At=Object.values(e.SelectType),Mt=function(e){return At.includes(e)};function Dt(e,t){Mt(e)||W(e,"SelectType",t)}var zt,Et=[e.SelectType.Content,e.SelectType.Container],Vt=function(e){return Mt(e)&&Et.includes(e)};e.OutputFormat=void 0,(zt=e.OutputFormat||(e.OutputFormat={})).AudioConcat="wav",zt.Flv="flv",zt.Hls="hls",zt.Jpeg="jpeg",zt.Mdash="mdash",zt.Mp3="mp3",zt.Mp4="mp4",zt.Png="image2",zt.Rtmp="rtmp",zt.VideoConcat="yuv4mpegpipe";var Rt,Ot=[Be,Ge,Je,Le];e.FillType=void 0,(Rt=e.FillType||(e.FillType={})).Color="color",Rt.Fill="fill";var _t,jt=Object.values(e.FillType),Nt=function(e){return jt.includes(e)};e.GraphFileType=void 0,(_t=e.GraphFileType||(e.GraphFileType={})).Svg="svg",_t.SvgSequence="svgsequence",_t.Txt="txt";var qt,Bt=Object.values(e.GraphFileType),Ut=function(e){return ke(e)&&Bt.includes(e)};e.DataType=void 0,(qt=e.DataType||(e.DataType={})).Boolean="boolean",qt.ContainerId="containerid",qt.ContentId="contentid",qt.DefinitionId="definitionid",qt.FontId="fontid",qt.Frame="frame",qt.Icon="icon",qt.Number="number",qt.Percent="percent",qt.Rgb="rgb",qt.String="string",qt.Option="option";var Lt,Gt=Object.values(e.DataType),Ht=function(e){return Gt.includes(e)};function Wt(e,t){Ht(e)||W(e,"DataType",t)}e.Orientation=void 0,(Lt=e.Orientation||(e.Orientation={})).H="H",Lt.V="V";var Jt,Kt=Object.values(e.Orientation),Xt=function(e){return ke(e)&&Kt.includes(e)};e.Direction=void 0,(Jt=e.Direction||(e.Direction={})).E="E",Jt.N="N",Jt.S="S",Jt.W="W";var Yt,Zt=Object.values(e.Direction),$t=function(e){return Zt.includes(e)};function Qt(e,t){$t(e)||W(e,"Direction",t)}e.Anchor=void 0,(Yt=e.Anchor||(e.Anchor={})).E="E",Yt.N="N",Yt.NE="NE",Yt.NW="NW",Yt.S="S",Yt.SE="SE",Yt.SW="SW",Yt.W="W";var ei,ti=Object.values(e.Anchor);e.TriggerType=void 0,(ei=e.TriggerType||(e.TriggerType={})).Init="init",ei.Stop="stop",ei.Start="start";var ii,ni,ri=Object.values(e.TriggerType),ai=function(e){return ri.includes(e)};e.TransformType=void 0,(ni=e.TransformType||(e.TransformType={})).Scale="scale",ni.Translate="translate",e.EventType=void 0,(ii=e.EventType||(e.EventType={})).Action="action",ii.Active="active",ii.Added="added",ii.Cast="cast",ii.Draw="draw",ii.Duration="durationchange",ii.Ended="ended",ii.Frame="frame",ii.Fps="ratechange",ii.Loaded="loadeddata",ii.Pause="pause",ii.Play="play",ii.Playing="playing",ii.Render="render",ii.Resize="resize",ii.Save="save",ii.Seeked="seeked",ii.Seeking="seeking",ii.Selection="selection",ii.Time="timeupdate",ii.Track="track",ii.Volume="volumechange",ii.Waiting="waiting";var oi,si,ui,ci=Object.values(e.EventType),li=function(e){return ci.includes(e)};e.MoveType=void 0,(ui=e.MoveType||(e.MoveType={})).Audio="audio",ui.Effect="effect",ui.Video="video",e.MasherAction=void 0,(si=e.MasherAction||(e.MasherAction={})).Redo="redo",si.Remove="remove",si.Render="render",si.Save="save",si.Undo="undo",e.ServerType=void 0,(oi=e.ServerType||(e.ServerType={})).Api="api",oi.Data="data",oi.File="file",oi.Rendering="rendering",oi.Web="web";var hi,fi,di=Object.values(e.ServerType);e.Duration=void 0,(fi=e.Duration||(e.Duration={}))[fi.Unknown=-1]="Unknown",fi[fi.Unlimited=-2]="Unlimited",fi[fi.None=0]="None",e.Timing=void 0,(hi=e.Timing||(e.Timing={})).Custom="custom",hi.Content="content",hi.Container="container";var pi,vi=Object.values(e.Timing);e.Sizing=void 0,(pi=e.Sizing||(e.Sizing={})).Preview="preview",pi.Content="content",pi.Container="container";var mi,yi=Object.values(e.Sizing);e.Clicking=void 0,(mi=e.Clicking||(e.Clicking={})).Show="show",mi.Hide="hide",mi.Play="play";var gi,ki=Object.values(e.Clicking),Ti="5.1.2",bi={servers:"",callbacks:""},wi=m(m({},{start:"",status:""}),{},{upload:""}),Fi={delete:"",get:"",put:"",retrieve:""},Si={cast:m(m({},Fi),{},{default:""}),mash:m(m({},Fi),{},{default:""}),stream:m({},Fi),definition:m({},Fi)},Ii={store:""},Ci=(v(M={},e.ServerType.Api,bi),v(M,e.ServerType.Data,Si),v(M,e.ServerType.File,Ii),v(M,e.ServerType.Rendering,wi),M);Object.entries(Ci).forEach((function(e){var t=p(e,2),i=t[0],n=t[1];J(n)&&Object.entries(n).forEach((function(e){var t=p(e,2),r=t[0],a=t[1];X(a)?n[r]="/".concat(i,"/").concat(r):Object.entries(a).forEach((function(e){var t=p(e,2),n=t[0];t[1]||(a[n]="/".concat(i,"/").concat(r,"/").concat(n))}))}))})),e.Component=void 0,(gi=e.Component||(e.Component={})).Browser="browser",gi.Player="player",gi.Inspector="inspector",gi.Timeline="timeline";var Pi=function(e){return J(e)},xi=function(e){return J(e)&&"id"in e&&ke(e.id)};function Ai(e,t){xi(e)||W(e,"Identified",t)}var Mi="acending",Di="decending",zi="jpg",Ei="json",Vi="txt",Ri="css",Oi="mp4",_i="png",ji="text/css",Ni=function(){},qi="http://www.w3.org/2000/svg",Bi="http://www.w3.org/1999/xhtml",Ui="http://www.w3.org/1999/xlink",Li="com.moviemasher.",Gi=".default",Hi="disabled",Wi="item",Ji="button",Ki="collapsed",Xi="selected",Yi="dropping",Zi="dropping-before",$i="dropping-after",Qi=function(e){return e[e.length-1]},en=function(e,t){return e.splice.apply(e,[0,e.length].concat(d(t))),e},tn=function(e){return d(e).reverse()},nn=function(e){return d(new Set(e))},rn="",an=function(){return sn()?rn:W(V.Url)},on=function(e){if(ke(e))return rn=e;var t=globalThis.document;return rn=(null===t||void 0===t?void 0:t.baseURI)||"http://localhost/"},sn=function(){return Boolean(rn)},un=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new URL(an()),i=t.protocol,n=t.hostname,r=t.port,a=t.pathname,o={protocol:i,hostname:n,pathname:pn(a,e.pathname)};return Ie(r)&&(o.port=Number(r)),o},cn=function(e){return e.startsWith("object:/")},ln=function(e){return e.startsWith("http")},hn=function(e){return Boolean(null===e||void 0===e?void 0:e.startsWith("blob"))},fn=function(e){return e.includes(":")},dn=function(e,t){return(e.endsWith("/")?e.slice(0,-1):e)+"/"+(t.startsWith("/")?t.slice(1):t)},pn=function(e,t){if(!t)return e;var i=p(t,2),n=i[0],r=i[1];if("/"===n)return t;if("."!==n||"/"===r)return dn(e,t);var a=(e.endsWith("/")?e.slice(0,-1):e).split("/");return t.split("/").forEach((function(e){".."===e?a.pop():a.push(e)})),a.join("/")},vn=function(e){var t=un(e),i=t.port,n=t.pathname,r=t.hostname,a=t.protocol,o=t.search;Te(r),Te(a);var s=[];s.push(a,"//",r),Ie(i)&&s.push(":",String(i));var u=s.join("");if(!n)return u;var c=dn(u,n);return o?[c,o].join(""):c},mn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t&&fn(t))return t;var i=vn(e),n=i.endsWith("/")?i:i+"/";return fn(n)?new URL(t,n).href:n+t},yn=function(e){var t=e.indexOf(":");return pe(t)?e.slice(0,t+1):""},gn=function(e){if(ke(e)){var t=e.split(";").map((function(e){var t=e.split("="),i=p(t,2),n=i[0],r=i[1];return[n,Ie(r)?Number(r):r]}));return Object.fromEntries(t)}},kn=function(e){return e?Object.entries(e).map((function(e){return e.join("=")})).join(";"):""},Tn=function(e,t,i){var n=e.endsWith(":")?e:"".concat(e,":");return t.startsWith(n)&&!i?t:"".concat(n).concat(kn(i),"/").concat(t)},bn=function(e){return"."===e[0]?e.slice(1):e},wn=function(e,t){return"".concat(e,".").concat(bn(t))},Fn=function(e){var t=/url\(([^)]+)\)(?!.*\1)/g,i=e.matchAll(t),n=d(i);return Qi(Qi(n))},Sn=function(e){return J(e)};function In(e,t){Sn(e)||W(e,"Endpoint",t)}var Cn=function(e){var t=Mn(e),i=t.protocol,n=t.hostname,r=t.pathname,a=t.port,o=t.search,s=[i];return hn(i)||s.push("//"),s.push(n),Ie(a)&&s.push(":".concat(a)),r&&s.push(r),o&&s.push(o),s.join("")},Pn=function(e){var t=new URL(e),i=t.protocol,n=t.hostname,r=t.pathname,a=t.port,o={protocol:i,hostname:n,pathname:r,search:t.search};return Ie(a)&&(o.port=Number(a)),o},xn=function(e){if(fn(e))return Pn(e);var t=e.split("?"),i=p(t,2),n=i[0],r=i[1],a={pathname:n};return r&&(a.search="?".concat(r)),a},An=function(e){var t=e.hostname,i=e.protocol;return hn(i)||ke(t)},Mn=function(e){return An(e)?e:un(e)},Dn=function(e){return J(e)&&("endpoint"in e&&Sn(e.endpoint)||"response"in e&&J(e.response))};function zn(e,t){Dn(e)||W(e,"Request",t)}var En=function(e){return xi(e)},Vn=function(e){return J(e)&&"request"in e&&Dn(e.request)},Rn=/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/,On=/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),(\d*(?:\.\d+)?)\)$/,_n=/^#([A-Fa-f0-9]{3,4}){1,2}$/,jn=function(e){return e.toLowerCase().replace(/[\s]/g,"")},Nn=function(){return"function"!==typeof Option?{color:""}:(console.log("colorStyle Option",Option),(new Option).style)},qn=function(e){return On.test(e)},Bn=function(e){return Rn.test(e)},Un=function(e,t){return e.match(new RegExp(".{".concat(t,"}"),"g"))},Ln=function(e){return parseInt(e.repeat(2/e.length),16)},Gn=function(e){return he(e)?Math.max(0,Math.min(1,e/255)):1},Hn=function(e){if(!fr(e))return Xn;var t=Math.floor((e.length-1)/3),i=Un(e.slice(1),t);if(!i)return Xn;var n=i.map(Ln),r=p(n,4),a=r[0],o=r[1],s=r[2],u=r[3];return{r:a,g:o,b:s,a:Gn(u)}},Wn=function(e){if(!fr(e))return Kn;var t=Math.floor((e.length-1)/3),i=Un(e.slice(1),t);if(!i)return Kn;var n=i.map(Ln),r=p(n,3);return{r:r[0],g:r[1],b:r[2]}},Jn=function(e){var t=jn(e).match(On);return t?{r:Number(t[1]),g:Number(t[2]),b:Number(t[3]),a:Number(t[4])}:Xn},Kn={r:0,g:0,b:0},Xn=m(m({},Kn),{},{a:1}),Yn="rgb".split(""),Zn=[].concat(d(Yn),["a"]),$n="#00000000",Qn="#000000",er="#FFFFFF",tr="#FFFFFF00",ir="#00000000",nr="#FFFFFFFF",rr="#000000FF",ar="#00FF00",or="#FFFF00",sr="#FF0000",ur="#0000FF",cr=function(e){var t=e.r.toString(16),i=e.g.toString(16),n=e.b.toString(16);return t.length<2&&(t="0".concat(t)),i.length<2&&(i="0".concat(i)),n.length<2&&(n="0".concat(n)),"#".concat(t).concat(i).concat(n)},lr=function(e){var t=e.r.toString(16),i=e.g.toString(16),n=e.b.toString(16),r=Math.round(255*Number(e.a)).toString(16);return t.length<2&&(t="0".concat(t)),i.length<2&&(i="0".concat(i)),n.length<2&&(n="0".concat(n)),r.length<2&&(r="0".concat(r)),"#".concat(t).concat(i).concat(n).concat(r)},hr=function(e){var t=jn(e);if(fr(t)||qn(t)||Bn(t))return!0;var i=Nn();i.color=e;var n=i.color;if(n===e)return!1;var r=jn(n);return!!r&&(!(!qn(t)&&!Bn(t))||r===t)},fr=function(e){return _n.test(e)},dr=function(e){var t=jn(e);if(fr(t))return Wn(t);var i=t.match(Rn);return i?{r:Number(i[1]),g:Number(i[2]),b:Number(i[3])}:Kn},pr=function(e){if(!hr(e))return Xn;var t=jn(e);return fr(t)?Hn(t):qn(t)?Jn(t):Bn(t)?m({a:1},dr(t)):Xn},vr=function(e){var t=e.r,i=e.g,n=e.b;return"rgb(".concat(t,",").concat(i,",").concat(n,")")},mr=function(e){var t=e.r,i=e.g,n=e.b;return m(m({},e),{},{r:255-t,g:255-i,b:255-n})};function yr(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Object.fromEntries(Zn.map((function(n){return[n,Math.round(e[n]*i+t[n]*(1-i))]})))}function gr(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Object.fromEntries(Yn.map((function(n){return[n,Math.round(e[n]*(1-i)+t[n]*i)]})))}var kr=[e.DataType.Frame,e.DataType.Percent,e.DataType.Number],Tr=function(e){return Ht(e)&&kr.includes(e)},br=function(t){return t!==e.DataType.Boolean&&!Tr(t)},wr=function(t){if(et(t))return"".concat(Li).concat(t).concat(Gi);switch(t){case e.DataType.Boolean:return!1;case e.DataType.Rgb:return Qn}return Tr(t)?0:""},Fr=function(e){return!!ee(e)||(se(e)?0===e||1===e:["true","false",""].includes(e))},Sr=function(t,i){if(et(i))return ke(t);switch(i){case e.DataType.Boolean:return Fr(t);case e.DataType.Rgb:return hr(String(t));case e.DataType.Frame:case e.DataType.Percent:case e.DataType.Number:return Ie(t);case e.DataType.String:return!0;case e.DataType.ContainerId:case e.DataType.ContentId:case e.DataType.FontId:case e.DataType.DefinitionId:default:return ke(t)}return!1},Ir=function(t,i){return i===e.DataType.Boolean?ee(t)?t:Ie(t)?!!Number(t):"true"===t:Tr(i)?Ie(t)?Number(t):0:String(t)},Cr="End",Pr=function(){function e(){h(this,e),v(this,"properties",[])}return f(e,[{key:"addProperties",value:function(e){for(var t,i=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];(t=this.properties).push.apply(t,r),r.forEach((function(t){i.propertyTweenSetOrDefault(e,t)}))}},{key:"propertiesInitialize",value:function(e){var t=this;K(e,"propertiesInitialize(object)"),this.properties.forEach((function(i){return t.propertyTweenSetOrDefault(e,i)}))}},{key:"propertyFind",value:function(e){return this.properties.find((function(t){return t.name===e}))}},{key:"propertyName",value:function(e){return e.endsWith(Cr)?e.slice(0,-Cr.length):e}},{key:"propertySetOrDefault",value:function(e,t,i,n){var r=e[i],a=Z(r)?n:r;this.setValue(a,i,t)}},{key:"propertyTweenSetOrDefault",value:function(e,t){var i=t.name,n=t.defaultValue,r=t.tweenable;this.propertySetOrDefault(e,t,i,n),r&&this.propertySetOrDefault(e,t,"".concat(i).concat(Cr))}},{key:"setValue",value:function(e,t,i){if(Z(e))delete this[t];else{var n=this.propertyName(t),r=i||this.propertyFind(n);Ce(r,"".concat(this.constructor.name,".").concat(n," in ").concat(this.properties.map((function(e){return e.name})).join(", ")));var a=r.type;if(Sr(e,a)){var o=Ir(e,a);this[t]=o}else n!==t&&delete this[t]}}},{key:"setValues",value:function(e){var t=this;Object.entries(e).forEach((function(e){var i=p(e,2),n=i[0],r=i[1];t.setValue(r,n)}))}},{key:"toJSON",value:function(){var e=this;return Object.fromEntries(this.properties.flatMap((function(t){var i=t.name,n=t.tweenable,r=[[i,e.value(i)]];if(n){var a="".concat(i).concat(Cr);r.push([a,e.value(a)])}return r})))}},{key:"value",value:function(e){return this[e]}}]),e}(),xr=function(e){return e instanceof Pr},Ar=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this),v(u(n),"createdAt",""),v(u(n),"id",void 0),v(u(n),"kind",""),v(u(n),"relativeRequest",void 0),v(u(n),"request",void 0),v(u(n),"type","");var r=e.id,a=e.type,o=e.kind,s=e.createdAt,c=e.request;return n.id=r,ke(a)&&(n.type=a),ke(s)&&(n.createdAt=s),ke(o)&&(n.kind=o),zn(c),n.request=c,n.relativeRequest=c,n}return f(i,[{key:"loadType",get:function(){var e=this.type;return console.log(this.constructor.name,"loadType",e),e===We?Ge:(ht(e),e)}},{key:"toJSON",value:function(){var e=this.id,t=this.type,i=this.kind,n=this.createdAt,r=this.relativeRequest;return r.response,{id:e,request:s(r,y),type:t,kind:i,createdAt:n}}}]),i}(Pr),Mr=function(e){return Vn(e)&&"type"in e&&et(e.type)},Dr=function(e){return J(e)&&("mediaId"in e||"definition"in e)},zr=function(e){return J(e)&&"definitionIds"in e},Er=function(e){return En(e)},Vr=function(e){return Mr(e)&&"type"in e&&et(e.type)};function Rr(e,t){Vr(e)||W(e,"Media",t)}var Or=function(e){return W(V.Unimplemented)},_r=(v(D={},Be,Or),v(D,Ue,Or),v(D,Le,Or),v(D,Ge,Or),v(D,He,Or),v(D,We,Or),v(D,Je,Or),D),jr=function(e){var t=e.type;return tt(t),_r[t](e)},Nr=(v(z={},Be,[]),v(z,Ue,[]),v(z,Le,[]),v(z,Ge,[]),v(z,He,[]),v(z,We,[]),v(z,Je,[]),z),qr={count:0},Br=function(){function e(){h(this,e),v(this,"id",0),v(this,"byId",new Map),v(this,"mediaArraysByType",new Map),qr.count++,this.id=qr.count}return f(e,[{key:"byIdAdd",value:function(e){var t=this;(Array.isArray(e)?e:[e]).forEach((function(e){return t.byId.set(e.id,e)}))}},{key:"byType",value:function(e){var t=this.mediaArraysByType.get(e);if(t)return t;var i=Nr[e];return this.mediaArraysByType.set(e,i),i}},{key:"define",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.map((function(t){return e.fromObject(t)}))}},{key:"media",value:function(e){return tt(e.type),jr(e)}},{key:"deleteFromArray",value:function(e){var t=e.type,i=e.id,n=this.byType(t),r=n.findIndex((function(e){return i===e.id}));r<0||n.splice(r,1)}},{key:"mediaTypeFromId",value:function(e){var t=e.split(".").slice(-2).shift();return et(t)?t:void 0}},{key:"fromId",value:function(e){if(this.installed(e))return this.byId.get(e);var t=this.mediaTypeFromId(e);tt(t,"in MediaCollection.fromId('".concat(e,"')"));var i=this.byType(t).find((function(t){return t.id===e}));return Rr(i,e),i}},{key:"fromObject",value:function(e){var t=e.id,i=e.type;if(Te(t),this.installed(t)||this.predefined(t))return this.fromId(t);var n=i||this.mediaTypeFromId(t);return tt(n,"type"),e.type=n,this.install(this.media(e))}},{key:"ids",get:function(){return d(this.byId.keys())}},{key:"install",value:function(e){var t=e.type,i=e.id;return this.installed(i)?(this.uninstall(e),this.updateDefinition(this.fromId(i),e)):(this.byIdAdd(e),this.byType(t).push(e),e)}},{key:"installed",value:function(e){var t,i=this.byId.has(e);return i||(t=console).trace.apply(t,[this.constructor.name,this.id,"installed FALSE",e].concat(d(this.byId.keys()))),i}},{key:"predefined",value:function(e){if(e.startsWith(Li))return!0;var t=this.mediaTypeFromId(e);return!!t&&this.byType(t).some((function(t){return t.id===e}))}},{key:"undefineAll",value:function(){this.byId=new Map,this.mediaArraysByType=new Map}},{key:"updateDefinition",value:function(e,t){return this.uninstall(e),this.install(t),t}},{key:"updateDefinitionId",value:function(e,t){var i=this.byId.get(e);Rr(i,"media"),this.byId.delete(e),this.byId.set(t,i)}},{key:"uninstall",value:function(e){this.deleteFromArray(e);var t=e.id;return this.byId.delete(t),e}}]),e}(),Ur=function(e){return J(e)&&"type"in e&&ke(e.type)};function Lr(e,t){Ur(e)||W(e,"Typed",t)}var Gr=function(e){return J(e)&&e instanceof HTMLVideoElement};function Hr(e,t){Gr(e)||W(e,"ClientVideo",t)}var Wr=function(e){return J(e)&&e instanceof HTMLImageElement};function Jr(e,t){Wr(e)||W(e,"ClientImage",t)}var Kr=function(e){return J(e)&&e instanceof AudioBuffer};function Xr(e,t){Kr(e)||W(e,"ClientAudio",t)}var Yr=function(e){return J(e)&&"family"in e};function Zr(e,t){Yr(e)||W(e,"ClientFont",t)}var $r=function(e){return lt(e)||Ut(e)};function Qr(e,t){$r(e)||W(e,"LoaderType",t)}var ea=function(e){return Kr(e)||Yr(e)||Wr(e)||Gr(e)||je(e)};function ta(e,t){ea(e)||W(e,"ClientMedia",t)}var ia,na=function(e){return Wr(e)||Gr(e)||Kr(e)},ra=44100,aa=2,oa=function(){function e(){h(this,e),v(this,"_context",void 0),v(this,"sourcesById",new Map)}return f(e,[{key:"addSource",value:function(e,t){this.sourcesById.set(e,t)}},{key:"context",get:function(){if(!this._context){var e=AudioContext||window.webkitAudioContext;ne(e),this._context=new e}return this._context}},{key:"createBuffer",value:function(e){var t=ra*e;return this.context.createBuffer(aa,t,ra)}},{key:"createBufferSource",value:function(e){var t=this.context.createBufferSource();return e&&(t.buffer=e),t}},{key:"createGain",value:function(){return this.context.createGain()}},{key:"currentTime",get:function(){return this.context.currentTime}},{key:"decode",value:function(e){var t=this;return new Promise((function(i,n){return t.context.decodeAudioData(e,(function(e){return i(e)}),(function(e){return n(e)}))}))}},{key:"deleteSource",value:function(e){var t=this.getSource(e);if(t){this.sourcesById.delete(e);var i=t.gainSource,n=t.gainNode;n.disconnect(this.destination),i.disconnect(n),i.stop()}}},{key:"destination",get:function(){return this.context.destination}},{key:"getSource",value:function(e){return this.sourcesById.get(e)}},{key:"hasSource",value:function(e){return this.sourcesById.has(e)}},{key:"startAt",value:function(e,t,i,n,r){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.createGain();t.loop=a,t.connect(o),o.connect(this.destination),t.start(this.currentTime+i,r,n),this.addSource(e,{gainSource:t,gainNode:o})}}]),e}(),sa=new oa,ua={audible:function(){return new oa}};e.Frame=void 0,(ia=e.Frame||(e.Frame={}))[ia.First=0]="First",ia[ia.Last=-1]="Last";var ca=function(e){return J(e)&&"media"in e&&me(e.media)},la=function(e){return J(e)&&"composition"in e};function ha(e,t){la(e)||W(e,"MashMedia",t)}var fa=function(){function e(t){h(this,e),v(this,"done",!1),v(this,"redoSelection",void 0),v(this,"type",void 0),v(this,"undoSelection",void 0);var i=t.redoSelection,n=t.type,r=t.undoSelection;this.redoSelection=i,this.type=n,this.undoSelection=r}return f(e,[{key:"mash",get:function(){var e=this.redoSelection.mash;if(la(e))return e;var t=this.undoSelection.mash;return ha(t),t}},{key:"redo",value:function(){this.redoAction(),this.done=!0}},{key:"redoAction",value:function(){return W(V.Unimplemented)}},{key:"selection",get:function(){return this.done?this.redoSelection:this.undoSelection}},{key:"undo",value:function(){this.undoAction(),this.done=!1}},{key:"undoAction",value:function(){return W(V.Unimplemented)}}]),e}(),da=function(e){return e instanceof fa};function pa(e){if(!da(e))throw new Error("expected Action")}var va=function(e){return da(e.action)},ma=function(e){return e instanceof CustomEvent&&e.detail},ya=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this,e),v(u(n),"createTracks",void 0);var r=e.createTracks;return n.createTracks=r,n}return f(i,[{key:"redoAction",value:function(){for(var e=0;e<this.createTracks;e+=1)this.mash.addTrack()}},{key:"undoAction",value:function(){for(var e=0;e<this.createTracks;e+=1)this.mash.removeTrack()}}]),i}(fa),ga=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this,e),v(u(n),"clips",void 0),v(u(n),"insertIndex",void 0),v(u(n),"trackIndex",void 0),v(u(n),"redoFrame",void 0),v(u(n),"undoFrame",void 0);var r=e.clips,a=e.insertIndex,o=e.trackIndex,s=e.redoFrame,c=e.undoFrame;return n.clips=r,n.insertIndex=a,n.trackIndex=o,n.redoFrame=s,n.undoFrame=c,n}return f(i,[{key:"track",get:function(){return this.mash.tracks[this.trackIndex]}},{key:"redoAction",value:function(){a(o(i.prototype),"redoAction",this).call(this);var e=this.mash,t=this.redoFrame,n=this.trackIndex,r=this.insertIndex,s=this.clips;e.addClipToTrack(s,n,r,t)}},{key:"undoAction",value:function(){var e=this.mash,t=this.clips;e.removeClipFromTrack(t),a(o(i.prototype),"undoAction",this).call(this)}}]),i}(ya),ka=function(e){return J(e)&&"target"in e&&"property"in e},Ta=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this,e),v(u(n),"property",void 0),v(u(n),"redoValue",void 0),v(u(n),"target",void 0),v(u(n),"undoValue",void 0);var r=e.property,a=e.redoValue,o=e.target,s=e.undoValue;return n.property=r,n.redoValue=a,n.target=o,n.undoValue=s,n}return f(i,[{key:"redoValueNumeric",get:function(){return Number(this.redoValue)}},{key:"undoValueNumeric",get:function(){return Number(this.undoValue)}},{key:"redoAction",value:function(){this.target.setValue(this.redoValue,this.property)}},{key:"undoAction",value:function(){this.target.setValue(this.undoValue,this.property)}},{key:"updateAction",value:function(e){var t=e.redoValue;this.redoValue=t,this.redo()}}]),i}(fa),ba=function(e){return e instanceof Ta};function wa(e){if(!ba(e))throw new Error("expected ChangeAction")}var Fa=function(e){c(i,e);var t=l(i);function i(e){return h(this,i),t.call(this,e)}return f(i,[{key:"redoAction",value:function(){this.mash.changeTiming(this.target,this.property,this.redoValueNumeric)}},{key:"undoAction",value:function(){this.mash.changeTiming(this.target,this.property,this.undoValueNumeric)}}]),i}(Ta),Sa=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this,e),v(u(n),"clip",void 0),v(u(n),"insertIndex",void 0),v(u(n),"trackIndex",void 0),v(u(n),"undoTrackIndex",void 0),v(u(n),"undoInsertIndex",void 0),v(u(n),"undoFrame",void 0),v(u(n),"redoFrame",void 0);var r=e.clip,a=e.insertIndex,o=e.redoFrame,s=e.trackIndex,c=e.undoFrame,l=e.undoInsertIndex,f=e.undoTrackIndex;return n.clip=r,n.insertIndex=a,n.redoFrame=o,n.trackIndex=s,n.undoFrame=c,n.undoInsertIndex=l,n.undoTrackIndex=f,n}return f(i,[{key:"addClip",value:function(e,t,i){this.mash.addClipToTrack(this.clip,e,t,i)}},{key:"redoAction",value:function(){a(o(i.prototype),"redoAction",this).call(this),this.addClip(this.trackIndex,this.insertIndex,this.redoFrame)}},{key:"undoAction",value:function(){this.addClip(this.undoTrackIndex,this.undoInsertIndex,this.undoFrame),a(o(i.prototype),"undoAction",this).call(this)}}]),i}(ya),Ia=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this,e),v(u(n),"track",void 0),v(u(n),"clip",void 0),v(u(n),"index",void 0);var r=e.clip,a=e.index,o=e.track;return n.clip=r,n.index=a,n.track=o,n}return f(i,[{key:"trackIndex",get:function(){return this.track.index}},{key:"redoAction",value:function(){this.mash.removeClipFromTrack(this.clip)}},{key:"undoAction",value:function(){this.mash.addClipToTrack(this.clip,this.trackIndex,this.index)}}]),i}(fa),Ca=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i);var r=e.redoValues,a=e.undoValues;return n=t.call(this,e),v(u(n),"redoValues",void 0),v(u(n),"undoValues",void 0),n.undoValues=a,n.redoValues=r,n}return f(i,[{key:"redoAction",value:function(){var e=this.target,t=this.redoValues;Object.entries(t).forEach((function(t){var i=p(t,2),n=i[0],r=i[1];e.setValue(r,n)}))}},{key:"undoAction",value:function(){var e=this.target,t=this.undoValues;Object.entries(t).forEach((function(t){var i=p(t,2),n=i[0],r=i[1];e.setValue(r,n)}))}},{key:"updateAction",value:function(e){var t=e.redoValues;this.redoValues=t,this.redo()}}]),i}(Ta),Pa=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this,e),v(u(n),"objects",void 0),v(u(n),"redoObjects",void 0),v(u(n),"undoObjects",void 0);var r=e.objects,a=e.redoObjects,o=e.undoObjects;return n.objects=r,n.redoObjects=a,n.undoObjects=o,n}return f(i,[{key:"redoAction",value:function(){var e;(e=this.objects).splice.apply(e,[0,this.objects.length].concat(d(this.redoObjects)))}},{key:"undoAction",value:function(){var e;(e=this.objects).splice.apply(e,[0,this.objects.length].concat(d(this.undoObjects)))}}]),i}(fa),xa=function(e){return e instanceof Pa};function Aa(e,t){xa(e)||W(e,"MoveAction",t)}var Ma=function(t){switch(t.type){case e.ActionType.AddClipToTrack:return new ga(t);case e.ActionType.AddTrack:return new ya(t);case e.ActionType.Change:return new Ta(t);case e.ActionType.ChangeFrame:return new Fa(t);case e.ActionType.ChangeMultiple:return new Ca(t);case e.ActionType.MoveClip:return new Sa(t);case e.ActionType.Move:return new Pa(t);case e.ActionType.RemoveClip:return new Ia(t)}},Da={createFromObject:Ma},za=function(){function t(e){h(this,t),v(this,"editor",void 0),v(this,"index",-1),v(this,"instances",[]),this.editor=e}return f(t,[{key:"add",value:function(e){var t=this.instances.length-(this.index+1);he(t)&&this.instances.splice(this.index+1,t),this.instances.push(e)}},{key:"canRedo",get:function(){return this.index<this.instances.length-1}},{key:"canSave",get:function(){return this.canUndo}},{key:"canUndo",get:function(){return this.index>-1}},{key:"create",value:function(t){var i=this.editor,n=t.undoSelection,r=t.redoSelection,a=t.type,o=void 0===a?e.ActionType.Change:a,u=s(t,g),c=m(m({},u),{},{type:o,undoSelection:n||m({},i.selection.object),redoSelection:r||m({},i.selection.object)});if(ka(t)&&this.currentActionLast){var l=this.currentAction;if(ba(l)){var h=t.target,f=t.property;if(l.target===h&&l.property===f)return l.updateAction(t),void i.handleAction(l)}}var d=Ma(c);this.add(d),i.handleAction(this.redo())}},{key:"currentAction",get:function(){return this.instances[this.index]}},{key:"currentActionLast",get:function(){return this.canUndo&&!this.canRedo}},{key:"destroy",value:function(){this.index=-1,this.instances.splice(0,this.instances.length)}},{key:"redo",value:function(){this.index+=1;var e=this.currentAction;return pa(e),e.redo(),e}},{key:"reusableChangeAction",value:function(e,t){if(this.currentActionLast){var i=this.currentAction;return ba(i)&&i.target===e&&i.property===t?i:void 0}}},{key:"save",value:function(){this.instances.splice(0,this.index+1),this.index=-1}},{key:"selection",get:function(){return this.editor.selection}},{key:"undo",value:function(){var e=this.currentAction;return pa(e),this.index-=1,e.undo(),e}}]),t}(),Ea=function(e){return J(e)&&"width"in e&&"height"in e&&se(e.width)&&se(e.height)};function Va(e,t){Ea(e)||W(e,"Size",t)}var Ra=function(e,t){return!!Ea(t)&&e.width===t.width&&e.height===t.height},Oa={width:0,height:0},_a=function(e){return 2*Math.max(1,Math.ceil(e/2))},ja=function(e){var t=e.width,i=e.height;return{width:_a(t),height:_a(i)}},Na=function(e){var t=e.width,i=e.height;return{width:Math.round(t),height:Math.round(i)}},qa=function(e){var t=e.width,i=e.height;return{width:Math.max(2,Math.ceil(t)),height:Math.max(2,Math.ceil(i))}},Ba=function(e){var t=e.width,i=e.height;return{width:Math.max(2,Math.floor(t)),height:Math.max(2,Math.floor(i))}},Ua=function(e,t,i){return{width:e.width*t,height:e.height*i}},La=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Ha(e,"sizeCover.inSize"),Va(t,"sizeCover.outSize");var n=e.width,r=e.height,a=t.width/n,o=t.height/r;return qa(m(m({},t),{},(i?a<o:a>o)?{height:r*a}:{width:n*o}))},Ga=function(e){if(!Ea(e))return!1;var t=e.width,i=e.height;return pe(t)&&pe(i)};function Ha(e,t){Ga(e)||W(e,"SizeAboveZero",t)}var Wa={width:1920,height:1080},Ja=Ua(Wa,.25,.25),Ka=Ua(Ja,.5,.5),Xa=function(e){var t=e.width,i=void 0===t?0:t,n=e.height;return{width:i,height:void 0===n?0:n}},Ya=function(t,i){var n=Xa(t);switch(i){case e.Orientation.H:n.width=n.height;break;case e.Orientation.V:n.height=n.width}return n},Za=function(e){var t=e.width,i=e.height;return"width=".concat(t,";height=").concat(i)},$a=function(t,i){Ha(t,"sizeLockNegative");var n=Xa(t);return i&&(i===e.Orientation.V?n.height=-1:n.width=-1),n},Qa=function(e){var t={width:Number(e.getAttribute("width")),height:Number(e.getAttribute("height"))};return Ha(t,"sizeFromElement"),t},eo=function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),v(u(e),"queue",new Map),v(u(e),"trapped",new Map),e}return f(i,[{key:"dispatch",value:function(e,t){this.dispatchEvent(this.event(e,t))}},{key:"emit",value:function(e,t){if(this.trapped.has(e)){var i=this.trapped.get(e);i&&i(this.event(e,t))}else this.dispatch(e,t)}},{key:"enqueue",value:function(e){}},{key:"event",value:function(e,t){return new CustomEvent(e,t?{detail:t}:void 0)}},{key:"trap",value:function(e,t){this.trapped.has(e)||this.trapped.set(e,t||null)}}]),i}(r(EventTarget)),to=function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:""){case"ceil":return Math.ceil;case"floor":return Math.floor;default:return Math.round}},io=function(e){return to(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"")(e)},no=function(e,t){for(var i=e,n=t,r=0;0!==n;)r=n,n=i%n,i=r;return i},ro=function(e,t){return e*t/no(e,t)},ao=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(e.fps===t.fps)return[e,t];var n=ro(e.fps,t.fps);return[e.scale(n,i),t.scale(n,i)]},oo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;h(this,e),v(this,"fps",void 0),v(this,"frame",void 0),v(this,"isRange",!1),fe(t),ce(t),ve(i),this.frame=t,this.fps=i}return f(e,[{key:"add",value:function(t){var i=ao(this,t),n=p(i,2),r=n[0],a=n[1];return new e(r.frame+a.frame,r.fps)}},{key:"addFrame",value:function(e){var t=this.copy;return t.frame+=e,t}},{key:"closest",value:function(t){var i=new e(t.frame+Math.round(t.frames/2),t.fps),n=ao(i,this),r=p(n,2),a=r[0],o=r[1];return a.frame<o.frame?t.lastTime:t.startTime}},{key:"copy",get:function(){return new e(this.frame,this.fps)}},{key:"description",get:function(){return"".concat(this.frame,"@").concat(this.fps)}},{key:"divide",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return ve(e),1===e?this:this.withFrame(io(this.frame/e,t))}},{key:"equalsTime",value:function(e){var t=ao(this,e),i=p(t,2),n=i[0],r=i[1];return n.frame===r.frame}},{key:"durationFrames",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)||this.fps,i=[],n=Math.floor(t*e)-2,r=Math.min(n,this.scale(t,"floor").frame);if(this.isRange)for(var a=this.timeRange.endTime.scale(t,"ceil").frame,o=Math.min(n+1,a),s=r;s<o;s+=1)i.push(s);else i.push(r);return i}},{key:"lengthSeconds",get:function(){return 0}},{key:"min",value:function(t){var i=ao(this,t),n=p(i,2),r=n[0],a=n[1];return new e(Math.min(r.frame,a.frame),r.fps)}},{key:"scale",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this.fps===t)return this;var n=Number(this.frame)/Number(this.fps)*Number(t);return new e(io(n,i),t)}},{key:"scaleToFps",value:function(t){return this.scaleToTime(new e(0,t))}},{key:"scaleToTime",value:function(e){return ao(this,e)[0]}},{key:"seconds",get:function(){return Number(this.frame)/Number(this.fps)}},{key:"startTime",get:function(){return this}},{key:"subtract",value:function(t){var i=ao(this,t),n=p(i,2),r=n[0],a=n[1].frame;return a>r.frame&&(a-=a-r.frame),new e(r.frame-a,r.fps)}},{key:"subtractFrames",value:function(e){var t=this.copy;return t.frame-=e,t}},{key:"timeRange",get:function(){return W(V.Internal)}},{key:"toString",value:function(){return"[".concat(this.description,"]")}},{key:"withFrame",value:function(e){var t=this.copy;return t.frame=e,t}}]),e}(),so=function(e){c(i,e);var t=l(i);function i(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return h(this,i),e=t.call(this,n,r),v(u(e),"frames",void 0),v(u(e),"isRange",!0),fe(a),ce(a),e.frames=a,e}return f(i,[{key:"addFrames",value:function(e){var t=this.copy;return t.frames+=e,t}},{key:"copy",get:function(){return new i(this.frame,this.fps,this.frames)}},{key:"description",get:function(){return"".concat(this.frame,"-").concat(this.frames,"@").concat(this.fps)}},{key:"end",get:function(){return this.frame+this.frames}},{key:"endTime",get:function(){return new oo(this.end,this.fps)}},{key:"equalsTimeRange",value:function(e){var t=ao(this,e),i=p(t,2),n=i[0],r=i[1];return n.frame===r.frame&&n.frames===r.frames}},{key:"frameTimes",get:function(){var e=this.frames,t=this.frame,i=this.fps;return Array.from({length:e},(function(e,n){return new oo(t,i)}))}},{key:"includes",value:function(e){return e>=this.frame&&e<=this.end}},{key:"includesTime",value:function(e){var t=ao(this,e),i=p(t,2),n=i[0],r=i[1],a=n,o=a.frame,s=a.end,u=r.frame;return u>=o&&u<s}},{key:"intersection",value:function(e){var t=e.isRange?e.timeRange:new i(e.frame,e.fps),n=ao(t,this),r=p(n,2),a=r[0],o=r[1],s=a.frame,u=a.end,c=a.fps,l=o.frame,h=o.end,f=Math.max(s,l);return new i(f,c,Math.min(u,h)-f)}},{key:"intersects",value:function(e){if(!e.isRange)return this.includesTime(e);var t=ao(e,this),i=p(t,2),n=i[0],r=i[1];return!(n.frame>=r.end)&&n.end>r.frame}},{key:"last",get:function(){return this.frame+this.frames-1}},{key:"lastTime",get:function(){return new oo(this.last,this.fps)}},{key:"lengthSeconds",get:function(){return Number(this.frames)/Number(this.fps)}},{key:"position",get:function(){return Number(this.frame)/Number(this.frames)}},{key:"positionTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=io((this.frames-this.frame)*e,t);return new oo(this.frame+i,this.fps)}},{key:"startTime",get:function(){return new oo(this.frame,this.fps)}},{key:"scale",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this.fps===e)return this.copy;var n=Number(this.frames)/(Number(this.fps)/Number(e)),r=a(o(i.prototype),"scale",this).call(this,e,t),s=Math.max(1,io(n,t));return new i(r.frame,r.fps,s)}},{key:"timeRange",get:function(){return this}},{key:"times",get:function(){var e=[this.startTime];return this.frames>1&&e.push(this.endTime),e}},{key:"minEndTime",value:function(e){var t=ao(this,e),i=p(t,2),n=i[0],r=i[1];return n.frames=Math.min(n.frames,r.frame),n}},{key:"withFrame",value:function(e){var t=this.copy;return t.frame=e,t}},{key:"withFrames",value:function(e){var t=this.copy;return t.frames=e,t}}]),i}(oo),uo=function(){return new so(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2&&void 0!==arguments[2]?arguments[2]:1)},co=function(){return uo(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)},lo=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return uo(e.frame,e.fps,t)},ho=function(e,t){if(!t)return lo(e);var i=ao(e,t),n=p(i,2),r=n[0],a=n[1];if(a.frame<=r.frame)return W(V.Frame);var o=a.frame-r.frame;return uo(r.frame,r.fps,o)},fo=function(){return new oo(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)},po=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";fe(e),ce(t),ve(t);var n=io(e*t,i);return fo(n,t)},vo=function(e){return zr(e)&&Vr(e.definition)};function mo(e){if(!vo(e))throw new Error("expected Tweenable")}var yo=function(e){return Vr(e)};function go(e){if(!yo(e))throw new Error("expected TweenableDefinition")}var ko=function(e){return vo(e)&&e.type===Ue};function To(e){if(!ko(e))throw new Error("expected Effect")}var bo=function(e){return Vr(e)&&e.type===Ue},wo=function(e){return J(e)&&"frameForClipNearFrame"in e};function Fo(e,t){wo(e)||W(e,"Track",t)}var So={label:"Mash",quantize:10,color:Qn,gain:.75,buffer:10},Io={duration:3,label:"Unlabeled",editor:{buffer:10,fps:30,loop:!0,volume:.75,precision:3,autoplay:!1},video:So,effect:{label:"Effect"},audio:{label:"Audio"},image:{label:"Image"},audiostream:{label:"Audio Stream"},sequence:{label:"Sequence"},videostream:{label:"Cast",quantize:10,color:Qn,gain:.75,buffer:10},mash:So,font:{label:"Text",string:"Example Text"},definition:{image:{duration:2},textcontainer:{duration:3},shape:{duration:3},visible:{duration:3},video:{fps:0},videosequence:{pattern:"%.jpg",fps:10,increment:1,begin:1,padding:0},videostream:{duration:10}}},Co=function(e){return J(e)},Po=function(e){return J(e)&&"contentId"in e};function xo(e,t){Po(e)||W(e,"Clip",t)}t=e.SelectType.None,I=e.SelectType.Clip,C=e.SelectType.Mash,P=e.SelectType.Track,x=e.SelectType.Container,A=e.SelectType.Content;var Ao,Mo=function(){function i(){h(this,i),v(this,"_editor",void 0),v(this,"_focus",e.SelectType.Mash),v(this,"_object",{})}return f(i,[{key:t,get:function(){}},{key:I,get:function(){var e=this._object.clip;if(Po(e))return e}},{key:C,get:function(){var e=this._object.mash;if(la(e))return e}},{key:P,get:function(){var e=this._object,t=e.clip,i=e.track;return wo(i)?i:Po(t)?t.track:void 0}},{key:x,get:function(){var e=this._object.clip;if(Po(e))return e.container}},{key:A,get:function(){var e=this._object.clip;if(Po(e))return e.content}},{key:"editor",get:function(){return this._editor}},{key:"editor",set:function(e){this._editor=e}},{key:"focus",get:function(){return this._focus}},{key:"focus",set:function(e){this._focus=e}},{key:"get",value:function(e){return this[e]}},{key:"unset",value:function(e){var t=this.object[e];if(t){var i=t.selectables();Ce(i[0]===t),i.shift(),this.object=this.selectionFromSelectables(i)}}},{key:"set",value:function(e){var t=e.selectType;this.object=v({},t,e)}},{key:"object",get:function(){var e=this;return Object.fromEntries(At.map((function(t){return[t,e.get(t)]})))}},{key:"object",set:function(t){var i=this.selectionPopulated(t),n=this.object;this.clear(),Object.assign(this._object,i);var r=this.object,a=n.mash,o=n.clip,s=r.mash,u=r.clip;u!==o&&(Po(u)&&he(u.trackNumber)&&u.track.mash.clearPreview(),Po(o)&&he(o.trackNumber)&&o.track.mash.clearPreview()),Object.assign(this._object,i),this.editor.eventTarget.emit(e.EventType.Selection),s!==a&&(this.editor.eventTarget.emit(e.EventType.Loaded),this.editor.eventTarget.emit(e.EventType.Track),this.editor.eventTarget.emit(e.EventType.Duration))}},{key:"clear",value:function(){var e=this;At.forEach((function(t){delete e._object[t]}))}},{key:"selectionFromSelectables",value:function(e){return Object.fromEntries(e.map((function(e){return[e.selectType,e]})))}},{key:"selectionPopulated",value:function(e){var t=this.mash,i=(this.object,e.clip),n=e.track,r=e.mash,a=i||n||r||t;return Ce(a,"target"),this.selectionFromSelectables(a.selectables())}},{key:"selectTypes",get:function(){var t=[],i=this.mash,n=this.object,r=n.clip,a=n.track;return i?(t.push(e.SelectType.Mash),a?(t.push(e.SelectType.Track),Po(r)?(t.push(e.SelectType.Clip),t.push(e.SelectType.Content),ke(r.containerId)&&t.push(e.SelectType.Container),t):t):t):t}},{key:"selectedItems",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At,i=this.selectTypes,n=this.object,r=i.filter((function(e){return t.includes(e)})),a=n.clip;return r.flatMap((function(t){var i=n[t];return Vt(t)&&Po(a)&&(i=a[t]),Ce(i,t),i.selectedItems(e.editor.actions)}))}}]),i}(),Do=function(){return new Mo},zo=function(e,t){return e.frame-t.frame},Eo=function(e,t){return e.index-t.index},Vo=function(e,t){return e.trackNumber-t.trackNumber},Ro=function(e,t){return e.label<t.label?-1:e.label>t.label?1:0};e.DataGroup=void 0,(Ao=e.DataGroup||(e.DataGroup={})).Color="color",Ao.Effects="effects",Ao.Opacity="opacity",Ao.Point="point",Ao.Size="size",Ao.Timing="timing";var Oo=Object.values(e.DataGroup),_o=function(e){return Oo.includes(e)};function jo(e,t){_o(e)||W(e,"DataGroup",t)}var No=function(e){return J(e)&&"type"in e&&Ht(e.type)};function qo(e,t){No(e)||W(e,"Property",t)}var Bo=function(t,i){return Z(t)?ee(i)?e.DataType.Boolean:se(i)?e.DataType.Number:e.DataType.String:(Wt(t),t)},Uo=function(e,t){return Z(t)?wr(e):t},Lo=function(t){var i=t.type,n=t.name,r=t.defaultValue,a=s(t,k),o=Bo(i,r),u=Uo(o,r),c=ke(n)?n:o,l=m({type:o,defaultValue:u,name:c},a);return i===e.DataType.Percent&&(Z(l.max)&&(l.max=1),Z(l.min)&&(l.min=0),Z(l.step)&&(l.step=.01)),l},Go="temporary",Ho={},Wo=function(){var e=[Go];return e.push(Date.now().toString(36)),e.push(Math.random().toString(36).slice(2)),e.join("-")},Jo=function(e){var t=[];return t.push(e),Ho[e]||(Ho[e]=0),t.push(String(Ho[e]++)),t.join("-")},Ko=function(){return Jo(Go)},Xo=function(e){return e.startsWith(Go)},Yo="".concat(Li,"container.image").concat(Gi),Zo="".concat(Li,"container.image.text"),$o=function(e){return J(e)&&"opacity"in e};function Qo(e){$o(e)||W(e,"ContainerObject")}var es=function(e){return yo(e)&&yt(e.type)},ts=function(e){return vo(e)&&yt(e.type)};function is(e){if(!ts(e))throw new Error("expected Container")}var ns="".concat(Li,"content.image").concat(Gi),rs=function(e){return vo(e)&&Tt(e.type)};function as(e,t){rs(e)||W(e,"Content",t)}var os=function(e){return yo(e)&&Tt(e.type)};function ss(e){return function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),v(u(e),"type",Ge),e}return f(i,[{key:"loadPromise",value:function(e){return Promise.resolve()}}]),i}(e)}var us=function(e){return J(e)&&"x"in e&&"y"in e&&se(e.x)&&se(e.y)};function cs(e,t){us(e)||W(e,"Point",t)}var ls=function(e,t){return!!us(t)&&e.x===t.x&&e.y===t.y},hs={x:0,y:0},fs=function(e){return{x:e.x,y:e.y}},ds=function(e){var t=e.x,i=e.y;return{x:Math.round(t),y:Math.round(i)}},ps=function(e){var t=e.x,i=e.y;return"x=".concat(t,";y=").concat(i)},vs=function(e){var t=e.x,i=e.y;return"".concat(t,",").concat(i)},ms=function(e){return{x:-e.x,y:-e.y}},ys=function(e){return Ea(e)&&us(e)};function gs(e,t){ys(e)||W(e,"Rect",t)}var ks=function(e,t){return!!ys(t)&&ls(e,t)&&Ra(e,t)},Ts=m(m({},hs),Oa),bs=function(e,t){var i=t||hs,n=e.width,r=e.height;return{x:i.x,y:i.y,width:n,height:r}},ws=function(e,t){var i=t||[hs,hs],n=p(e,2),r=n[0],a=n[1],o=p(i,2),s=o[0],u=o[1];return[bs(r,s),bs(a,u)]},Fs=function(e){return m(m({},fs(e)),Xa(e))},Ss=function(e){return m(m({},Na(e)),ds(e))},Is=function(e,t){return{x:Math.round((e.width-t.width)/2),y:Math.round((e.height-t.height)/2)}},Cs=function(e){var t=[];return Ea(e)&&t.push(Za(e)),us(e)&&t.push(ps(e)),t.join(";")},Ps=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];fe(i),fe(t);var a=n?t:0;return(e-t+a+(r?t:0))*i-a},xs=function(e,t,i,n){return e+(t-e)/n*i},As=function(e,t,i,n){Y(e),Y(t);var r=i/n;return Ce(fr(e),"hex color"),7===e.length||4===e.length?cr(gr(dr(e),dr(t),r)):lr(yr(pr(e),pr(t),r))},Ms=function(e,t,i,n){return{x:xs(e.x,t.x,i,n),y:xs(e.y,t.y,i,n),width:xs(e.width,t.width,i,n),height:xs(e.height,t.height,i,n)}},Ds=function(e,t,i){Te(e);var n=[e];if(ke(t)&&i>1)for(var r=1;r<i;r++)n.push(As(e,t,r,i));return n},zs=function(e,t,i){var n=[e];if(t&&i>1)for(var r=1;r<i;r++)n.push(Ms(e,t,r,i));return n},Es=function(e,t){var i=e.width,n=e.height;return!Ea(t)||Ra(e,t)?{width:i,height:n}:{width:Math.max(i,t.width),height:Math.max(n,t.height)}},Vs=function(e,t){var i=e.width,n=e.height;return!Ea(t)||Ra(e,t)?{width:i,height:n}:{width:Math.min(i,t.width),height:Math.min(n,t.height)}},Rs=function(e,t,i,n){Q(e);var r=n?Math.round(e):e;if(!se(t))return r;var a=n?Math.round(t):t;return r===a?r:"(".concat(r,"+(").concat(a-r,"*").concat(i,"))")},Os=function(e,t){return!!ys(t)&&(e.x!==t.x||e.y!==t.y||e.width!==t.width||e.height!==t.height)},_s=function(e,t){return"(".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"n","/").concat(e*t,")")},js=function(e){if(!J(e))return{};var t=Object.entries(e).filter((function(e){var t=p(e,2),i=(t[0],t[1]);return se(i)}));return Object.fromEntries(t)},Ns=function(e,t){return m(m({},e),js(t))},qs=function(e,t){return m(m({},e),js(t))},Bs=function(e,t){return re(t)?m(m({},e),js(t)):e},Us=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Va(e),gs(t);var n=e.width,r=e.height,a=t.x,o=t.y,s=t.width,u=t.height;fe(a),fe(o),fe(s),fe(u);var c=Ua(e,s,u),l=qa(c);return m(m({},l),{},{x:Math.round(Ps(n,l.width,a,i.E,i.W)),y:Math.round(Ps(r,l.height,o,i.N,i.S))})},Ls=function(e,t,i){var n=me(t)?t:[t,t],r=p(n,2),a=r[0],o=r[1],s=La(e,a),u=La(e,o),c=p(i,2),l=c[0],h=c[1],f=l.width,d=l.height,v=h.width,m=h.height,y=Ua(s,f,d),g=Ua(u,v,m);return[qa(y),qa(g)]},Gs=function(e,t,i){var n=me(t)?t:[t,t],r=p(e,2),a=r[0],o=r[1],s=p(n,2),u=s[0],c=s[1],l=p(i,2),h=l[0],f=l[1],d=h.x,v=h.y,m=f.x,y=f.y;return[{x:d*(a.width-u.width),y:v*(a.height-u.height)},{x:m*(o.width-c.width),y:y*(o.height-c.height)}]},Hs=function(e,t){return m(m({},e),Ya(e,t))},Ws=function(e,t){return e.map((function(e){return Hs(e,t)}))},Js=function(t,i,n,r){if(!r)return t;var a=i.width,o=i.height,s=m({},t);switch(r){case e.Orientation.H:s.width=o*s.height*n/a;break;case e.Orientation.V:s.height=a*s.width/n/o}return s},Ks=function(e){mo(e);var t=e.clip,i=t.track.mash.quantize,n=t.timeRange(i),r=e.tweenPoints(n,n);return!ls.apply(void 0,d(r))},Xs=function(e,t,i){return Math.min(i,Math.max(t,e))},Ys=function(e,t,i,n,r){if(n){if(!t)return i?e.startTime:e.lastTime;if(r){if(i)return e.lastTime}else if(!i)return e.startTime}},Zs=function(e,t,i){var n=e.filter((function(e){return e.input})),r=n.findIndex((function(e){return e.inputId===t}));return he(r)||console.log("commandFilesInputIndex",t,n),fe(r,"commandFilesInputIndex"),r},$s=function(e,t,i){var n=i?"v":"a";return[Zs(e,t),n].join(":")},Qs=function(e){c(i,e);var t=l(i);function i(){var e,n;h(this,i);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];n=t.call.apply(t,[this].concat(a)),v(u(n),"definition",void 0),v(u(n),"_id",void 0),v(u(n),"_label","");var s=a[0];Se(s);var c=s.definition;return c&&(n.definition=c),(e=n.properties).push.apply(e,d(n.definition.properties)),n.propertiesInitialize(s),n}return f(i,[{key:"mediaId",get:function(){return this.definition.id}},{key:"definitionIds",value:function(){return[this.mediaId]}},{key:"id",get:function(){return this._id||(this._id=Wo())}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"serverPromise",value:function(e){return this.definition.serverPromise(e)}},{key:"toJSON",value:function(){var e=this.mediaId,t=this.type,n=this.label;return m(m({},a(o(i.prototype),"toJSON",this).call(this)),{},{type:t,label:n,mediaId:e})}},{key:"type",get:function(){return this.definition.type}},{key:"unload",value:function(){this.definition.unload()}}]),i}(Pr),eu=function(){function t(i){var n=i.name,r=i.value,a=i.dataType,o=i.values;if(h(this,t),v(this,"dataType",e.DataType.String),v(this,"name",""),v(this,"value",""),v(this,"values",void 0),!n)return W(V.Internal);if(this.values=o,this.name=n,Z(r)){var s;if(null===(s=this.values)||void 0===s||!s.length)return W(V.Internal);this.value=this.values[0]}else this.value=r;a&&Gt.map(String).includes(a)?this.dataType=a:(Array.isArray(this.value)?this.value.every((function(e){return Ie(e.value)})):Ie(this.value))&&(this.dataType=e.DataType.Number)}return f(t,[{key:"toJSON",value:function(){return{name:this.name,value:this.value}}}]),t}(),tu={},iu=function(e){return J(e)&&"instanceFromObject"in e};function nu(e,t){iu(e)||W(e,"FilterDefinition",t)}var ru,au=function(e){c(i,e);var t=l(i);function i(e){var n,r,a;h(this,i),a=t.call(this),v(u(a),"parameters",[]),v(u(a),"_parametersDefined",void 0),v(u(a),"_label","");var o=e.definition,s=e.parameters;return nu(o),a.definition=o,null!==s&&void 0!==s&&s.length&&(n=a.parameters).push.apply(n,d(s.map((function(e){var t=e.name;if(!e.dataType){var i=a.definition.parameters.find((function(e){return e.name===t}));i&&(e.dataType=i.dataType)}return new eu(e)})))),(r=a.properties).push.apply(r,d(a.definition.properties)),a.propertiesInitialize(e),a}return f(i,[{key:"commandFiles",value:function(e){return this.definition.commandFiles(m(m({},e),{},{filter:this}))}},{key:"commandFilters",value:function(e){return this.definition.commandFilters(m(m({},e),{},{filter:this}))}},{key:"parametersDefined",get:function(){if(this._parametersDefined)return this._parametersDefined;var e=d(this.parameters);return e.push.apply(e,d(this.definition.parameters.filter((function(t){return!e.find((function(e){return e.name===t.name}))})))),this._parametersDefined=e}},{key:"filterSvgs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.definition.filterDefinitionSvgs(m(m({},e),{},{filter:this}))}},{key:"filterSvgFilter",value:function(){var e=this.scalarObject();return this.definition.filterDefinitionSvgFilter(e)}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"scalarObject",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i={};return this.parametersDefined.forEach((function(t){var n=t.name,r=t.value;ke(r)&&e.properties.find((function(e){return r===e.name}))||(se(r)||X(r))&&(i[n]=r)})),this.properties.forEach((function(n){var r=n.tweenable,a=n.name;if(!re(i[a])&&(i[a]=e.value(a),t&&r)){var o="".concat(a).concat(Cr);i[o]=e.value(o)}})),i}},{key:"toString",value:function(){return"[Filter ".concat(this.label,"]")}}]),i}(Pr),ou=function(){function t(e){h(this,t),v(this,"id",void 0),v(this,"_ffmpegFilter",void 0),v(this,"properties",[]),v(this,"parameters",[]);var i=e.id;Te(i,"id"),this.id=i}return f(t,[{key:"commandFiles",value:function(e){return[]}},{key:"commandFilters",value:function(e){var t=e.filter,i=e.duration,n=e.filterInput;Te(n);var r=[],a=t.scalarObject(!!i);_e(a);var o=this.ffmpegFilter,s={inputs:[n],ffmpegFilter:o,options:a,outputs:[Jo(o)]};return r.push(s),r}},{key:"commandFilter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.ffmpegFilter,i={ffmpegFilter:t,options:e,inputs:[],outputs:[Jo(t)]};return i}},{key:"ffmpegFilter",get:function(){return this._ffmpegFilter||(this._ffmpegFilter=this.id.split(".").pop()||this.id)}},{key:"filterDefinitionSvgs",value:function(e){return W(V.Unimplemented)}},{key:"instanceArgs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.fromEntries(this.properties.map((function(e){return[e.name,e.defaultValue]})));return m(m(m({},t),e),{},{definition:this})}},{key:"instanceFromObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new au(this.instanceArgs(e))}},{key:"populateParametersFromProperties",value:function(){this.parameters=this.properties.map((function(t){var i=t.name;return new eu({name:i,value:i,dataType:e.DataType.String})}))}},{key:"filterDefinitionSvgFilter",value:function(e){return W(V.Unimplemented)}},{key:"toJSON",value:function(){return{id:this.id}}},{key:"toString",value:function(){return this.id}}]),t}(),su=!1,uu=function(){return ru||(ru=gu())},cu=function(e){ru=e},lu=function(e){return"#".concat(e)},hu=function(e){return"url(".concat(lu(e),")")},fu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=globalThis.document.createElementNS(qi,"g");return Mu(i,t),du(i,e),i},du=function(e,t){if(Ea(t)){var i=t.width,n=t.height;he(i)&&Mu(e,String(i),"width"),he(n)&&Mu(e,String(n),"height")}if(us(t)){var r=t.x,a=t.y;Mu(e,String(r),"x"),Mu(e,String(a),"y")}},pu=function(e,t){cs(t);var i=t.x,n=t.y;(i||n)&&Eu(e,"translate(".concat(i,", ").concat(n,")"))},vu=function(e){var t=e.width,i=e.height,n=e.x,r=void 0===n?0:n,a=e.y,o=void 0===a?0:a,s={x:r,y:o},u=[];return u.push(s),u.push({x:r+t,y:o}),u.push({x:r+t,y:o+i}),u.push({x:r,y:o+i}),u.push(s),u},mu=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3?arguments[3]:void 0,r=globalThis.document.createElementNS(qi,"polygon"),a=vu(e).map((function(e){return[e.x,e.y].join(",")})).join(" ");return Mu(r,a,"points"),Mu(r,i,"fill"),Du(r,t),Mu(r,n),r},yu=function(e,t){Ha(t,"svgSetBox");var i=Xa(t),n=i.width,r=i.height;du(e,i);var a="0 0 ".concat(n," ").concat(r);Mu(e,a,"viewBox")},gu=function(e,t){var i=globalThis.document.createElementNS(qi,"svg");return Mu(i,"1.1","version"),Mu(i,qi,"xmlns"),Su(i,t),Ga(e)?(yu(i,e),i):i},ku=function(e,t,i){Ha(t),i||Mu(e,"none","preserveAspectRatio");var n=m(m({},$a(t,i)),fs(t));du(e,n)},Tu=function(){var e=globalThis.document.createElementNS(qi,"image");return Mu(e,"none","preserveAspectRatio"),e},bu=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"currentColor",i=globalThis.document.createElementNS(qi,"path");return Mu(i,e,"d"),Mu(i,t,"fill"),i},wu=function(e,t,i){var n=Wo(),r=globalThis.document.createElementNS(qi,"mask");return Mu(r,n),Ga(e)&&Su(r,mu(e,"",i?"black":"none")),t&&(Mu(t,hu(n),"mask"),i&&Mu(t,"luminance","mask-mode")),r},Fu=function(e,t){var i=e.filter,n=s(e,T);Te(i);var r=globalThis.document.createElementNS(qi,i);return du(r,t),Object.entries(n).forEach((function(e){var t=p(e,2),i=t[0],n=t[1];Mu(r,String(n),i)})),r},Su=function(e,t){t&&(me(t)?t:[t]).forEach((function(t){return e.appendChild(t)}))},Iu=function(e,t,i){var n=globalThis.document.createElementNS(qi,"pattern");return Mu(n,t),yu(n,e),Mu(n,"userSpaceOnUse","patternUnits"),Su(n,i),n},Cu=function(e){var t=globalThis.document.createElementNS(qi,"defs");return Su(t,e),t},Pu=function(e,t){var i=globalThis.document.createElementNS(qi,"feImage");return ke(e)&&Mu(i,lu(e),"href"),Mu(i,t,"result"),i},xu=function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"userSpaceOnUse",r=globalThis.document.createElementNS(qi,"filter");if(n&&Mu(r,n,"filterUnits"),Mu(r,"sRGB","color-interpolation-filters"),Su(r,e),t){var a=Wo();Mu(r,a),t&&(me(t)?t:[t]).forEach((function(e){Mu(e,hu(a),"filter"),Du(e,"filtered")}))}return du(r,i),r},Au=function(e,t){var i={filter:"feBlend"},n=Wo(),r=Fu(m(m({},i),{},{mode:"difference"}));Mu(r,n,"in"),Mu(r,"SourceGraphic","in2");var a=Pu(e,n),o=xu([a,r],t,hs);return Mu(o,"100%","width"),Mu(o,"100%","height"),o},Mu=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id";ke(t)&&e.setAttribute(i,t)},Du=function(e,t){var i;if(t){var n=me(t)?t:t.split(" ");(i=e.classList).add.apply(i,d(n))}},zu=function(e,t,i){var n=globalThis.document.createElementNS(qi,"use");return ke(e)&&Mu(n,lu(e),"href"),Mu(n,i),Du(n,t),n},Eu=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top left";Mu(e,t,"transform"),Mu(e,i,"transform-origin")},Vu=function(e,t){Ha(e,"svgTransform.dimensions"),Ha(t,"svgTransform.rect");var i=e.width,n=e.height,r=t.width,a=t.height,o=t.x,s=t.y,u=r/i,c=a/n,l=[];if(0===o&&0===s||l.push("translate(".concat(o,",").concat(s,")")),1===u&&1===c||l.push("scale(".concat(u,",").concat(c,")")),us(e)){var h=e.x,f=e.y;0===h&&0===f||l.push("translate(".concat(h,",").concat(f,")"))}return l.join(" ")},Ru=function(e,t,i){Eu(e,Vu(t,i))},Ou=function(e,t){var i=globalThis.document.createElementNS(qi,e);return Mu(i,t,"tableValues"),Mu(i,"discrete","type"),i},_u=function(e,t){if(!e.hasChildNodes())return Su(e,t);var i=e.childNodes,n=[];i.forEach((function(e){t.includes(e)||n.push(e)})),n.forEach((function(t){e.removeChild(t)})),t.forEach((function(t){return e.appendChild(t)}))},ju=function(e){return new Promise((function(t,i){var n=Tu(),r=function(){n.removeEventListener("error",a),n.removeEventListener("load",o),ru&&!su&&ru.appendChild(n)},a=function(e){r(),i(e)},o=function(){r(),t(n)};n.addEventListener("error",a,{once:!0}),n.addEventListener("load",o,{once:!0}),ru&&!su&&ru.appendChild(n),Mu(n,e,"href")}))},Nu=function(e,t,i,n){var r=globalThis.document.createElementNS(qi,"text");return r.setAttribute("font-family",t),r.setAttribute("font-size",String(i)),r.append(e),Eu(r,n),r},qu=function(e,t){return ju(e).then((function(e){var i=t.lock,n=s(t,b);return ku(e,n,i),e}))};!function(){var e=globalThis.document;if(e){var t=e.createElement("canvas");t.width=t.height=1;var i=t.getContext("2d");Ce(i),i.fillRect(0,0,1,1),ju(t.toDataURL()).then((function(){su=!0}))}}();var Bu=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),(r=i.call(this,t)).properties.push(Lo({custom:!0,name:"color",type:e.DataType.String,defaultValue:ar})),r.properties.push(Lo({custom:!0,name:"similarity",type:e.DataType.Percent,defaultValue:.9,min:.1,step:.01,max:1})),r.properties.push(Lo({custom:!0,name:"blend",type:e.DataType.Percent,defaultValue:0,step:.01,max:1})),r.populateParametersFromProperties(),r}return f(n,[{key:"filterDefinitionSvgFilter",value:function(e){var t=e.similarity,i=e.color,n=e.blend;Q(t),Q(n),Te(i);var r=255,a=r*r*(1-n),o=dr(i),s=1-t*(o.r/r),u=1-t*(o.g/r),c=1-t*(o.b/r),l="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 ".concat(s," ").concat(u," ").concat(c," -").concat(a," ").concat(a);return[Fu({filter:"feColorMatrix",type:"matrix",values:l})]}}]),n}(ou),Uu=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),r=i.call(this,t),v(u(r),"_ffmpegFilter","geq"),r.properties.push(Lo({tweenable:!0,custom:!0,name:"color",type:e.DataType.String})),r.populateParametersFromProperties(),r}return f(n,[{key:"commandFilters",value:function(e){var t=[],i=e.filter,n=e.videoRate,r=e.duration,a=e.filterInput;Q(r,"duration"),Q(n,"videoRate");var o=i.value("color");Te(o,"color");var s=a;Te(s,"filterInput");var u="format",c=Jo(u),l={inputs:[s],ffmpegFilter:u,options:{pix_fmts:"rgba"},outputs:[c]};t.push(l),s=c;var h=i.value("color".concat(Cr))||o;Te(h);var f=o.length>7,d=f?pr(o):dr(o),p=f?pr(h):dr(h),v=f?Zn:Yn,m={},y=r?_s(n,r,"N"):0;v.forEach((function(e){var t=d[e],i=p[e];m[e]=t===i?t:"".concat(t,"+(").concat(i-t,"*").concat(y,")")})),f||(m.a="alpha(X,Y)");var g="geq",k=Jo(g),T={inputs:[s],ffmpegFilter:g,options:m,outputs:[k]};return t.push(T),t}}]),n}(ou),Lu=function(e){var t=String(e);return"0x"===t.slice(0,2)?"#".concat(t.slice(2)):t},Gu=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),r=i.call(this,t),v(u(r),"_ffmpegFilter","color"),r.properties.push(Lo({tweenable:!0,name:"color",type:e.DataType.String})),["width","height"].forEach((function(t){r.properties.push(Lo({tweenable:!0,name:t,type:e.DataType.Number}))})),r.populateParametersFromProperties(),r}return f(n,[{key:"commandFilters",value:function(e){var t=[],i=e.filter,n=e.videoRate,r=e.duration;ve(n,"videoRate");var a=this.ffmpegFilter,o=Jo(a),s=i.value("color");Te(s);var u=r?i.value("color".concat(Cr)):void 0,c=ke(u)&&s!==u,l=i.scalarObject(!!r);Va(l);var h=l.width,f=l.height,d=!1,p={width:h,height:f},v={width:h,height:f};if(r){var m=l["width".concat(Cr)],y=void 0===m?h:m,g=l["height".concat(Cr)],k=void 0===g?f:g;Q(y),Q(k),(d=!(h===y&&f===k))&&(v.width=y,v.height=k)}var T=d?Es(p,v):p,b={inputs:[],ffmpegFilter:a,options:{color:s,rate:n,size:Object.values(T).join("x")},outputs:[o]};if(pe(r)&&(b.options.duration=r),t.push(b),c){var w="fade",F=Jo(w),S={inputs:[o],ffmpegFilter:w,options:{type:"out",color:u,duration:r},outputs:[F]};t.push(S),o=F}if(d){var I="scale",C=Jo(I),P=_s(n,r),x={inputs:[o],ffmpegFilter:I,options:{eval:"frame",width:Rs(p.width,v.width,P),height:Rs(p.height,v.height,P)},outputs:[C]};t.push(x)}return t}},{key:"filterDefinitionSvgs",value:function(e){var t=e.filter.scalarObject(!1),i=t.width,n=t.height,r=t.color;Te(r);var a=globalThis.document.createElementNS(qi,"rect");return a.setAttribute("width",String(i)),a.setAttribute("height",String(n)),a.setAttribute("fill",Lu(r)),[a]}}]),n}(Uu),Hu=Zn.flatMap((function(e){return Zn.map((function(t){return"".concat(e).concat(t)}))})),Wu=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),r=i.call(this,t),Hu.forEach((function(t){r.properties.push(Lo({custom:!0,name:t,type:e.DataType.Number,defaultValue:t[0]===t[1]?1:0,min:0,max:1}))})),r.populateParametersFromProperties(),r}return f(n,[{key:"filterDefinitionSvgFilter",value:function(e){var t={filter:"feColorMatrix",type:"matrix",values:Zn.flatMap((function(t){return[].concat(d(Zn.map((function(i){return Number(e["".concat(t).concat(i)])}))),[0])})).join(" ")};return[Fu(t)]}}]),n}(ou),Ju=function(e){c(i,e);var t=l(i);function i(e){var n;return h(this,i),(n=t.call(this,e)).properties.push(Lo({custom:!0,name:"bias",defaultValue:0,min:0,max:100,step:.01})),n.properties.push(Lo({custom:!0,name:"matrix",defaultValue:"0 0 0 0 1 0 0 0 0"})),n.properties.push(Lo({custom:!0,name:"multiplier",defaultValue:1,min:0,max:100,step:.01})),n.populateParametersFromProperties(),n}return f(i,[{key:"commandFilters",value:function(e){var t=e.filterInput,i=e.filter,n=e.duration;Te(t,"filterInput");var r=[],a=i.scalarObject(!!n);Xu(a);var o=this.ffmpegFilter,s={inputs:[t],ffmpegFilter:o,options:sc(oc(a)),outputs:[Jo(o)]};return r.push(s),r}},{key:"filterDefinitionSvgFilter",value:function(e){Xu(e);var t=e.matrix,i=e.bias,n=e.multiplier,r={filter:"feConvolveMatrix",kernelMatrix:String(t),bias:String(i)};return pe(n)&&(r.divisor=String(n)),[Fu(r)]}}]),i}(ou),Ku=function(e){return J(e)&&"matrix"in e&&"bias"in e&&"multiplier"in e};function Xu(e){if(!Ku(e))throw new Error("expected ConvolutionServerFilter")}var Yu=function(e){return(e||"0 0 0 0 1 0 0 0 0").split(",").map((function(e){return parseInt(e.trim())}))},Zu=function(e){return null!==e&&void 0!==e&&e.length?parseFloat(e.trim()):0},$u=function(e){if(null===e||void 0===e||!e.length)return 1;if(e.includes("/")){var t=e.split("/").map((function(e){return parseFloat(e.trim())})),i=p(t,2);return i[0]/i[1]}return parseFloat(e.trim())},Qu=function(e){return{combined:e,r:e,g:e,b:e,a:e}},ec=function(e){return{combined:e,r:e,g:e,b:e,a:e}},tc=function(e){return{combined:e,r:e,g:e,b:e,a:e}},ic=function(e){return Qu(String(e))},nc=function(e){var t=e.combined;return ec(Yu(String(t)))},rc=function(e){var t=e.combined;return tc(Zu(String(t)))},ac=function(e){var t=e.combined;return tc($u(String(t)))},oc=function(e){var t=ic(e.matrix),i=ic(e.multiplier),n=nc(t);return{multiplier:ac(i),matrix:n,bias:t.combined?tc(0):rc(ic(e.bias))}},sc=function(e){var t={};return Zn.map((function(e){return e})).forEach((function(i,n){var r=e.multiplier[i],a=e.matrix[i];t["".concat(n,"m")]=a.join(" "),t["".concat(n,"rdiv")]=r,t["".concat(n,"bias")]=e.bias[i]})),t},uc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),(r=i.call(this,t)).properties.push(Lo({custom:!0,name:"width",type:e.DataType.String})),r.properties.push(Lo({custom:!0,name:"height",type:e.DataType.String})),r.properties.push(Lo({tweenable:!0,custom:!0,name:"x",type:e.DataType.Number,defaultValue:0,min:0,step:1})),r.properties.push(Lo({tweenable:!0,custom:!0,name:"y",type:e.DataType.Number,defaultValue:0,min:0,step:1})),r.populateParametersFromProperties(),r}return f(n,[{key:"commandFilters",value:function(e){var t=e.filter,i=e.filterInput,n=e.duration,r=e.videoRate;Te(i);var a=[],o=t.scalarObject(!!n),s={exact:1},u=_s(r,n);s.x=Rs(o.x,o["x".concat(Cr)],u,!0),s.y=Rs(o.y,o["y".concat(Cr)],u,!0);var c=o.width,l=o.height;Ve(c)&&(s.w=c),Ve(l)&&(s.h=l);var h=this.ffmpegFilter,f={inputs:[i],ffmpegFilter:h,options:s,outputs:[Jo(h)]};return a.push(f),a}}]),n}(ou),cc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),(r=i.call(this,t)).properties.push(Lo({tweenable:!0,custom:!0,name:"x",type:e.DataType.Percent,defaultValue:.5})),r.properties.push(Lo({tweenable:!0,custom:!0,name:"y",type:e.DataType.Percent,defaultValue:.5})),r.properties.push(Lo({custom:!0,name:"format",type:e.DataType.String,defaultValue:"yuv420"})),r.properties.push(Lo({custom:!0,name:"alpha",type:e.DataType.String,defaultValue:"straight"})),r.populateParametersFromProperties(),r}return f(n,[{key:"commandFilters",value:function(e){var t=[],i=e.filter,n=e.filterInput,r=e.chainInput,a=e.duration,o=e.videoRate;Te(n,"filterInput"),Te(r,"chainInput");var s=i.scalarObject(!!a),u={},c=s.format,l=s.alpha;ke(c)&&(u.format=c),ke(l)&&(u.alpha=l);var h=_s(o,a,"(n-1)"),f=Rs(s.x,s["x".concat(Cr)],h,!0),d=Rs(s.y,s["y".concat(Cr)],h,!0),p=0===d;0===f||(u.x=f),p||(u.y=d);var v={inputs:[r,n],ffmpegFilter:"overlay",options:u,outputs:[]};return t.push(v),t}}]),n}(ou),lc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),(r=i.call(this,t)).properties.push(Lo({name:"width",type:e.DataType.Percent,defaultValue:1,max:2})),r.properties.push(Lo({name:"height",type:e.DataType.Percent,defaultValue:1,max:2})),r.properties.push(Lo({name:"width".concat(Cr),type:e.DataType.Percent,defaultValue:1,max:2})),r.properties.push(Lo({name:"height".concat(Cr),type:e.DataType.Percent,defaultValue:1,max:2})),r.populateParametersFromProperties(),r}return f(n,[{key:"commandFilters",value:function(e){var t=[],i=e.filter,n=e.duration,r=e.filterInput,a=e.videoRate,o=i.scalarObject(!!n),s=o.width,u=o.height,c=o["width".concat(Cr)],l=o["height".concat(Cr)];Te(r);var h=this.ffmpegFilter,f=_s(a,n),d={width:Rs(s,c,f,!0),height:Rs(u,l,f,!0)};se(d.width)&&se(d.height)||(d.eval="frame");var p={inputs:[r],ffmpegFilter:h,options:d,outputs:[Jo(h)]};return t.push(p),t}}]),n}(ou),hc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),r=i.call(this,t),v(u(r),"_ffmpegFilter","geq"),r.properties.push(Lo({tweenable:!0,custom:!0,name:"opacity",type:e.DataType.Number,defaultValue:1})),r.populateParametersFromProperties(),r}return f(n,[{key:"commandFilters",value:function(e){var t=[],i=e.filterInput,n=e.filter,r=e.duration,a=e.videoRate,o=n.value("opacity"),s=i;Q(o),Te(s,"filterInput");var u={lum:"lum(X,Y)",cb:"cb(X,Y)",cr:"cr(X,Y)",a:"alpha(X,Y)*".concat(o)};if(r){var c=n.value("opacity".concat(Cr));if(se(c)&&o!=c){var l=_s(a,r,"N"),h=c-o;u.a="alpha(X,Y)*(".concat(o,"+(").concat(h,"*").concat(l,"))")}}var f=this.ffmpegFilter,d={inputs:[s],ffmpegFilter:f,options:u,outputs:[Jo(f)]};return t.push(d),t}},{key:"filterDefinitionSvgFilter",value:function(e){var t=e.opacity;Q(t);var i=globalThis.document.createElementNS(qi,"feColorMatrix");i.setAttribute("type","matrix");var n="1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 ".concat(t," 0");return Mu(i,n,"values"),[i]}}]),n}(ou),fc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),(r=i.call(this,t)).properties.push(Lo({custom:!0,name:"sar",type:e.DataType.String,defaultValue:"0"})),r.properties.push(Lo({custom:!0,name:"max",type:e.DataType.Number,defaultValue:100})),r.populateParametersFromProperties(),r}return f(n)}(ou),dc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),(r=i.call(this,t)).properties.push(Lo({custom:!0,name:"fps",type:e.DataType.Number})),r.populateParametersFromProperties(),r}return f(n)}(ou),pc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),(r=i.call(this,t)).properties.push(Lo({custom:!0,name:"expr",type:e.DataType.String,defaultValue:"PTS-STARTPTS"})),r.populateParametersFromProperties(),r}return f(n)}(ou),vc=function(e){c(i,e);var t=l(i);function i(){return h(this,i),t.apply(this,arguments)}return f(i,[{key:"commandFilters",value:function(e){var t=[],i=e.chainInput,n=e.filterInput;Te(i,"chainInput"),Te(n,"filterInput");var r=this.ffmpegFilter,a={inputs:[i,n],ffmpegFilter:r,options:{},outputs:[Jo(r)]};return t.push(a),t}}]),i}(ou),mc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),(r=i.call(this,t)).properties.push(Lo({custom:!0,name:"start",type:e.DataType.Number,defaultValue:0})),r.populateParametersFromProperties(),r}return f(n)}(ou),yc=function(t){c(n,t);var i=l(n);function n(t){var r;return h(this,n),r=i.call(this,t),v(u(r),"_ffmpegFilter","drawtext"),r.properties.push(Lo({custom:!0,type:e.DataType.String,name:"fontfile"})),r.properties.push(Lo({custom:!0,type:e.DataType.String,name:"textfile"})),r.properties.push(Lo({custom:!0,type:e.DataType.Boolean,name:"stretch"})),r.properties.push(Lo({tweenable:!0,custom:!0,type:e.DataType.Number,name:"height"})),r.properties.push(Lo({tweenable:!0,custom:!0,type:e.DataType.Number,name:"width"})),r.properties.push(Lo({custom:!0,type:e.DataType.Number,name:"intrinsicHeight"})),r.properties.push(Lo({custom:!0,type:e.DataType.Number,name:"intrinsicWidth"})),r.properties.push(Lo({tweenable:!0,custom:!0,type:e.DataType.Number,name:"x"})),r.properties.push(Lo({tweenable:!0,custom:!0,type:e.DataType.Number,name:"y"})),r.properties.push(Lo({tweenable:!0,custom:!0,type:e.DataType.String,name:"color"})),r.populateParametersFromProperties(),r}return f(n,[{key:"colorCommandFilter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tr,r=e.width,a=e.height,o="color",s=Jo(o),u={color:n,size:"".concat(r,"x").concat(a)};return t&&(u.rate=t),i&&(u.duration=i),{inputs:[],ffmpegFilter:o,options:u,outputs:[s]}}},{key:"commandFilters",value:function(e){var t=[],i=e.filter,n=e.duration,r=e.videoRate,a=e.filterInput,o=i.value("color"),s=i.value("x"),u=i.value("y"),c=i.value("textfile"),l=i.value("fontfile"),h=i.value("height"),f=i.value("width"),d=!!i.value("stretch"),p=i.value("intrinsicWidth"),v=i.value("intrinsicHeight");Te(c),Te(l),Q(h),Q(f),Q(p),Q(v),Q(s),Q(u),Te(o,"color");var y=i.value("x".concat(Cr)),g=i.value("y".concat(Cr)),k=n?i.value("color".concat(Cr)):void 0,T=ke(k)&&o!==k,b=this.ffmpegFilter,w=Jo(b),F=T||a?er:o,S=Qn;a||(S=T?ir:tr);var I={width:f,height:h},C=m({},I);if(n){var P=i.value("height".concat(Cr))||0,x=i.value("width".concat(Cr))||0;pe(x)&&(C.width=x),pe(P)&&(C.height=P)}var A=p/v,M=Es(I,C),D=Math.round(A*M.height);D>M.width&&(M.width=D);var z=d||!Ra(I,C),E={},V={fontsize:M.height,fontfile:l,textfile:c,x:Math.ceil(se(y)?Math.max(s,y):s),y:Math.ceil(se(g)?Math.max(u,g):u)},R=_s(r,n);if(T){var O=o.length>7,_=O?pr(o):dr(o),j=O?pr(k):dr(k),N=(O?Zn:Yn).map((function(e){var t=_[e],i=j[e];return t===i?t:"".concat(t,"+(").concat(i-t,"*").concat(R,")")})).map((function(e){return["eif",e,"x",2].join(":")})).map((function(e){return"%{".concat(e,"}")}));V.fontcolor_expr="#".concat(N.join(""))}else V.fontcolor=F;var q=this.colorCommandFilter(M,r,n,S);t.push(q);var B=Qi(q.outputs);z&&(E.width=d?Rs(f,C.width,R,!0):-1,E.height=Rs(h,C.height,R,!0),se(E.width)&&se(E.height)||(E.eval="frame"));var U={inputs:[B],ffmpegFilter:b,options:V,outputs:[w]};if(t.push(U),B=w,!a){var L="format",G=Jo(L),H={inputs:[B],ffmpegFilter:L,options:{pix_fmts:"yuva420p"},outputs:[G]};t.push(H),B=G}if(z){var W="scale",J=Jo(W),K={inputs:[B],ffmpegFilter:W,options:E,outputs:[J]};t.push(K),B=J}return t}}]),n}(Uu),gc="".concat(Li,"filter."),kc=function(e){return Te(e.id),new ou(e)},Tc=function(e){var t=e.includes(".")?e:"".concat(gc).concat(e),i=tu[t];if(i)return i;throw new Error("NEW FILTER ".concat(e," ").concat(t))},bc=function(e){var t=e.id;return t?Tc(t).instanceFromObject(e):W(V.FilterId)},wc=function(e){return Tc(e).instanceFromObject({id:e})};function Fc(t){return function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=i.call.apply(i,[this].concat(a)),v(u(t),"_alphamergeFilter",void 0),v(u(t),"_clip",void 0),v(u(t),"_colorFilter",void 0),v(u(t),"container",!1),v(u(t),"_cropFilter",void 0),v(u(t),"hasIntrinsicSizing",!1),v(u(t),"hasIntrinsicTiming",!1),v(u(t),"_overlayFilter",void 0),v(u(t),"_scaleFilter",void 0),v(u(t),"selectType",e.SelectType.None),a[0].container&&(t.container=!0),t}return f(n,[{key:"alphamergeCommandFilters",value:function(e){var t=[],i=e.videoRate,n=e.outputSize,r=e.track,a=e.filterInput;Te(a),ve(i),Va(n);var o={videoRate:0,duration:0,filterInput:a,chainInput:"content-".concat(r)},s=this.alphamergeFilter;return t.push.apply(t,d(s.commandFilters(o))),t}},{key:"alphamergeFilter",get:function(){return this._alphamergeFilter||(this._alphamergeFilter=wc("alphamerge"))}},{key:"amixCommandFilters",value:function(e){var t=e.chainInput,i=e.filterInput;Te(t),Te(i);var n=[],r={inputs:[t,i],ffmpegFilter:"amix",options:{normalize:0},outputs:[]};return n.push(r),n}},{key:"canColor",value:function(e){return!1}},{key:"canColorTween",value:function(e){return!1}},{key:"clip",get:function(){return this._clip},set:function(e){this._clip=e}},{key:"clipped",get:function(){return!!this._clip}},{key:"colorBackCommandFilters",value:function(e,t){var i=e.contentColors,n=void 0===i?[]:i,r=e.videoRate,a=e.outputSize,o=e.duration;Va(a);var s=ja(a),u=p(n,2),c=u[0],l=void 0===c?rr:c,h=u[1],f=void 0===h?rr:h,d=t||Jo("back"),v=this.colorFilter,m={videoRate:r,duration:o};v.setValue(l,"color"),v.setValue(f,"color".concat(Cr)),v.setValue(s.width,"width"),v.setValue(s.height,"height"),v.setValue(s.width,"width".concat(Cr)),v.setValue(s.height,"height".concat(Cr));var y=v.commandFilters(m);if(Ra(s,a))Qi(y).outputs=[d];else{var g=Qi(Qi(y).outputs);Te(g,"crop input");var k={inputs:[g],ffmpegFilter:"crop",options:{w:a.width,h:a.height,exact:1},outputs:[d]};y.push(k)}return y}},{key:"colorFilter",get:function(){return this._colorFilter||(this._colorFilter=wc("color"))}},{key:"commandFilters",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[],r=e.filterInput,a=void 0===r?"":r,o=this.initialCommandFilters(e,t,i);return o.length&&(n.push.apply(n,d(o)),a=Qi(Qi(o).outputs)),i?n.push.apply(n,d(this.containerCommandFilters(m(m({},e),{},{filterInput:a}),t))):n.push.apply(n,d(this.contentCommandFilters(m(m({},e),{},{filterInput:a}),t))),n}},{key:"containerColorCommandFilters",value:function(e){var t=[],i=e.contentColors,n=void 0===i?[]:i,r=e.containerRects,a=e.videoRate,o=e.duration;ye(r,"containerRects");var s=p(r,2),u=s[0],c=s[1],l={videoRate:a,duration:o},h=this.colorFilter,f=p(n,2),v=f[0],m=f[1];return h.setValue(v||er,"color"),h.setValue(m,"color".concat(Cr)),h.setValue(u.width,"width"),h.setValue(u.height,"height"),h.setValue(c.width,"width".concat(Cr)),h.setValue(c.height,"height".concat(Cr)),t.push.apply(t,d(h.commandFilters(l))),t}},{key:"containerCommandFilters",value:function(e,t){return[]}},{key:"containerFinalCommandFilters",value:function(e){return[]}},{key:"contentCommandFilters",value:function(e,t){return[]}},{key:"copyCommandFilter",value:function(e,t){return{inputs:[e],ffmpegFilter:"copy",options:{},outputs:["".concat(arguments.length>2&&void 0!==arguments[2]?arguments[2]:"content","-").concat(t)]}}},{key:"cropFilter",get:function(){return this._cropFilter||(this._cropFilter=wc("crop"))}},{key:"definitionTime",value:function(e,t){var i=t.fps,n=t.startTime,r=t.endTime,a=e.scaleToFps(i),o=Math.max(Math.min(a.frame,r.frame),n.frame);return a.withFrame(o-n.frame)}},{key:"frames",value:function(e){return fo(Io.duration,e).frame}},{key:"fileCommandFiles",value:function(e){var t=this,i=[],n=this.graphFiles(e),r=0;return i.push.apply(i,d(n.map((function(e,i){var n=e.input,a=i&&n?"".concat(t.id,"-").concat(r):t.id,o=m(m({},e),{},{inputId:a});return n&&r++,o})))),i}},{key:"graphFiles",value:function(e){return this.definition.graphFiles(e)}},{key:"initialCommandFilters",value:function(e,t){return W(V.Unimplemented)}},{key:"intrinsicRect",value:function(){return W(V.Unimplemented)}},{key:"intrinsicsKnown",value:function(e){return!0}},{key:"intrinsicGraphFile",value:function(e){var t=e.editing,i=e.size,n=e.duration,r=uo(),a={editing:t,time:r.startTime,clipTime:r,quantize:r.fps,visible:i,audible:n},o=this.graphFiles(a),s=p(o,1)[0];return K(s,"graphFile"),s}},{key:"isDefault",get:function(){return!1}},{key:"loadPromise",value:function(e){return this.definition.loadPromise(e)}},{key:"mutable",value:function(){return!1}},{key:"overlayCommandFilters",value:function(e,t,i){Te(e,"bottomInput"),Te(t,"topInput");var n=[],r={filterInput:t,chainInput:e,videoRate:0,duration:0},a=this.overlayFilter;return i&&a.setValue("yuv420p10","format"),a.setValue(0,"x"),a.setValue(0,"y"),n.push.apply(n,d(a.commandFilters(r))),Qi(n).outputs=[Jo(t)],n}},{key:"overlayFilter",get:function(){return this._overlayFilter||(this._overlayFilter=wc("overlay"))}},{key:"preloadUrls",value:function(e){return[]}},{key:"scaleCommandFilters",value:function(e){var t=e.time,i=e.containerRects,n=e.filterInput,r=e.videoRate,a=n;Te(a,"filterInput"),ye(i,"containerRects");var o=p(i,2),s=o[0],u=o[1];gs(s),gs(u);var c=De(t)?t.lengthSeconds:0,l=[],h=this.scaleFilter,f={duration:c,videoRate:r,filterInput:a};return h.setValue(s.width,"width"),h.setValue(s.height,"height"),h.setValue(u.width,"width".concat(Cr)),h.setValue(u.height,"height".concat(Cr)),l.push.apply(l,d(h.commandFilters(f))),l}},{key:"scaleFilter",get:function(){return this._scaleFilter||(this._scaleFilter=wc("scale"))}},{key:"selectables",value:function(){return[this].concat(d(this.clip.selectables()))}},{key:"selectedItems",value:function(t){var i=this,n=[],r=this.container,a=this.clip,o=this.selectType,s=this.definition.id,u=a.timing,c=a.sizing,l=a.track.mash.editor.media,h=r?e.DataType.ContainerId:e.DataType.ContentId,f=a.properties.find((function(e){return e.type===h}));qo(f);var p=f.name,y=v({timing:u,sizing:c},p,s),g=m({},y),k=r?e.Timing.Container:e.Timing.Content,T=r?e.Sizing.Container:e.Sizing.Content,b=u===k,w=c===T;n.push({selectType:o,property:f,value:s,changeHandler:function(i,n){Te(n);var o=m(m({},g),{},v({},p,n));if(b||w){var s=l.fromId(n).type;b&&!vt(s)&&(o.timing=e.Timing.Custom),w&&!dt(s)&&(o.sizing=r?e.Sizing.Content:e.Sizing.Container)}var u={type:e.ActionType.ChangeMultiple,property:i,target:a,redoValues:o,undoValues:y};t.create(u)}});var F=this.properties.filter((function(e){return i.selectedProperty(e)}));return F.forEach((function(e){n.push.apply(n,d(i.selectedProperties(t,e)))})),n}},{key:"selectedProperties",value:function(t,i){var n=this,r=[],a=i.name,o=i.tweenable,s=i.type,u=this.selectType,c=this.value(a),l=s===e.DataType.Frame?e.ActionType.ChangeFrame:e.ActionType.Change,h={selectType:u,property:i,value:c,changeHandler:function(e,i){Te(e),t.create({type:l,property:e,target:n,redoValue:i,undoValue:c})}};if(r.push(h),o){var f=[a,Cr].join(""),d=this.value(f),p={selectType:u,property:i,value:d,name:f,changeHandler:function(e,i){t.create({property:e,target:n,redoValue:i,undoValue:d})}};r.push(p)}return r}},{key:"selectedProperty",value:function(e){switch(e.name){case"muted":return this.mutable();case"opacity":return this.container}return!0}},{key:"tween",value:function(e,t,i){var n=this.value(e),r=this.value("".concat(e).concat(Cr));if(Z(r))return n;var a=i.frame,o=i.frames,s=t.frame-a;return se(n)?(Q(r),xs(n,r,s,o)):(Te(n),Te(r),As(n,r,s,o))}},{key:"tweenPoints",value:function(e,t){var i=this.tweenValues("x",e,t),n=p(i,2),r=n[0],a=n[1],o=this.tweenValues("y",e,t),s=p(o,2),u=s[0],c=s[1];Q(r),Q(u);var l={x:r,y:u};return[l,qs(l,{x:a,y:c})]}},{key:"tweenRects",value:function(e,t){var i=this.tweenSizes(e,t),n=p(i,2),r=n[0],a=n[1],o=this.tweenPoints(e,t),s=p(o,2),u=s[0],c=s[1];return[m(m({},u),r),m(m({},c),a)]}},{key:"tweenSizes",value:function(e,t){var i=this.tweenValues("width",e,t),n=p(i,2),r=n[0],a=n[1],o=this.tweenValues("height",e,t),s=p(o,2),u=s[0],c=s[1];Q(r),Q(u);var l={width:r,height:u};return[l,Bs(l,{width:a,height:c})]}},{key:"tweenValues",value:function(e,t,i){var n=[],r=De(t);return n.push(this.tween(e,r?t.startTime:t,i)),r&&n.push(this.tween(e,t.endTime,i)),n}},{key:"visibleCommandFiles",value:function(e){var t=m(m({},e),{},{audible:!1,visible:!0});return this.fileCommandFiles(t)}}]),n}(t)}!function(){var e={alphamerge:vc,chromakey:Bu,colorchannelmixer:Wu,color:Gu,colorize:Uu,convolution:Ju,crop:uc,fps:dc,opacity:hc,overlay:cc,scale:lc,setpts:pc,setsar:fc,trim:mc,text:yc};Object.entries(e).forEach((function(e){var t=p(e,2),i=t[0],n=t[1],r="".concat(gc).concat(i);tu[r]=new n({id:r})}))}();var Sc=function(e){return Vr(e)&&e.type===Je};function Ic(e){if(!Sc(e))throw new Error("expected VideoMedia")}var Cc=function(e){return zr(e)&&e.definition.type===Je};function Pc(e){if(!Cc(e))throw new Error("expected Video")}var xc="decode",Ac="encode",Mc="transcode",Dc="protocol",zc="language",Ec="filter",Vc="resolve",Rc=(v(E={},xc,{}),v(E,Ac,{}),v(E,Ec,{}),v(E,zc,{}),v(E,Dc,{}),v(E,Vc,{}),v(E,Mc,{}),E),Oc=function(e){return J(e)&&"type"in e&&ke(e.type)};function _c(e,t){Oc(e)||W(e,"Plugin",t)}var jc=function(e){return e.replace(/[^a-z]/g,"")},Nc=function(e,t){var i=Rc[e],n=jc(t),r=i[n];return _c(r,n),r},qc=function(e,t){var n=Rc[e],r=jc(t);return n[r]?Promise.resolve(n[r]):i(741)("./".concat(e,"-").concat(r)).then((function(){return Nc(e,t)}))},Bc="http",Uc="https",Lc="blob",Gc="file",Hc=function(e){return qc(Dc,e).then((function(e){return e}))},Wc=function(e){var t=e.endpoint;In(t),An(t)||(e.endpoint=un(t))},Jc=function(e){var t=e.endpoint;In(t);var i=t.pathname;return((void 0===i?"":i).split(".").pop()||"").trim()},Kc=function(e){var t=e.endpoint;In(t);var i=t.protocol;return Te(i),i},Xc=function(e){var t=e.response;return Kr(t)?Promise.resolve({data:t}):(Wc(e),$c(e).then((function(t){return t.promise(e,Be).then((function(t){return Qc(e,t),t}))})))},Yc=function(e){var t=e.response;return Yr(t)?Promise.resolve({data:t}):(Wc(e),$c(e).then((function(t){return t.promise(e,Le).then((function(t){return Qc(e,t),t}))})))},Zc=function(e){var t=e.response;return Wr(t)?Promise.resolve({data:t}):(Wc(e),$c(e).then((function(t){return t.promise(e,Ge).then((function(t){return Qc(e,t),t}))})))},$c=function(e){return Hc(Kc(e))},Qc=function(e,t){qe(t)||(e.response=t.data)},el=function(e){var t=e.response;return Gr(t)?Promise.resolve({data:t}):(Wc(e),$c(e).then((function(t){return t.promise(e,Je).then((function(t){return Qc(e,t),t}))})))},tl=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){var t=e.response;if(je(t))return Promise.resolve({data:t})}return Wc(e),$c(e).then((function(t){return t.promise(e,Ze).then((function(t){return Qc(e,t),t}))}))},il=function(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]){var t=e.response;if(Ne(t))return Promise.resolve({data:t})}return Wc(e),$c(e).then((function(t){return t.promise(e,$e).then((function(t){return Qc(e,t),t}))}))},nl=function(e,t){switch(t){case Be:return Xc(e);case Ge:return Zc(e);case Je:return el(e)}},rl=function(e,t){switch(t){case Be:case Ge:case Je:return nl(e,t);case Le:return Yc(e)}return G(V.Type)},al=function(e,t){return Wc(e),$c(e).then((function(i){return i.promise(e,t)}))};function ol(t){return function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];t=i.call.apply(i,[this].concat(a)),v(u(t),"_colorizeFilter",void 0),v(u(t),"colorMaximize",!1),v(u(t),"_div",void 0),v(u(t),"_opacityFilter",void 0),v(u(t),"_svgElement",void 0);var s=a[0];return u(t).container&&(t.addProperties(s,Lo({name:"x",type:e.DataType.Percent,defaultValue:.5,group:e.DataGroup.Point,tweenable:!0})),t.addProperties(s,Lo({name:"y",type:e.DataType.Percent,defaultValue:.5,group:e.DataGroup.Point,tweenable:!0})),Zt.forEach((function(i){t.addProperties(s,Lo({name:"off".concat(i),type:e.DataType.Boolean,group:e.DataGroup.Point}))})),t.addProperties(s,Lo({tweenable:!0,name:"opacity",type:e.DataType.Percent,defaultValue:1,group:e.DataGroup.Opacity}))),t}return f(n,[{key:"colorizeFilter",get:function(){return this._colorizeFilter||(this._colorizeFilter=wc("colorize"))}},{key:"colorizeCommandFilters",value:function(e){var t=e.contentColors,i=e.videoRate,n=e.filterInput,r=e.time;we(t);var a=De(r)?r.lengthSeconds:0,o=this.colorizeFilter,s={videoRate:i,duration:a,filterInput:n},u=p(t,2),c=u[0],l=u[1];return o.setValue(c,"color"),o.setValue(l,"color".concat(Cr)),o.commandFilters(s)}},{key:"stylesSrcPromise",value:function(e,t){var i=this.type,n=this.definition,r=[];if(i===Ge?r.push(i):r.push(We,Je),n.preferredTranscoding.apply(n,r).type===We)return Ic(n),n.loadedImagePromise(t,Xa(e)).then((function(e){return e.src}));var a=n.preferredTranscoding(Ge).request;return Zc(a).then((function(e){if(qe(e))return W(e.error);var t=e.data;return Jr(t),t.src}))}},{key:"stylesPromise",value:function(e,t){return this.stylesSrcPromise(e,t).then((function(t){var i=[];return i.push("mask-image: url(".concat(t,")")),i.push("mask-repeat: no-repeat"),i.push("mask-mode: luminance"),i.push("mask-size: ".concat(e.width,"px ").concat(e.height,"px")),i.push("mask-position: ".concat(e.x,"px ").concat(e.y,"px")),i}))}},{key:"containedVideo",value:function(e,t,i,n,r){var a=this,o=Math.round(Number(e.getAttribute("x"))),s=Math.round(Number(e.getAttribute("y"))),u=fs(t);u.x-=o,u.y-=s;var c=m(m({},u),Xa(t)),l=!this.definition.isVector;return(l?this.stylesPromise(c,this.definitionTime(n,r)):Promise.resolve([])).then((function(t){var n=[],r=a.div;if(t.push("left: ".concat(o,"px")),t.push("top: ".concat(s,"px")),!l){var u=a.pathElement(c);u.setAttribute("fill",er);var h=Wo(),f=globalThis.document.createElementNS(qi,"clipPath");Mu(f,h),Su(f,u);var d=gu(i);_u(d,[Cu([f])]),t.push("clip-path:".concat(hu(h))),n.push(d)}return r.setAttribute("style",t.join(";")+";"),_u(r,[e]),n.push(r),n}))}},{key:"previewItemsPromise",value:function(t,i,n,r,a,o){var s=this,u=t.contentPreviewItemPromise(i,r,a,o).then((function(u){if(K(u,"contentItem"),Gr(u))return Ce(o===e.Component.Player,"video in player"),s.containedVideo(u,i,n,r,a);var c=s.containerSvgItemPromise(i,r,a,o),l=!s.definition.isVector;return c.then((function(c){var h=[],f=!0,d=!t.definition.isVector;h.push(c);var p=Wo();if(l&&o===e.Component.Player){var v=mu(i,"","transparent",p);v.setAttribute("vector-effect","non-scaling-stroke;"),h.push(v),p=Wo()}c.setAttribute("id",p);var m=fu();Su(m,[mu(i,"","transparent"),u]);var y=[m];Du(m,"contained");var g=wu(void 0,m,f);h.push(g);var k=zu(p);g.appendChild(mu(n,"","black")),g.appendChild(k),l||(c.setAttribute("vector-effect","non-scaling-stroke;"),k.setAttribute("fill",er));var T=s.containerSvgFilter(c,n,i,r,a);T?h.push(T):c.removeAttribute("filter");var b=t.contentSvgFilter(u,n,i,r,a);b?h.push(b):u.removeAttribute("filter");var w=(d||l)&&o===e.Component.Player?s.svgElement:gu();return _u(w,[Cu(h)].concat(y)),du(w,n),[w]}))}));return u}},{key:"containerColorCommandFilters",value:function(e){var t=[],i=e.contentColors,r=e.containerRects,s=e.track;if(!this.colorMaximize)return a(o(n.prototype),"containerColorCommandFilters",this).call(this,e);we(i);var u=ks.apply(void 0,d(r))?r[0]:Es.apply(void 0,d(r)),c=m(m({},e),{},{outputSize:u});return t.push.apply(t,d(this.colorBackCommandFilters(c,"content-".concat(s)))),t}},{key:"containerCommandFilters",value:function(e,t){var i=[],n=e.contentColors,r=e.filterInput;return Te(r,"filterInput"),null!==n&&void 0!==n&&n.length||(i.push.apply(i,d(this.alphamergeCommandFilters(m(m({},e),{},{filterInput:r})))),r=Qi(Qi(i).outputs)),i.push.apply(i,d(this.containerFinalCommandFilters(m(m({},e),{},{filterInput:r})))),i}},{key:"containerFinalCommandFilters",value:function(e){var t=[],i=e.filterInput;Te(i,"filterInput");var n=this.opacityCommandFilters(e);return n.length&&(t.push.apply(t,d(n)),i=Qi(Qi(n).outputs)),t.push.apply(t,d(this.translateCommandFilters(m(m({},e),{},{filterInput:i})))),t}},{key:"containerRects",value:function(e,t){var i=e.size,n=e.time,r=e.timeRange,a=this.lock,o=this.tweenRects(n,r),s=Ws(o,a),u=t.width,c=t.height,l=(u||i.width)/(c||i.height),h=p(s,2),f=h[0],d=h[1],v=Js(f,i,l,a),m=this.directionObject,y=Us(i,v,m);if(ks(f,d))return[y,y];var g=Js(d,i,l,a),k=Ns(v,g);return[y,Us(i,k,m)]}},{key:"containerSvgItemPromise",value:function(e,t,i,n){return Promise.resolve(this.pathElement(e))}},{key:"containerSvgFilter",value:function(e,t,i,n,r){var a=this.tweenValues("opacity",n,r),o=p(a,1)[0];if(de(o)){var s=this.opacityFilter;return s.setValue(o,"opacity"),xu(s.filterSvgFilter(),e)}}},{key:"directions",get:function(){return ti}},{key:"directionObject",get:function(){var e=this;return Object.fromEntries(Zt.map((function(t){return[t,!!e.value("off".concat(t))]})))}},{key:"div",get:function(){return this._div||(this._div=globalThis.document.createElement("div"))}},{key:"isDefault",get:function(){return this.mediaId===Yo}},{key:"opacityCommandFilters",value:function(e){var t=e.outputSize,i=e.filterInput,n=e.clipTime,r=e.time,a=e.videoRate;ze(n);var o=[],s={dimensions:t,filterInput:i,videoRate:a,duration:De(r)?r.lengthSeconds:0},u=this.tweenValues("opacity",r,n),c=p(u,2),l=c[0],h=c[1];if(de(l)||re(h)&&de(h)){var f=this.opacityFilter;f.setValues({opacity:l,opacityEnd:h}),o.push.apply(o,d(f.commandFilters(s)))}return o}},{key:"opacityFilter",get:function(){return this._opacityFilter||(this._opacityFilter=wc("opacity"))}},{key:"pathElement",value:function(e){return mu(e,"",arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none")}},{key:"svgElement",get:function(){return this._svgElement||(this._svgElement=gu())}},{key:"translateCommandFilters",value:function(e){var t=[],i=e.outputSize,n=e.time,r=e.containerRects,a=e.chainInput,o=e.filterInput,s=e.videoRate;if(!a)return t;we(r);var u=p(r,2),c=u[0],l=u[1],h=De(n)?n.lengthSeconds:0,f=this.overlayFilter;f.setValue(c.x,"x"),f.setValue(c.y,"y"),h&&(f.setValue(l.x,"x".concat(Cr)),f.setValue(l.y,"y".concat(Cr)));var v={dimensions:i,filterInput:o,videoRate:s,duration:h,chainInput:a};return t.push.apply(t,d(f.commandFilters(v))),t}}]),n}(t)}var sl=function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=i.call.apply(i,[this].concat(a)),v(u(t),"selectType",e.SelectType.None),t}return f(n,[{key:"commandFiles",value:function(e){var t=this,i=[],n=e.videoRate,r=e.time,a=De(r)?r.lengthSeconds:0,o=this.definition.filters,s=m(m({},e),{},{videoRate:n,duration:a});return i.push.apply(i,d(o.flatMap((function(e){return t.setFilterValues(e),e.commandFiles(s)})))),i}},{key:"commandFilters",value:function(e){var t=this,i=[],n=e.videoRate,r=e.filterInput,a=e.time;Te(r);var o=De(a)?a.lengthSeconds:0,s=this.definition.filters,u={videoRate:n,duration:o,filterInput:r};return i.push.apply(i,d(s.flatMap((function(e){t.setFilterValues(e);var i=e.commandFilters(u);return i.length&&(u.filterInput=Qi(Qi(i).outputs)),i})))),i}},{key:"selectables",value:function(){return[this]}},{key:"selectedItems",value:function(t){var i=this;return this.properties.map((function(n){var r=i.value(n.name);return{value:r,selectType:e.SelectType.None,property:n,changeHandler:function(e,n){Te(e);var a={target:i,property:e,redoValue:n,undoValue:r};t.create(a)}}}))}},{key:"setFilterValues",value:function(e){var t=this,i=e.properties.map((function(e){return e.name}));this.properties.map((function(e){return e.name})).filter((function(e){return i.includes(e)})).forEach((function(i){var n=t.properties.find((function(e){return e.name===i}));qo(n);var r=n.tweenable;if(e.setValue(t.value(i),i),r){var a="".concat(i).concat(Cr);e.setValue(t.value(a),a)}}))}},{key:"svgFilters",value:function(e,t,i,n){var r=this,a=[],o=this.definition.filters;return a.push.apply(a,d(o.flatMap((function(e){return r.setFilterValues(e),e.filterSvgFilter()})))),a}}]),n}(ol(Fc(Qs)));function ul(t){return function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(t=i.call.apply(i,[this].concat(a))).properties.push(Lo({name:"muted",type:e.DataType.Boolean})),t}return f(n,[{key:"graphFiles",value:function(e){return[]}},{key:"loadPromise",value:function(e){return Promise.resolve()}}]),n}(t)}var cl=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this,e),v(u(n),"kind",""),v(u(n),"purpose","");var r=e.purpose;return r&&(n.purpose=r),rt(n.type),n}return f(i,[{key:"toJSON",value:function(){var e=this.type,t=this.kind;return m(m({},a(o(i.prototype),"toJSON",this).call(this)),{},{type:e,kind:t})}},{key:"unload",value:function(){delete this.request.response}}]),i}(Ar),ll=function(e){return new cl(e)},hl=f((function e(t){h(this,e),v(this,"data",void 0),v(this,"type",void 0);var i=t.data,n=t.type;this.type=n,this.data=i})),fl=function(e){return new hl(e)},dl=function(t){c(n,t);var i=l(n);function n(t){var r,a,o;h(this,n),o=i.call(this,t),v(u(o),"file",void 0),v(u(o),"isVector",!1),v(u(o),"transcodings",[]),v(u(o),"properties",[]),v(u(o),"decodings",[]),v(u(o),"serverPath","");var s=t.decodings,c=t.transcodings,l=t.file;l&&(o.file=l),s&&(r=o.decodings).push.apply(r,d(s.map(fl))),c&&(a=o.transcodings).push.apply(a,d(c.map(ll)));var f=u(o).type;return tt(f),o.properties.push(Lo({name:"label",type:e.DataType.String,defaultValue:Io[f].label})),o}return f(n,[{key:"unload",value:function(){throw new Error("Method not implemented.")}},{key:"definitionIcon",value:function(e){}},{key:"findTranscoding",value:function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return this.transcodings.find((function(t){return t.type===e&&(!i.length||i.includes(t.kind))}))}},{key:"instanceFromObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Qs(this.instanceArgs(e))}},{key:"instanceArgs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.fromEntries(this.properties.map((function(e){return[e.name,e.defaultValue]})));return m(m(m({},t),e),{},{definition:this})}},{key:"loadPromise",value:function(e){return W(V.Unimplemented)}},{key:"preferredTranscoding",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];for(var r=function(){var t=o[a],i=e.transcodings.find((function(e){return e.type===t}));if(i)return{v:i}},a=0,o=i;a<o.length;a++){var s=r();if("object"===typeof s)return s.v}return this}},{key:"serverPromise",value:function(e){var t=this;if(this.serverPath)return Promise.resolve();var i=this.request;return al(i).then((function(e){if(!qe(e)){var i=e.path;t.serverPath=i}}))}},{key:"toJSON",value:function(){var e=this.label,t=this.decodings,i=this.transcodings;return m(m({},a(o(n.prototype),"toJSON",this).call(this)),{},{label:e,decodings:t,transcodings:i})}}]),n}(Ar);function pl(t){return function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return t=i.call.apply(i,[this].concat(a)),v(u(t),"type",Ge),t.properties.push(Lo({name:"lock",type:e.DataType.String,defaultValue:e.Orientation.H,group:e.DataGroup.Size})),t}return f(n,[{key:"loadPromise",value:function(e){return Promise.resolve()}}]),n}(t)}var vl=function(e){c(i,e);var t=l(i);function i(e){var n,r,a;h(this,i),a=t.call(this,e),v(u(a),"filters",[]),v(u(a),"finalizeFilter",void 0),v(u(a),"initializeFilter",void 0),v(u(a),"type",Ue),a.properties.push(Lo({name:"label",defaultValue:""}));var o=e.properties,s=e.filters,c=e.initializeFilter,l=e.finalizeFilter;return null!==o&&void 0!==o&&o.length&&(n=a.properties).push.apply(n,d(o.map((function(e){return Lo(m(m({},e),{},{custom:!0}))})))),c&&(a.initializeFilter=bc(c)),l&&(a.finalizeFilter=bc(l)),s&&(r=a.filters).push.apply(r,d(s.map((function(e){return bc(e)})))),a}return f(i,[{key:"instanceArgs",value:function(e){var t=a(o(i.prototype),"instanceArgs",this).call(this,e);return t.label||(t.label=this.label),t}},{key:"instanceFromObject",value:function(e){return new sl(this.instanceArgs(e))}},{key:"toJSON",value:function(){var e=a(o(i.prototype),"toJSON",this).call(this),t=this.properties.filter((function(e){return e.custom}));return t.length&&(e.properties=t),this.filters.length&&(e.filters=this.filters),e}}]),i}(pl(ul(dl))),ml={label:"Blur",type:"effect",id:"com.moviemasher.effect.blur",request:{response:{filters:[{id:"com.moviemasher.filter.convolution",parameters:[{name:"matrix",value:"1,1,1,1,1,1,1,1,1"},{name:"multiplier",value:"0.11"}]}]}}},yl=function(e){return Te(e.id),new vl(m(m({},e),{},{type:Ue}))},gl=function(e){var t=Nr[Ue].find((function(t){return t.id===e}));return t||yl({id:e})},kl=function(e){var t=e.mediaId;return gl(void 0===t?"":t).instanceFromObject(e)},Tl=function(e){return gl(e).instanceFromObject()};_r[Ue]=yl,Nr[Ue].push(yl(ml));var bl=function(e){return rs(e)&&wl(e.definition)},wl=function(e){return Vr(e)&&e.type===Be};function Fl(t){return function(t){c(n,t);var i=l(n);function n(){var t,r;h(this,n);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];r=i.call.apply(i,[this].concat(o)),v(u(r),"effects",[]);var c=o[0],l=u(r),f=l.isDefaultOrAudio,p=l.container;f||p||(r.addProperties(c,Lo({name:"x",type:e.DataType.Percent,defaultValue:.5,group:e.DataGroup.Point,tweenable:!0})),r.addProperties(c,Lo({name:"y",type:e.DataType.Percent,defaultValue:.5,group:e.DataGroup.Point,tweenable:!0})),r.addProperties(c,Lo({name:"lock",type:e.DataType.String,defaultValue:e.Orientation.H,group:e.DataGroup.Size})));var m=c.effects;return m&&(t=r.effects).push.apply(t,d(m.map(kl))),r}return f(n,[{key:"audibleCommandFiles",value:function(e){var t=m(m({},e),{},{audible:!0,visible:!1});return this.fileCommandFiles(t)}},{key:"audibleCommandFilters",value:function(e){var t=[],i=e.time,n=e.quantize,r=e.commandFiles,a=e.clipTime,o=i.isRange?i.lengthSeconds:0,s=o?Math.min(o,a.lengthSeconds):0,u=this.id,c=$s(r,u,!1),l="atrim",h=Jo(l),f={},p=this.definitionTime(i,a).frame;s&&(f.duration=s),p&&(f.start=fo(p,n).seconds);var v={inputs:[c],ffmpegFilter:l,options:f,outputs:[h]};t.push(v),c=h;var y=1e3*(a.seconds-i.seconds);if(y){var g="adelay",k=Jo(g),T={ffmpegFilter:g,options:{delays:y,all:1},inputs:[c],outputs:[k]};t.push(T),c=k}return t.push.apply(t,d(this.amixCommandFilters(m(m({},e),{},{filterInput:c})))),t}},{key:"contentCommandFilters",value:function(e,t){return this.effectsCommandFilters(e)}},{key:"contentPreviewItemPromise",value:function(e,t,i,n){return this.contentSvgItemPromise(e,t,i,n)}},{key:"contentRects",value:function(e){var t=e.containerRects,i=e.time,n=e.timeRange,r=e.loading,a=e.editing,o=me(t)?t:[t,t];if(r&&!this.intrinsicsKnown({editing:a,size:!0}))return o;var s=this.intrinsicRect(a);if(!Ga(s))return o;var u=this.lock,c=this.tweenRects(i,n),l=Ws(c,u),h=Ls(s,t,l),f=p(h,2),d=f[0],v=f[1],m=Gs(h,t,l),y=p(m,2),g=y[0],k=y[1];return[bs(d,g),bs(v,k)]}},{key:"contentSvgFilter",value:function(e,t,i,n,r){var a=this.effects;if(!this.isDefaultOrAudio&&a.length){var o=this.effects.flatMap((function(e){return e.svgFilters(t,i,n,r)})),s=xu(o,e);return Mu(s,"200%","width"),Mu(s,"200%","height"),s}}},{key:"definitionIds",value:function(){return[].concat(d(a(o(n.prototype),"definitionIds",this).call(this)),d(this.effects.flatMap((function(e){return e.definitionIds()}))))}},{key:"effectsCommandFiles",value:function(e){var t=[];return this.container||t.push.apply(t,d(this.effects.flatMap((function(t){return t.commandFiles(e)})))),t}},{key:"effectsCommandFilters",value:function(e){var t=[],i=e.filterInput;Te(i);var n=this.effects;return this.isDefaultOrAudio||t.push.apply(t,d(n.flatMap((function(t){var n=t.commandFilters(m(m({},e),{},{filterInput:i}));return n.length&&(i=Qi(Qi(n).outputs)),n})))),t}},{key:"intrinsicRect",value:function(){return Ts}},{key:"isDefault",get:function(){return this.mediaId===ns}},{key:"isDefaultOrAudio",get:function(){return this.isDefault||bl(this)}},{key:"contentSvgItemPromise",value:function(e,t,i,n){return W(V.Unimplemented)}},{key:"selectedItems",value:function(e){var t=a(o(n.prototype),"selectedItems",this).call(this,e);if(this.isDefaultOrAudio||this.container)return t;var i=this.effects,r=this.selectType,s=e.editor,u={name:"effects",selectType:r,value:i,removeHandler:s.removeEffect.bind(s),moveHandler:s.moveEffect.bind(s),addHandler:s.addEffect.bind(s)};return t.push(u),t}},{key:"selectedProperty",value:function(e){switch(e.name){case"effects":case"lock":case"width":case"height":case"x":case"y":return!this.isDefaultOrAudio}return a(o(n.prototype),"selectedProperty",this).call(this,e)}},{key:"toJSON",value:function(){var e=a(o(n.prototype),"toJSON",this).call(this);return e.effects=this.effects,e}},{key:"visibleCommandFiles",value:function(e){var t=a(o(n.prototype),"visibleCommandFiles",this).call(this,e);return t.push.apply(t,d(this.effectsCommandFiles(e))),t}}]),n}(t)}var Sl=function(e){return rs(e)&&"color"in e},Il=function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];t=i.call.apply(i,[this].concat(a)),v(u(t),"_colorFilter",void 0);var s=a[0];return t.addProperties(s,Lo({tweenable:!0,name:"color",type:e.DataType.Rgb,defaultValue:t.definition.color,group:e.DataGroup.Color})),t}return f(n,[{key:"colorFilter",get:function(){return this._colorFilter||(this._colorFilter=wc("color"))}},{key:"contentColors",value:function(e,t){var i=this.tweenValues("color",e,t),n=p(i,2),r=n[0],a=n[1];return Te(r),[r,ke(a)?a:r]}},{key:"contentPreviewItemPromise",value:function(e,t,i,n){var r=this.colorFilter,a=this.tweenValues("color",t,i),o=p(a,1)[0],s=e.x,u=e.y,c=e.width,l=e.height;r.setValues({width:c,height:l,color:o});var h=r.filterSvgs(),f=p(h,1)[0];return f.setAttribute("x",String(s)),f.setAttribute("y",String(u)),Promise.resolve(f)}}]),n}(Fl(Fc(Qs))),Cl="M136.5 77.7l37 67L32 285.7 216.4 464l152.4-148.6 54.4-11.4L166.4 48l-29.9 29.7zm184 208H114.9l102.8-102.3 102.8 102.3zM423.3 304s-56.7 61.5-56.7 92.1c0 30.7 25.4 55.5 56.7 55.5 31.3 0 56.7-24.9 56.7-55.5S423.3 304 423.3 304z",Pl=512,xl=function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=r[0];e=t.call(this,o),v(u(e),"color",Qn);var s=o.color;return ke(s)&&(e.color=s),e}return f(i,[{key:"definitionIcon",value:function(e){var t={width:Pl,height:Pl},i=La(t,e,!0),n=m(m({},i),Is(e,i)),r=bu(Cl);return Ru(r,t,n),Promise.resolve(gu(e,r))}},{key:"instanceFromObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Il(this.instanceArgs(e))}}]),i}(ss(ul(dl))),Al=function(e,t){return e&&t?io(e/t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"round"):0},Ml=function(e){e.preventDefault(),e.stopPropagation()},Dl=8,zl=2,El=function(){function t(e){h(this,t),v(this,"args",void 0),v(this,"_rect",void 0),v(this,"_timeRange",void 0),this.args=e}return f(t,[{key:"clip",get:function(){return this.args.clip}},{key:"container",get:function(){return this.clip.container}},{key:"editingSvgItem",value:function(e,t){var i=this.container,n=this.rect,r=i.pathElement(n);return r.setAttribute("vector-effect","non-scaling-stroke"),Du(r,e),t||r.addEventListener("pointerdown",this.pointerDownHandler()),r}},{key:"editor",get:function(){return this.preview.editor}},{key:"icon",get:function(){return!!this.args.icon}},{key:"pointerDownHandler",value:function(){var t=m({},hs),i=this.editor,n=this.container,r=this.timeRange,a=this.rect,o=this.clip,s=i.rect,u=function(){globalThis.window.removeEventListener("pointermove",h),globalThis.window.removeEventListener("pointermove",l),globalThis.window.removeEventListener("pointerup",c),globalThis.window.removeEventListener("pointerup",f)},c=function(e){Ml(e),u(),i.dragging=!1,i.redraw()},l=function(o){var u,c;Ml(o);var l=n.offE,h=n.offN,f=n.offS,d=n.offW,p=a.x,m=a.y,y=a.width,g=a.height,k=s.width-y,T=s.height-g,b=0,w=0;l&&(b-=y,k+=y),d&&(k+=y),h&&(w-=g,T+=g),f&&(T+=g);var F=o.clientX,S=o.clientY,I=F-s.x,C=S-s.y,P=t.x-s.x,x=C-(t.y-s.y-m),A=Xs(I-(P-p),b,b+k),M=Xs(x,w,w+T),D=Ks(n),z=r.lastTime,E=i.time.equalsTime(z),V=D&&E,R=V?"x".concat(Cr):"x",O=V?"y".concat(Cr):"y",_=(v(u={},R,n.value(R)),v(u,O,n.value(O)),u),j=(v(c={},R,k?A/k:_[R]),v(c,O,T?M/T:_[O]),c),N={property:e.DataGroup.Point,target:n,type:e.ActionType.ChangeMultiple,redoValues:j,undoValues:_};i.actions.create(N)},h=function e(a){Ml(a);var o=a.clientX,s=a.clientY;if(!ls({x:o,y:s},t)){if(Ks(n)){var c=i.time,h=c.closest(r);if(!c.equalsTime(h))return u(),void i.goToTime(h)}i.dragging=!0,globalThis.window.removeEventListener("pointermove",e),globalThis.window.addEventListener("pointermove",l),l(a)}},f=function(e){if(Ml(e),e instanceof PointerEvent){var n=e.clientX,r=e.clientY;t.x=n,t.y=r,globalThis.window.addEventListener("pointermove",h),globalThis.window.addEventListener("pointerup",c),i.selection.clip!==o&&i.selection.set(o)}};return f}},{key:"preview",get:function(){return this.args.preview}},{key:"quantize",get:function(){return this.preview.quantize}},{key:"rect",get:function(){return this._rect||this.rectInitialize}},{key:"rectInitialize",get:function(){var e=this.time,t=this.timeRange,i=this.clip,n=this.size;Ha(n,"".concat(this.constructor.name,".rectInitialize size"));var r={size:n,time:e,timeRange:t,editing:!0},a=i.rects(r);return Ce(ks.apply(void 0,d(a))),a[0]}},{key:"size",get:function(){return this.preview.size}},{key:"svgBoundsElement",value:function(e,t,i){var n=this,r=[],a=Dl,o=zl,s=o/2,u=this.rect,c=this.container.directions,l=u.width,h=u.height,f=u.x,p=u.y,v={x:f-s,y:p-s,width:l,height:o};r.push(mu(v,e)),v.y=p+h-s,r.push(mu(v,e)),v.x=f+l-s,v.height=h,v.width=o,v.y=p,r.push(mu(v,e)),v.x=f-s,r.push(mu(v,e));var m={width:l,height:h};return c.forEach((function(e){var o=n.svgHandlePoint(m,e),s={x:f+o.x,y:p+o.y,width:a,height:a},u=mu(s,[].concat(d(t),[e.toLowerCase()]));r.push(u),i||u.addEventListener("pointerdown",(function(e){n.editor.selection.set(n.clip),Ml(e)}))})),r}},{key:"svgHandlePoint",value:function(t,i){var n=Dl/2,r=t.width,a=t.height,o=m({},hs),s=String(i).split(""),u=p(s,2),c=u[0],l=u[1];Qt(c,i);var h=l||c;switch(Qt(h),h){case e.Direction.W:o.x=-n;break;case e.Direction.E:o.x=r-n;break;default:o.x=Math.round(r/2)-n}switch(c){case e.Direction.N:o.y=-n;break;case e.Direction.S:o.y=a-n;break;default:o.y=Math.round(a/2)-n}return o}},{key:"time",get:function(){return this.preview.time}},{key:"timeRange",get:function(){return this._timeRange||(this._timeRange=this.clip.timeRange(this.quantize))}}]),t}(),Vl=function(){function t(e){h(this,t),v(this,"audible",!1),v(this,"clip",void 0),v(this,"_clips",void 0),v(this,"combine",!1),v(this,"editor",void 0),v(this,"mash",void 0),v(this,"size",void 0),v(this,"selectedClip",void 0),v(this,"streaming",!1),v(this,"_svgItems",void 0),v(this,"time",void 0),v(this,"_trackPreviews",void 0),v(this,"visible",!0);var i=e.selectedClip,n=e.editor,r=e.time,a=e.mash,o=e.clip,s=e.size;this.mash=a,this.size=s||a.imageSize,this.time=r,this.selectedClip=i,this.clip=o,J(n)&&(this.editor=n)}return f(t,[{key:"clips",get:function(){return this._clips||(this._clips=this.clipsInitialize)}},{key:"clipsInitialize",get:function(){var t=this.mash,i=this.time,n=this.clip;return n?[n]:t.clipsInTimeOfType(i,e.AVType.Video).sort(Vo)}},{key:"duration",get:function(){return this.time.lengthSeconds}},{key:"editing",get:function(){return J(this.editor)}},{key:"intrinsicSizePromise",get:function(){var e=this.clips,t=this.time,i=this.quantize,n={editing:!0,size:!0},r=e.filter((function(e){return!e.intrinsicsKnown(n)})),a={quantize:i,editing:!0,visible:!0,time:t,clipTime:lo(t)},o=r.map((function(e){return a.clipTime=e.timeRange(i),e.loadPromise(a)}));return Promise.all(o).then(Ni)}},{key:"previewItemsPromise",get:function(){var t=this;return this._svgItems?Promise.resolve(this._svgItems):this.intrinsicSizePromise.then((function(){var i=t.clips,n=t.size,r=t.time,a=t.clip,o=Promise.resolve([]),s=a?e.Component.Timeline:e.Component.Player;return i.forEach((function(e){o=o.then((function(t){return e.previewItemsPromise(n,r,s).then((function(e){return[].concat(d(t),d(e))}))}))})),o})).then((function(e){return t._svgItems=e.length?t.tupleItems(e):[]}))}},{key:"quantize",get:function(){return this.mash.quantize}},{key:"svgItemsPromise",get:function(){return this.previewItemsPromise}},{key:"trackPreviews",get:function(){return this._trackPreviews||(this._trackPreviews=this.trackPreviewsInitialize)}},{key:"trackPreviewsInitialize",get:function(){var e=this,t=[],i=this.time,n=this.quantize,r=this.clips,a=i.isRange?void 0:i.scale(n);return r.forEach((function(r){var o=r.timeRange(n).scale(i.fps),s=Math.max(0,i.frame-o.frame),u=o.withFrame(s),c={clip:r,preview:e,tweenTime:a,timeRange:u,icon:!!e.clip};t.push(new El(c))})),t}},{key:"tupleItems",value:function(e){var t=this.size,i=this.editing,n=this.selectedClip,r=this.editor,a=d(e),o="track";if(a.forEach((function(e){return Du(e,o)})),!i||!e.length)return a;K(r,"editor");var s=r.dragging,u=this.trackPreviews,c=u.find((function(e){return e.clip===n})),l=u.map((function(e){var t=["outline"];return s||e===c||t.push("animate"),e.editingSvgItem(t)})),h=["outlines"],f=gu(t,l);if(Du(f,h),a.push(f),!c)return a;var p=["bounds","back"],v=["line"],m=["handle"],y=gu(t,c.svgBoundsElement(v,m,!0));Du(y,p),p[1]="fore";var g=gu(t,c.svgBoundsElement(v,m));return Du(g,p),a.push(y,g),a}}]),t}(),Rl=function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];t=i.call.apply(i,[this].concat(a)),v(u(t),"_containerObject",{}),v(u(t),"_container",void 0),v(u(t),"_contentObject",{}),v(u(t),"_content",void 0),v(u(t),"_id",void 0),v(u(t),"_label",""),v(u(t),"selectType",e.SelectType.Clip),v(u(t),"_track",void 0),t.properties.push(Lo({name:"containerId",type:e.DataType.ContainerId,defaultValue:Yo})),t.properties.push(Lo({name:"contentId",type:e.DataType.ContentId,defaultValue:ns})),t.properties.push(Lo({name:"label",type:e.DataType.String})),t.properties.push(Lo({name:"sizing",type:e.DataType.Option,defaultValue:e.Sizing.Content,options:yi})),t.properties.push(Lo({name:"timing",type:e.DataType.Option,defaultValue:e.Timing.Content,group:e.DataGroup.Timing,options:vi})),t.properties.push(Lo({name:"frame",type:e.DataType.Frame,group:e.DataGroup.Timing,defaultValue:e.Duration.None,min:0,step:1})),t.properties.push(Lo({name:"frames",type:e.DataType.Frame,defaultValue:e.Duration.Unknown,min:1,step:1,group:e.DataGroup.Timing}));var s=a[0];t.propertiesInitialize(s);var c=s.container,l=s.content;return c&&(t._containerObject=c),l&&(t._contentObject=l),t}return f(n,[{key:"assureTimingAndSizing",value:function(t,i,n){var r=this.timing,a=this.sizing,o=this.containerId,s=r!==t,u=a!==i;return s||(s=n.hasIntrinsicTiming),u||(u=n.hasIntrinsicSizing),s||(t===e.Timing.Content&&o?this.timing=e.Timing.Container:this.timing=e.Timing.Custom),u||(i===e.Sizing.Content&&o?this.sizing=e.Sizing.Container:this.sizing=e.Sizing.Preview),!(u&&s)}},{key:"audible",get:function(){return this.mutable}},{key:"clipIcon",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(this.container){var n=this.track,r=n.mash,a=r.quantize,o=r.imageSize;Ha(o,"track.mash.imageSize");var s=ja(La(o,e,!0));Ha(s,"".concat(this.constructor.name,".clipIcon containedSize"));for(var u=s.width+i,c=Math.ceil(e.width/u),l=this.timeRange(a),h=l.startTime,f=[],p=n.mash,v=0,y=0;y<c;y++){var g=h.copy,k=new Vl({mash:p,time:g,clip:this,size:s});f.push(k),v+=u,h.frame=l.frame+Al(v,t,"floor")}var T=Promise.resolve([]);return f.forEach((function(e){T=T.then((function(t){return e.svgItemsPromise.then((function(e){return[].concat(d(t),d(e))}))}))})),T.then((function(t){var i=m({},hs),n=gu(e);return t.forEach((function(e){du(e,i),Su(n,e),i.x+=u})),n}))}}},{key:"clipCommandFiles",value:function(e){var t=[],i=e.visible,n=e.quantize,r=e.outputSize,a=e.time,o=this.timeRange(n),s=this.content,u=this.container,c=m(m({},e),{},{clipTime:o});if(i){Ha(r,"outputSize"),is(u);var l={size:r,time:a,timeRange:o,loading:!0},h=this.rects(l),f=Sl(s)?s.contentColors(a,o):void 0,p=m(m({},c),{},{outputSize:r,contentColors:f,containerRects:h});if(!f){var v=s.visibleCommandFiles(p);t.push.apply(t,d(v))}var y=u.visibleCommandFiles(p);t.push.apply(t,d(y))}else Ce(!i,"outputSize && container"),t.push.apply(t,d(this.content.audibleCommandFiles(c)));return t}},{key:"commandFilters",value:function(e){var t=[],i=e.visible,n=e.quantize,r=e.outputSize,a=e.time,o=this.timeRange(n),s=m(m({},e),{},{clipTime:o}),u=this.content,c=this.container;if(!i)return this.content.audibleCommandFilters(s);Ha(r,"outputSize"),is(c);var l={size:r,time:a,timeRange:o},h=this.rects(l);s.containerRects=h;var f={point:!ls.apply(void 0,d(h)),size:!Ra.apply(void 0,d(h))},p=Sl(u)?u.contentColors(a,o):void 0,v=be(p);v&&(f.color=p[0]!==p[1],f.canColor=f.color?c.canColorTween(e):c.canColor(e));var y=a.isRange?a.lengthSeconds:0,g=y?Math.min(y,o.lengthSeconds):0,k=m(m({},s),{},{contentColors:p,outputSize:r,containerRects:h,duration:g});return v?f.canColor||(t.push.apply(t,d(c.containerColorCommandFilters(k))),k.filterInput=Qi(Qi(t).outputs)):(t.push.apply(t,d(u.commandFilters(k,f))),k.filterInput=Qi(Qi(t).outputs)),t.push.apply(t,d(c.commandFilters(k,f,!0))),t}},{key:"container",get:function(){return this._container||this.containerInitialize(this._containerObject)}},{key:"containerInitialize",value:function(t){var i=this.containerId,n=this.track.mash.media,r=i||t.mediaId;if(ke(r)){var a=n.fromId(r),o=m(m({},t),{},{mediaId:r,container:!0}),s=a.instanceFromObject(o);return is(s),this.assureTimingAndSizing(e.Timing.Container,e.Sizing.Container,s),s.clip=this,this.timing===e.Timing.Container&&this._track&&this.resetTiming(s),this._container=s}}},{key:"content",get:function(){return this._content||this.contentInitialize(this._contentObject)}},{key:"contentInitialize",value:function(t){var i=this.contentId,n=this.track.mash.media,r=i||t.mediaId;Te(r);var a=n.fromId(r),o=m(m({},t),{},{mediaId:r}),s=a.instanceFromObject(o);if(as(s),this.assureTimingAndSizing(e.Timing.Content,e.Sizing.Content,s)){var u=this.container;u&&this.assureTimingAndSizing(e.Timing.Container,e.Sizing.Container,u)}return s.clip=this,this.timing===e.Timing.Content&&this._track&&this.resetTiming(s),this._content=s}},{key:"definitionIds",value:function(){var e=this.content.definitionIds();return this.container&&e.push.apply(e,d(this.container.definitionIds())),e}},{key:"endFrame",get:function(){return this.frame+this.frames}},{key:"endTime",value:function(e){return fo(this.endFrame,e)}},{key:"intrinsicsKnown",value:function(e){var t=this.content,i=this.container,n=t.intrinsicsKnown(e);return i&&n&&(n=i.intrinsicsKnown(e)),n}},{key:"intrinsicGraphFiles",value:function(e){var t=this.content,i=this.container,n=[];return t.intrinsicsKnown(e)||n.push(t.intrinsicGraphFile(e)),i&&!i.intrinsicsKnown(e)&&n.push(i.intrinsicGraphFile(e)),n}},{key:"id",get:function(){return this._id||(this._id=Wo())}},{key:"label",get:function(){return this._label},set:function(e){this._label=e}},{key:"loadPromise",value:function(e){var t=e.quantize,i=this.content,n=this.container,r=this.frames;pe(r)&&(e.clipTime||(e.clipTime=this.timeRange(t)));var a=[i.loadPromise(e)];return n&&a.push(n.loadPromise(e)),Promise.all(a).then(Ni)}},{key:"maxFrames",value:function(e,t){return 0}},{key:"mutable",get:function(){if(this.content.mutable())return!0;var e=this.container;return!!e&&e.mutable()}},{key:"notMuted",get:function(){var e=this.content;if(this.muted)return!1;if(e.mutable()&&!e.muted)return!0;var t=this.container;return null===t||void 0===t||!t.mutable()||!t.muted}},{key:"previewItemsPromise",value:function(e,t,i){Ha(e,"previewItemsPromise");var n=this.timeRange(this.track.mash.quantize),r=this.container,a=this.content;is(r);var o={size:e,time:t,timeRange:n,editing:!0},s=this.rects(o);Ce(ks.apply(void 0,d(s)));var u=p(s,1)[0];return r.previewItemsPromise(a,u,e,t,n,i)}},{key:"rectIntrinsic",value:function(t,i,n){var r=m(m({},t),hs),a=this.sizing;if(a===e.Sizing.Preview)return r;var o=a===e.Sizing.Container?this.container:this.content;mo(o);var s=o.intrinsicsKnown({editing:n,size:!0});return i&&!s?r:(Ce(s,"intrinsicsKnown"),o.intrinsicRect(n))}},{key:"rects",value:function(e){var t=e.size,i=e.loading,n=e.editing,r=this.rectIntrinsic(t,i,n),a=this.container;return is(a),a.containerRects(e,r)}},{key:"resetTiming",value:function(t,i){var n=this.timing,r=this._track;switch(n){case e.Timing.Custom:if(pe(this.frames))break;this.frames=Io.duration*(i||r.mash.quantize);break;case e.Timing.Container:var a=ts(t)?t:this.container;if(!a)break;this.frames=a.frames(i||r.mash.quantize);break;case e.Timing.Content:var o=rs(t)?t:this.content;if(!o)break;this.frames=o.frames(i||r.mash.quantize)}}},{key:"selectables",value:function(){return[this].concat(d(this.track.selectables()))}},{key:"selectedItems",value:function(t){var i=this,n=[];return this.properties.filter((function(e){return i.selectedProperty(e)})).forEach((function(r){var a=r.name,o="frames"===a||"frame"===a,s=i.value(a);n.push({value:s,selectType:e.SelectType.Clip,property:r,changeHandler:function(n,r){Te(n);var a={property:n,target:i,redoValue:r,undoValue:s,type:o?e.ActionType.ChangeFrame:e.ActionType.Change};t.create(a)}})})),n}},{key:"selectedProperty",value:function(t){var i=t.name;switch(t.type){case e.DataType.ContainerId:case e.DataType.ContentId:return!1}switch(i){case"sizing":return!bl(this.content);case"timing":var n;if(this.content.hasIntrinsicTiming)break;return!(null===(n=this.container)||void 0===n||!n.hasIntrinsicSizing);case"frame":return!this.track.dense;case"frames":return this.timing===e.Timing.Custom}return!0}},{key:"serverPromise",value:function(e){var t=this.content,i=this.container,n=[t.serverPromise(e)];return i&&n.push(i.serverPromise(e)),Promise.all(n).then(Ni)}},{key:"setValue",value:function(e,t,i){switch(a(o(n.prototype),"setValue",this).call(this,e,t,i),t){case"containerId":var r;this._containerObject=(null===(r=this._container)||void 0===r?void 0:r.toJSON())||{},delete this._container;break;case"contentId":var s;this._contentObject=(null===(s=this._content)||void 0===s?void 0:s.toJSON())||{},delete this._content}}},{key:"time",value:function(e){return fo(this.frame,e)}},{key:"timeRange",value:function(e){var t=this.frame,i=this.frames;return fe(t,"timeRange frame"),ve(i,"timeRange frames"),uo(this.frame,e,this.frames)}},{key:"timeRangeRelative",value:function(e,t){var i=this.timeRange(t).scale(e.fps),n=Math.max(0,e.frame-i.frame);return e.withFrame(n)}},{key:"toJSON",value:function(){var e=a(o(n.prototype),"toJSON",this).call(this),t=this.container,i=this.content;return e.content=i,e.contentId=i.mediaId,t?(e.container=t,e.containerId=t.mediaId):e.containerId="",e}},{key:"toString",value:function(){return"[Clip ".concat(this.label,"]")}},{key:"track",get:function(){return this._track},set:function(e){this._track=e}},{key:"trackNumber",get:function(){var e=this.track;return e?e.index:-1},set:function(e){e<0&&delete this._track}},{key:"visible",get:function(){return!!this.containerId}}]),n}(Pr),Ol=function(t){var i=t.containerId,n=t.contentId,r=Z(n)||n===ns,a=Z(i)||i===Yo;return t.sizing===e.Sizing.Content&&r&&(t.sizing=e.Sizing.Container),t.sizing===e.Sizing.Container&&a&&(t.sizing=e.Sizing.Preview),t.timing===e.Timing.Content&&r&&(t.timing=e.Timing.Container),t.timing===e.Timing.Container&&a&&(t.timing=e.Timing.Custom),new Rl(t)},_l=function(t){c(r,t);var i=l(r);function r(t){var n;h(this,r),n=i.call(this),v(u(n),"clips",[]),v(u(n),"dense",!1),v(u(n),"_identifier",void 0),v(u(n),"index",0),v(u(n),"_mash",void 0),v(u(n),"selectType",e.SelectType.Track);var a,o=t.clips,s=t.index,c=t.dense,l=t.mashMedia;return n.mash=l,he(s)&&(n.index=s),n.dense=re(c)?!!c:!n.index,n.properties.push(Lo({name:"dense",defaultValue:!1})),n.propertiesInitialize(t),o&&(a=n.clips).push.apply(a,d(o.map((function(e){var t=m(m({},e),{},{track:u(n)}),i=Ol(t);return i.track=u(n),i})))),n}return f(r,[{key:"addClips",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)||0;this.dense||(t=0);var i=t,n=this.clips.filter((function(n,r){var a=e.includes(n);return i&&a&&r<i&&(t-=1),!a}));n.splice.apply(n,[t,0].concat(d(e))),this.sortClips(n),en(this.clips,n)}},{key:"assureFrame",value:function(e){var t=e||this.clips,i=!1,n=0,r=[],a=this.dense;return t.forEach((function(e){var t=e.frame;(a?t!==n:r.some((function(e){return e.includes(t)})))&&(i=!0,e.frame=n),n=e.frame+e.frames,a||r.push(e.timeRange(1))})),i}},{key:"assureFrames",value:function(e,t){var i=re(t);(t||this.clips).forEach((function(t){var n=t.frames;pe(n)||(t.resetTiming(void 0,e),!pe(t.frames)&&i&&(t.frames=Math.floor(Io.duration*e)))}))}},{key:"frameForClipNearFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.dense)return t;var i=this.clips.filter((function(i){return e!==i&&i.endFrame>t}));if(!i.length)return t;var n=e.frame,r=e.endFrame-n,a=t;return i.find((function(e){if(e.frame>=a+r)return!0;a=e.endFrame})),a}},{key:"frames",get:function(){var t=this.clips;if(!t.length)return e.Duration.None;var i,r=n(t);try{for(r.s();!(i=r.n()).done;){var a=i.value.frames;switch(a){case e.Duration.Unknown:case e.Duration.Unlimited:return a}}}catch(s){r.e(s)}finally{r.f()}var o=Qi(t);return o.frame+o.frames}},{key:"identifier",get:function(){return this._identifier||(this._identifier=Jo("track"))}},{key:"mash",get:function(){var e=this._mash;return ha(e),e},set:function(e){this._mash=e}},{key:"removeClips",value:function(e){var t=this.clips.filter((function(t){return!e.includes(t)}));Ce(t.length!==this.clips.length),e.forEach((function(e){return e.trackNumber=-1})),this.sortClips(t),en(this.clips,t)}},{key:"selectables",value:function(){return[this].concat(d(this.mash.selectables()))}},{key:"selectedItems",value:function(t){var i=this;return this.properties.map((function(n){var r=i.value(n.name);return{value:r,property:n,selectType:e.SelectType.Track,changeHandler:function(e,n){Te(e);var a={target:i,property:e,redoValue:n,undoValue:r};t.create(a)}}}))}},{key:"sortClips",value:function(e){var t=e||this.clips,i=this.assureFrame(t);return t.sort(zo),i}},{key:"toJSON",value:function(){var e=a(o(r.prototype),"toJSON",this).call(this);return e.clips=this.clips,e}}]),r}(Pr),jl=function(e){return new _l(e)},Nl={instance:jl},ql=function(e){c(i,e);var t=l(i);function i(){return h(this,i),t.apply(this,arguments)}return f(i,[{key:"clips",get:function(){return[]}}]),i}(Vl),Bl="".concat(Li,"font").concat(Gi),Ul=function(e){return ts(e)&&"string"in e};function Ll(e){if(!Ul(e))throw new Error("expected Font")}var Gl=function(e){return Vr(e)&&e.type===Le};function Hl(e){if(!Gl(e))throw new Error("expected FontMedia")}var Wl=function(e){c(i,e);var t=l(i);function i(e){return h(this,i),t.call(this,e)}return f(i)}(Ar),Jl=function(e){return new Wl(e)},Kl=[Be,Je],Xl=function(e){return rs(e)&&"startOptions"in e};function Yl(e,t){Xl(e)||W(e,"Updatable",t)}var Zl=function(e){return et(e)&&Kl.includes(e)},$l=function(e){return os(e)&&"audibleSource"in e};function Ql(e,t){$l(e)||W(e,"UpdatableDefinition",t)}var eh=",";function th(e){return function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];e=t.call.apply(t,[this].concat(r)),v(u(e),"gain",1),v(u(e),"gainPairs",[]),v(u(e),"hasIntrinsicTiming",!0),v(u(e),"_trimFilter",void 0);var o=r[0].gain;if(re(o))if(X(o))if(o.includes(eh)){for(var s=o.split(eh).map((function(e){return parseFloat(e)})),c=s.length/2,l=0;l<c;l+=1)e.gainPairs.push([s[2*l],s[2*l+1]]);e.gain=-1}else e.gain=Number(o);else he(o)&&(e.gain=o);return e}return f(i,[{key:"definitionTime",value:function(e,t){var n=a(o(i.prototype),"definitionTime",this).call(this,e,t),r=this.startTrim,s=this.endTrim,u=this.definition.duration;ve(u);var c=po(u,t.fps).frame-(r+s),l=n.frame%c;return n.withFrame(l+r).divide(this.speed)}},{key:"frames",value:function(e){var t=this.definition,i=this.startTrim,n=this.endTrim,r=t.frames(e);return r-(i+n)}},{key:"graphFiles",value:function(e){if(!e.audible)return[];if(!this.mutable()||this.muted)return[];var t=this.definition;return[{type:Be,file:"",definition:t,input:!0}]}},{key:"hasGain",value:function(){if(0===this.gain)return!0;if(he(this.gain))return!1;if(2!==this.gainPairs.length)return!1;var e=p(this.gainPairs,2),t=e[0],i=e[1];if(2!==t.length)return!1;if(2!==i.length)return!1;if(Math.max.apply(Math,d(t)))return!1;var n=p(i,2),r=n[0],a=n[1];return 1===r&&0===a}},{key:"initialCommandFilters",value:function(e,t){var i=[],n=e.time,r=e.quantize,a=e.commandFiles,o=e.clipTime,s=e.videoRate,u=e.duration,c=this.id,l=$s(a,c,!0);Te(l,"filterInput");var h="trim",f=Jo(h),d={};u&&(d.duration=u);var p=this.definitionTime(n,o).frame;p&&(d.start=fo(p,r).seconds);var v={inputs:[l],ffmpegFilter:h,options:d,outputs:[f]};if(i.push(v),l=f,u){var m="fps",y=Jo(m),g={ffmpegFilter:m,options:{fps:s},inputs:[l],outputs:[y]};i.push(g),l=y}var k="setpts",T={ffmpegFilter:k,options:{expr:"PTS-STARTPTS"},inputs:[l],outputs:[Jo(k)]};return i.push(T),i}},{key:"intrinsicsKnown",value:function(e){return!!a(o(i.prototype),"intrinsicsKnown",this).call(this,e)&&(!e.duration||pe(this.definition.duration))}},{key:"mutable",value:function(){return this.definition.audio}},{key:"selectedProperty",value:function(e){return"gain"===e.name?this.mutable()&&!this.muted:a(o(i.prototype),"selectedProperty",this).call(this,e)}},{key:"setValue",value:function(e,t,n){if(a(o(i.prototype),"setValue",this).call(this,e,t,n),!n)switch(t){case"startTrim":case"endTrim":case"speed":this.clip.resetTiming(this)}}},{key:"startOptions",value:function(e,t){var i=t.withFrame(this.startTrim).seconds,n=t.seconds-e,r=t.lengthSeconds;return n<0&&(i-=n,r+=n,n=0),{start:n,offset:i,duration:r}}},{key:"toJSON",value:function(){var e=a(o(i.prototype),"toJSON",this).call(this),t=this.speed,n=this.gain;return 1!==t&&(e.speed=t),1!==n&&(e.gain=n),e}},{key:"trimFilter",get:function(){return this._trimFilter||(this._trimFilter=wc("trim"))}}]),i}(e)}var ih="probe",nh=[ih],rh=function(e){return nh.includes(e)},ah=function(e){return J(e)&&"type"in e&&rh(e.type)};function oh(e){ah(e)||W(e,"Decoding")}var sh=function(e){return ah(e)&&e.type===ih};function uh(e){sh(e)||W(e,"Probing")}function ch(t){return function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];t=i.call.apply(i,[this].concat(a)),v(u(t),"_audio",void 0),v(u(t),"audioUrl",""),v(u(t),"_duration",0),v(u(t),"loadedAudio",void 0),v(u(t),"loop",!1);var s=a[0].loop;return s&&(t.loop=s,t.properties.push(Lo({name:"loops",defaultValue:1}))),t.properties.push(Lo({name:"gain",defaultValue:1,type:e.DataType.Percent,min:0,max:2,step:.01})),t.properties.push(Lo({name:"speed",defaultValue:1,type:e.DataType.Percent,min:.1,max:2,step:.1,group:e.DataGroup.Timing})),t.properties.push(Lo({name:"startTrim",defaultValue:0,type:e.DataType.Frame,step:1,min:0,group:e.DataGroup.Timing})),t.properties.push(Lo({name:"endTrim",defaultValue:0,type:e.DataType.Frame,step:1,min:0,group:e.DataGroup.Timing})),t}return f(n,[{key:"audibleSource",value:function(){var e=this.loadedAudio;if(e)return sa.createBufferSource(e)}},{key:"audio",get:function(){return Z(this._audio)&&(this._audio=this.decodings.some((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.audible}))),Boolean(this._audio)},set:function(e){this._audio=e}},{key:"duration",get:function(){if(!pe(this._duration)){var e=this.decodings.find((function(e){return e.type===ih}));if(sh(e)){var t=e.data.duration;pe(t)&&(this._duration=t)}}return this._duration},set:function(e){this._duration=e}},{key:"frames",value:function(t){return this.duration?po(this.duration,t,"floor").frame:e.Duration.Unknown}},{key:"preloadAudioPromise",get:function(){var e=this;if(this.loadedAudio)return Promise.resolve();var t=this.preferredTranscoding(Be,Je).request,i=t.response;return Kr(i)?(this.loadedAudio=i,Promise.resolve()):Xc(t).then((function(t){if(!qe(t)){var i=t.data;if(!Kr(i)){Hr(i);var n=i.src,r=xn(n);return Xc({endpoint:r}).then((function(t){if(!qe(t)){var i=t.data;Xr(i),e.loadedAudio=i}}))}e.loadedAudio=i}}))}},{key:"toJSON",value:function(){var e=this.loop;return m(m({},a(o(n.prototype),"toJSON",this).call(this)),{},{loop:e})}}]),n}(t)}var lh=[Ge,Je],hh=function(e){return rs(e)};function fh(e){hh(e)||W(e,"UpdatableSize")}var dh=function(e){return et(e)&&lh.includes(e)},ph=function(e){return os(e)};function vh(e){ph(e)||W(e,"UpdatableSizeDefinition")}function mh(t){return function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];t=i.call.apply(i,[this].concat(a)),v(u(t),"colorMaximize",!0),v(u(t),"hasIntrinsicSizing",!0),v(u(t),"_setsarFilter",void 0);var s=a[0],c=s.container?0:1;return t.addProperties(s,Lo({tweenable:!0,name:"width",type:e.DataType.Percent,group:e.DataGroup.Size,defaultValue:1,max:2,min:c})),t.addProperties(s,Lo({tweenable:!0,name:"height",type:e.DataType.Percent,group:e.DataGroup.Size,defaultValue:1,max:2,min:c})),t}return f(n,[{key:"containerCommandFilters",value:function(e,t){var i=[],n=e.commandFiles,r=e.containerRects,a=e.filterInput,o=e.videoRate,s=e.track,u=a,c=t.size?Es.apply(void 0,d(r)):r[0],l=m(m({},e),{},{contentColors:[rr,rr],outputSize:c});i.push.apply(i,d(this.colorBackCommandFilters(l,"container-".concat(s,"-back"))));var h=Qi(Qi(i).outputs),f=this.id,p=$s(n,f,!0);i.push.apply(i,d(this.scaleCommandFilters(m(m({},e),{},{filterInput:p})))),u=Qi(Qi(i).outputs),t.size&&(Te(u,"overlay input"),i.push.apply(i,d(this.overlayCommandFilters(h,u))),u=Qi(Qi(i).outputs));var v={duration:0,videoRate:o};Te(u,"crop input");var y=this.cropFilter;return y.setValue(c.width,"width"),y.setValue(c.height,"height"),y.setValue(0,"x"),y.setValue(0,"y"),i.push.apply(i,d(y.commandFilters(m(m({},v),{},{filterInput:u})))),u=Qi(Qi(i).outputs),t.size||(Te(u,"overlay input"),i.push.apply(i,d(this.overlayCommandFilters(h,u))),u=Qi(Qi(i).outputs)),Te(u,"alphamerge input"),i.push.apply(i,d(this.alphamergeCommandFilters(m(m({},e),{},{filterInput:u})))),u=Qi(Qi(i).outputs),i.push.apply(i,d(this.containerFinalCommandFilters(m(m({},e),{},{filterInput:u})))),i}},{key:"containerSvgItemPromise",value:function(t,i,n,r){return r!==e.Component.Player?this.svgItemForTimelinePromise(t,i,n):this.svgItemForPlayerPromise(t,i,n).then((function(e){return du(e,t),e}))}},{key:"contentCommandFilters",value:function(e,t){var i=[],r=e.containerRects,s=e.visible,u=e.time,c=e.videoRate,l=e.clipTime,h=e.commandFiles,f=e.filterInput,v=e.track;if(!s)return i;ze(l),we(r,"containerRects");var y=this.id,g=f||$s(h,y,s),k={containerRects:r,time:u,timeRange:l},T=this.contentRects(k),b=!ks.apply(void 0,d(r)),w=p(T,2),F=w[0],S=w[1],I=De(u)?u.lengthSeconds:0,C=b?Es.apply(void 0,d(r)):r[0],P="content-".concat(v,"-back"),x=m(m({},e),{},{contentColors:[$n,$n],outputSize:C});i.push.apply(i,d(this.colorBackCommandFilters(x,P)));var A=m(m({},e),{},{filterInput:g,containerRects:T});i.push.apply(i,d(this.scaleCommandFilters(A))),g=Qi(Qi(i).outputs),t.size&&(i.push.apply(i,d(this.overlayCommandFilters(P,g))),g=Qi(Qi(i).outputs));var M={duration:I,videoRate:c},D=this.cropFilter;D.setValue(C.width,"width"),D.setValue(C.height,"height"),D.setValue(F.x,"x"),D.setValue(F.y,"y"),D.setValue(S.x,"x".concat(Cr)),D.setValue(S.y,"y".concat(Cr)),i.push.apply(i,d(D.commandFilters(m(m({},M),{},{filterInput:g})))),g=Qi(Qi(i).outputs);var z=this.setsarFilter;return z.setValue("1/1","sar"),i.push.apply(i,d(z.commandFilters(m(m({},M),{},{filterInput:g})))),g=Qi(Qi(i).outputs),t.size||(i.push.apply(i,d(this.overlayCommandFilters(P,g,this.definition.alpha))),g=Qi(Qi(i).outputs)),i.push.apply(i,d(a(o(n.prototype),"contentCommandFilters",this).call(this,m(m({},e),{},{filterInput:g}),t))),i}},{key:"svgItemForPlayerPromise",value:function(e,t,i){return this.svgItemForTimelinePromise(e,t,i)}},{key:"svgItemForTimelinePromise",value:function(e,t,i){return W(V.Unimplemented)}},{key:"contentSvgItemPromise",value:function(e,t,i,n){Ce(!this.container);var r=this.itemContentRect(e,t,i);return this.containerSvgItemPromise(r,t,i,n)}},{key:"initialCommandFilters",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=[],r=e.filterInput,a=e.track;return i&&(Te(r),n.push(this.copyCommandFilter(r,a))),n}},{key:"intrinsicRect",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"previewSize":"sourceSize",t=this.definition[e];return Ha(t,e),m(m({},hs),t)}},{key:"intrinsicsKnown",value:function(e){var t=e.editing;if(!e.size)return!0;var i=t?"previewSize":"sourceSize",n=this.definition[i];return Ga(n)}},{key:"itemContentRect",value:function(e,t,i){var n={containerRects:e,time:t,timeRange:i,editing:!0},r=this.contentRects(n),a=p(r,1)[0],o=a.x,s=a.y,u={x:e.x-o,y:e.y-s};return bs(a,u)}},{key:"setsarFilter",get:function(){return this._setsarFilter||(this._setsarFilter=wc("setsar"))}}]),n}(t)}function yh(e){return function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];e=t.call.apply(t,[this].concat(r)),v(u(e),"alpha",void 0);var o=r[0];return console.log(e.constructor.name,o),e}return f(i,[{key:"previewSize",get:function(){var e=this.transcodings.find((function(e){return e.request.response}));if(!e)return this.sourceSize;var t=e.request.response;if(Ga(t)){var i=t.width,n=t.height;if(pe(i)&&pe(n))return{width:i,height:n}}}},{key:"sourceSize",get:function(){var e=this.decodings.find((function(e){return e.type===ih}));if(sh(e)){var t=e.data,i=t.width,n=t.height;if(!pe(i)||!pe(n))return;return{width:i,height:n}}}}]),i}(e)}var gh=function(){function e(t){h(this,e),v(this,"buffer",Io.mash.buffer),v(this,"bufferSource",void 0),v(this,"gain",Io.mash.gain),v(this,"playing",!1),v(this,"playingClips",[]),v(this,"startedMashAt",0),v(this,"contextSecondsWhenStarted",0);var i=t.buffer,n=t.gain;he(n)&&(this.gain=n),pe(i)&&(this.buffer=i)}return f(e,[{key:"adjustClipGain",value:function(e,t){var i=this,n=e.timeRange(t);this.clipSources(e).forEach((function(e){i.adjustSourceGain(e,n)}))}},{key:"adjustSourceGain",value:function(e,t){var i=this,n=sa.getSource(e.id);if(n){var r=n.gainNode;if(0!==this.gain){var a=e.gain;if(he(a))r.gain.value=this.gain*a;else{var o=De(t)?e.startOptions(this.seconds,t):t,s=o.start,u=o.duration;r.gain.cancelScheduledValues(0),e.gainPairs.forEach((function(e){var t=p(e,2),n=t[0],a=t[1];r.gain.linearRampToValueAtTime(i.gain*a,s+n*u)}))}}else r.gain.value=0}}},{key:"bufferClips",value:function(e,t){return!!this.createSources(e,t)&&(this.destroySources(e),!0)}},{key:"clear",value:function(){}},{key:"clipSources",value:function(e){var t=[],i=e.container,n=e.content;return Xl(i)&&!i.muted&&t.push(i),Xl(n)&&!n.muted&&t.push(n),t}},{key:"createSources",value:function(e,t,i){var n,r=this;if(!this.playing&&!i)return!1;var a=e.filter((function(e){return!r.playingClips.includes(e)}));if(!a.length)return!0;var o=!0;return a.forEach((function(e){var n=r.clipSources(e),a=e.timeRange(t),s=n.filter((function(e){return!sa.hasSource(e.id)}));o&&(o=s.every((function(e){var t=r.playing?r.seconds:(null===i||void 0===i?void 0:i.seconds)||0,n=e.startOptions(t,a),o=n.start,s=n.duration,u=n.offset;if(he(o)&&pe(s)){var c=e.definition,l=e.id;Ql(c);var h=c.audibleSource();if(!h)return!!o||(console.log(r.constructor.name,"createSources no audible source",c.label),!1);var f=c.loop;sa.startAt(l,h,o,s,u,f),r.adjustSourceGain(e,n)}else console.error(r.constructor.name,"createSources",n);return!0})))})),(n=this.playingClips).push.apply(n,d(a)),o}},{key:"destroySources",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];d(this.playingClips).filter((function(e){return!t.includes(e)})).forEach((function(t){e.clipSources(t).forEach((function(e){return sa.deleteSource(e.id)}))})),this.playingClips=t}},{key:"setGain",value:function(e,t){var i=this;this.gain!==e&&(this.gain=e,this.playing&&this.playingClips.forEach((function(e){return i.adjustClipGain(e,t)})))}},{key:"seconds",get:function(){return sa.currentTime-this.contextSecondsWhenStarted+this.startedMashAt}},{key:"startContext",value:function(){if(this.bufferSource)return W(V.Internal);if(this.playing)return W(V.Internal);var e=sa.createBuffer(this.buffer);this.bufferSource=sa.createBufferSource(e),this.bufferSource.loop=!0,this.bufferSource.connect(sa.destination),this.bufferSource.start(0)}},{key:"startPlaying",value:function(e,t,i){if(!this.bufferSource)return W(V.Internal);if(this.playing)return W(V.Internal);var n=e.seconds;return this.playing=!0,this.startedMashAt=n,this.contextSecondsWhenStarted=sa.currentTime,!!this.createSources(t,i,e)||(this.stopPlaying(),!1)}},{key:"stopContext",value:function(){this.bufferSource&&(this.bufferSource.stop(),this.bufferSource.disconnect(sa.destination),delete this.bufferSource)}},{key:"stopPlaying",value:function(){this.playing&&(this.playing=!1,this.destroySources(),this.startedMashAt=0,this.contextSecondsWhenStarted=0)}}]),e}(),kh=function(e){return new gh(e)},Th=function(t){c(n,t);var i=l(n);function n(t,r){var a,o;h(this,n),o=i.call(this,t),v(u(o),"_editor",void 0),v(u(o),"emitter",void 0),v(u(o),"imageSize",m({},Oa)),v(u(o),"_buffer",Io.mash.buffer),v(u(o),"_bufferTimer",void 0),v(u(o),"_composition",void 0),v(u(o),"drawInterval",void 0),v(u(o),"drawingTime",void 0),v(u(o),"drawnTime",void 0),v(u(o),"_frame",0),v(u(o),"_gain",Io.mash.gain),v(u(o),"_loadMashContentPromise",void 0),v(u(o),"_loadedMashContent",!1),v(u(o),"loadingPromises",[]),v(u(o),"loop",!1),v(u(o),"_media",void 0),v(u(o),"_paused",!0),v(u(o),"_playing",!1),v(u(o),"_preview",void 0),v(u(o),"quantize",Io.mash.quantize),v(u(o),"_rendering",""),v(u(o),"encodings",[]),v(u(o),"seekTime",void 0),v(u(o),"selectType",e.SelectType.Mash),v(u(o),"tracks",[]),v(u(o),"type",He);var s=t.encodings;if(Ea(r))o.imageSize=r;else if(r){var c=r.loop,l=r.gain,f=r.buffer,p=r.size,y=r.mediaCollection,g=r.emitter,k=r.editor;k&&(o.editor=k),g&&(o.emitter=g),p&&(o.imageSize=p),J(y)&&(o._media=y),ee(c)&&(o.loop=c),se(l)&&(o.gain=l),pe(f)&&(o._buffer=f)}return me(s)&&(a=o.encodings).push.apply(a,d(s.map(Jl))),o.properties.push(Lo({name:"color",defaultValue:Qn,type:e.DataType.Rgb})),o._preview=new ql({mash:u(o),time:fo()}),o.propertiesInitialize(t),o}return f(n,[{key:"editor",get:function(){return this._editor},set:function(e){this._editor=e}},{key:"addClipToTrack",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0,a=me(e)?e:[e],o=this.trackClips(a,i);this.emitIfFramesChange((function(){o.forEach((function(e){var i=p(e,2),a=i[0],o=i[1],s=t.tracks[a];Fo(s,"track"),o.forEach((function(e){var t=e.trackNumber;he(t)&&t!==a&&e.track.removeClips([e]),he(r)&&(e.frame=r),e.track=s})),s.assureFrames(t.quantize,o),s.addClips(o,n)}))}))}},{key:"addTrack",value:function(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=m({index:this.tracks.length,mashMedia:this},i),r=jl(n);return this.tracks.push(r),this.tracks.sort(Eo),null===(t=this.emitter)||void 0===t||t.emit(e.EventType.Track),r}},{key:"assureTrack",value:function(){if(!this.tracks.length){var e=jl({dense:!0,mashMedia:this});e.mash=this,this.tracks.push(e)}}},{key:"buffer",get:function(){return this._buffer},set:function(e){ve(e,"buffer"),this._buffer!==e&&(this._buffer=e,this._composition&&(this.composition.buffer=e))}},{key:"bufferStart",value:function(){var e=this;this._bufferTimer||(this._bufferTimer=setInterval((function(){if(!e._paused){var t={editing:!0,audible:!0};e.loadPromise(t);var i=e.clipsAudibleInTime(e.timeToBuffer);e.composition.bufferClips(i,e.quantize)}}),Math.round(1e3*this.buffer/2)))}},{key:"bufferStop",value:function(){this._bufferTimer&&(clearInterval(this._bufferTimer),delete this._bufferTimer)}},{key:"changeTiming",value:function(e,t,i){this.emitIfFramesChange((function(){e.setValue(i,t)}))}},{key:"clearDrawInterval",value:function(){this.drawInterval&&(clearInterval(this.drawInterval),this.drawInterval=void 0)}},{key:"clearPreview",value:function(){delete this._preview}},{key:"clipIntersects",value:function(e,t){return!e.frames||e.timeRange(this.quantize).intersects(t)}},{key:"clips",get:function(){return this.tracks.map((function(e){return e.clips})).flat()}},{key:"clipsAudibleInTime",value:function(e){var t=this.clips.filter((function(e){return e.mutable&&e.notMuted}));return this.filterIntersecting(t,e)}},{key:"clipsInTime",value:function(e){return this.filterIntersecting(this.clips,e)}},{key:"clipsInTimeOfType",value:function(t){switch(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.AVType.Both){case e.AVType.Both:return this.clipsInTime(t);case e.AVType.Audio:return this.clipsAudibleInTime(t);case e.AVType.Video:return this.clipsVisibleInTime(t)}}},{key:"clipsVisible",get:function(){return this.clips.filter((function(e){return e.container}))}},{key:"clipsVisibleInTime",value:function(e){return this.filterIntersecting(this.clipsVisible,e)}},{key:"compositeVisible",value:function(t){var i;this.drawingTime=t,this.clearPreview(),null===(i=this.emitter)||void 0===i||i.emit(e.EventType.Draw)}},{key:"compositeVisibleRequest",value:function(e){var t=this;"function"===typeof requestAnimationFrame&&requestAnimationFrame((function(){t.compositeVisible(e)}))}},{key:"composition",get:function(){if(!this._composition){var e={buffer:this.buffer,gain:this.gain};this._composition=kh(e)}return this._composition}},{key:"definitionIds",get:function(){var e=this.clips.flatMap((function(e){return e.definitionIds()}));return d(new Set(e))}},{key:"destroy",value:function(){this.paused=!0,this.clearDrawInterval()}},{key:"draw",value:function(){var e=this.time;this.compositeVisible(e)}},{key:"drawRequest",value:function(){var e=this.time;this.compositeVisibleRequest(e)}},{key:"drawTime",value:function(t){var i,n=t!==this.time;this.drawnTime=t,this.drawRequest(),null===(i=this.emitter)||void 0===i||i.emit(n?e.EventType.Time:e.EventType.Loaded)}},{key:"duration",get:function(){return this.endTime.seconds}},{key:"emitIfFramesChange",value:function(t){var i=this.frames;t();var n,r=this.frames;i!==r&&(null===(n=this.emitter)||void 0===n||n.emit(e.EventType.Duration),this.frame>r&&this.seekToTime(fo(r,this.quantize)))}},{key:"endTime",get:function(){return fo(this.frames,this.quantize)}},{key:"filterIntersecting",value:function(e,t){var i=this,n=t.scale(this.quantize);return e.filter((function(e){return i.clipIntersects(e,n)}))}},{key:"frame",get:function(){return this.time.scale(this.quantize,"floor").frame}},{key:"frames",get:function(){if(this.tracks.length){var t=this.tracks.map((function(e){return e.frames}));return he(Math.min.apply(Math,d(t)))?Math.max.apply(Math,[0].concat(d(t))):e.Duration.Unknown}return e.Duration.None}},{key:"gain",get:function(){return this._gain},set:function(e){fe(e,"gain"),this._gain!==e&&(this._gain=e,this._composition&&this.composition.setGain(e,this.quantize))}},{key:"graphFileOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.time,i=e.audible,n=e.visible,r=e.editing,a=e.streaming,o=t||this.time,s=o.isRange,u=n||!s,c=s&&i,l={editing:r,streaming:a,audible:c,visible:u,time:o,quantize:this.quantize};return Ce(u||c,"audible || visible"),l}},{key:"handleDrawInterval",value:function(){var t,i=this.composition.seconds,n=this.time.withFrame(this.time.frame);if(i>=this.endTime.seconds)this.loop?this.seekToTime(this.time.withFrame(0)):(this.paused=!0,null===(t=this.emitter)||void 0===t||t.emit(e.EventType.Ended));else if(i>=n.seconds){var r=po(i,this.time.fps);this.drawTime(r)}}},{key:"loadMashContentPromise",get:function(){var e=this;if(this._loadedMashContent)return Promise.resolve();var t=this._loadMashContentPromise;if(!t){var i=this.request;return this._loadMashContentPromise=tl(i,!0).then((function(t){var i;if(qe(t))return W(t.error);var n=t.data,r=n.media,a=n.tracks,o=n.quantize,s=n.color;me(r)&&(i=e.media).define.apply(i,d(r)),pe(o)&&(e.quantize=o),s&&e.setValue(s,"color"),me(a)&&a.forEach((function(t,i){var n=m(m({mashMedia:e,dense:!i},t),{},{index:i}),r=jl(n);r.assureFrames(e.quantize),r.sortClips(),e.tracks.push(r)})),e.assureTrack(),e.tracks.sort(Eo),e._loadedMashContent=!0,delete e._loadMashContentPromise}))}return t}},{key:"loadPromise",value:function(){var t=this,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.loadMashContentPromise.then((function(){i.time||(i.time=t.timeToBuffer);var n=t.graphFileOptions(i),r=n.time,a=n.audible,o=n.visible,s=t.quantize;Me(r);var u=r.scale(t.quantize),c=a&&o?e.AVType.Both:a?e.AVType.Audio:e.AVType.Video,l=t.clipsInTimeOfType(u,c).map((function(e){var t=e.timeRange(s),i=m(m({},n),{},{clipTime:t,quantize:s,time:r});return e.loadPromise(i)})),h=Promise.all(l).then(Ni),f=h.then((function(){var e=t.loadingPromises.indexOf(h);if(e<0)return W(V.Internal);t.loadingPromises.splice(e,1)}));return t.loadingPromises.push(h),f}))}},{key:"loading",get:function(){return!!this.loadingPromises.length}},{key:"media",get:function(){return this._media||(this._media=new Br)}},{key:"paused",get:function(){return this._paused},set:function(t){var i,n=this,r=t||!this.frames;this._paused!==r&&(this._paused=r,r?(this.playing=!1,this.bufferStop(),this._bufferTimer&&(clearInterval(this._bufferTimer),delete this._bufferTimer),this.composition.stopContext(),null===(i=this.emitter)||void 0===i||i.emit(e.EventType.Pause)):(this.composition.startContext(),this.loadPromise({editing:!0,audible:!0,visible:!0}).then((function(){var t;n.bufferStart(),n.playing=!0,null===(t=n.emitter)||void 0===t||t.emit(e.EventType.Play)}))))}},{key:"playing",get:function(){return this._playing},set:function(t){if(this._playing!==t)if(this._playing=t,t){var i,n=this.quantize,r=this.time,a=this.clipsAudibleInTime(this.timeToBuffer);if(!this.composition.startPlaying(r,a,n)){var o=this.clipsAudibleInTime(this.timeToBuffer);if(!this.composition.startPlaying(r,o,n))return void(this._playing=!1)}null===(i=this.emitter)||void 0===i||i.emit(e.EventType.Playing),this.setDrawInterval()}else this.composition.stopPlaying(),this.clearDrawInterval()}},{key:"preview",value:function(e){return this._preview||(this._preview=this.previewInitialize(e))}},{key:"previewInitialize",value:function(e){return new Vl(this.previewArgs(e))}},{key:"previewArgs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.editor,i=null===t||void 0===t?void 0:t.selection.clip,n=Po(i)?i:void 0,r=this.drawingTime,a=this.time,o=this.quantize;return m({selectedClip:n,time:(r||a).scale(o),mash:this},e)}},{key:"previewItemsPromise",value:function(e){var t={editor:e};return this.preview(t).previewItemsPromise}},{key:"putPromise",value:function(){var e=this.quantize,t=this.clips.flatMap((function(t){var i=t.container;if(Ul(i)&&!i.intrinsicsKnown({editing:!0,size:!0})){var n={editing:!0,visible:!0,quantize:e,time:t.time(e),clipTime:t.timeRange(e)};return i.loadPromise(n)}return[]}));return Promise.all(t).then(Ni)}},{key:"removeClipFromTrack",value:function(e){var t=me(e)?e:[e];this.emitIfFramesChange((function(){t.forEach((function(e){e.track.removeClips([e])}))}))}},{key:"removeTrack",value:function(t){var i,n=this,r=he(t)?t:this.tracks.length-1;fe(r),this.emitIfFramesChange((function(){n.tracks.splice(r,1)})),null===(i=this.emitter)||void 0===i||i.emit(e.EventType.Track)}},{key:"restartAfterStop",value:function(t,i,n){var r;t.equalsTime(this.time)&&(n&&(delete this.seekTime,null===(r=this.emitter)||void 0===r||r.emit(e.EventType.Seeked)),this.drawTime(t),i||(this.playing=!0))}},{key:"reload",value:function(){return this.stopLoadAndDraw()}},{key:"seekToTime",value:function(t){var i,n;return this.seekTime!==t&&(this.seekTime=t,null===(i=this.emitter)||void 0===i||i.emit(e.EventType.Seeking),null===(n=this.emitter)||void 0===n||n.emit(e.EventType.Time)),this.stopLoadAndDraw(!0)}},{key:"selectables",value:function(){return[this]}},{key:"selectedItems",value:function(t){var i=this;return this.properties.map((function(n){var r=i.value(n.name),a={value:r,selectType:e.SelectType.Mash,property:n,changeHandler:function(e,n){Te(e);var a={property:e,target:i,redoValue:n,undoValue:r};t.create(a)}};return a}))}},{key:"setDrawInterval",value:function(){var e=this;this.drawInterval||(this.clearDrawInterval(),this.drawInterval=setInterval((function(){e.handleDrawInterval()}),500/this.time.fps))}},{key:"stopLoadAndDraw",value:function(e){var t=this,i=this.time,n=this.paused,r=this.playing;return r&&(this.playing=!1),this.loadPromise({editing:!0,visible:!0,audible:r}).then((function(){t.restartAfterStop(i,n,e)}))}},{key:"time",get:function(){return this.seekTime||this.drawnTime||fo(this._frame,this.quantize)}},{key:"timeRange",get:function(){var e=this.endTime,t=this.time,i=e.scale(t.fps);return lo(t,i.frame)}},{key:"timeRanges",value:function(t,i){var n=i||this.time,r=this.quantize,a=n.scale(this.quantize,"floor"),o=a.isRange?a.timeRange.endTime:void 0,s=this.clipsInTimeOfType(n,t),u=s.length;if(!u)return[];if(1===u||!a.isRange||t===e.AVType.Audio)return[n];var c=new Set;s.forEach((function(e){c.add(Math.max(e.frame,a.frame)),c.add(Math.min(e.frame+e.frames,o.frame))}));var l=d(c).sort((function(e,t){return e-t})),h=l.shift();return l.map((function(e){var t=uo(h,r,e-h);return h=e,t}))}},{key:"timeToBuffer",get:function(){var e=this.time,t=this.quantize,i=this.buffer;return this.paused?fo(e.scale(t,"floor").frame,t):ho(e,po(i+e.seconds,e.fps))}},{key:"toJSON",value:function(){var e=this.encodings,t=this.tracks,i=this.quantize;return this.frame,m(m({},a(o(n.prototype),"toJSON",this).call(this)),{},{encodings:e,tracks:t,quantize:i})}},{key:"trackClips",value:function(e,t){if(he(t))return[[t,e]];var i=this.tracks.length-e.length;return e.map((function(e){return[i++,[e]]}))}}]),n}(dl),bh={type:He,id:"",request:{response:{}}},wh=function(e,t){var i=m({request:{response:{}},type:He},e);return new Th(i,t)},Fh=function(e){return hh(e)},Sh=function(e){return Vr(e)&&e.type===Ge},Ih=function(e){return(null===e||void 0===e?void 0:e.split("/").shift())||""},Ch=function(e){return{duration:e.duration,audible:!0}},Ph=function(e){return Xa(e)},xh=function(e){var t,i=e.duration,n=e.videoWidth,r=e.clientWidth,a=e.videoHeight,o=e.clientHeight,s=n||r,u=a||o,c=e,l=c.mozHasAudio;return l||(l=Boolean(c.webkitAudioDecodedByteCount)),l||(l=Boolean(null===(t=c.audioTracks)||void 0===t?void 0:t.length)),l||console.log(Object.values(e)),{width:s,height:u,duration:i,audible:l}};function Ah(e){return{}}var Mh=function(e){return Gr(e)?xh(e):Wr(e)?Ph(e):Yr(e)?Ah():Kr(e)?Ch(e):{}},Dh=function(e,t){return console.log("filePromises",e,t),e.map((function(e){var t=e.name,i=e.type,n=Ih(i);if(!ut(n))return console.log("filePromises NOT raw type",n,i,e),G(V.ImportType,{value:n});var r=[],a={endpoint:xn(URL.createObjectURL(e))},o={request:a,decodings:r,type:n,label:t,file:e,id:Ko()},s=n===Be||n===Je,u=n===Ge||n===Je;return nl(a,n).then((function(e){if(console.log("filePromises",a,n,e),qe(e))return e;var t=e.data,i=Mh(t),c={data:i,type:ih};if(r.push(c),s){var l=i.duration,h=void 0===l?0:l;if(!pe(h))return G(V.ImportDuration,{value:h});i.audible=!0}if(u){var f=Xa(i);if(!Ga(f))return G(V.ImportSize,{value:Za(f)});o.clientMedia=t}else o.clientMedia=t;return console.log("filePromises",o),{mediaObject:o}}))}))},zh=function(){function t(e){h(this,t),v(this,"actions",void 0),v(this,"autoplay",Io.editor.autoplay),v(this,"_buffer",Io.editor.buffer),v(this,"dragging",!1),v(this,"drawTimeout",void 0),v(this,"_editType",void 0),v(this,"editing",void 0),v(this,"eventTarget",new eo),v(this,"_fps",Io.editor.fps),v(this,"mashMedia",void 0),v(this,"mashMediaObject",void 0),v(this,"_loop",Io.editor.loop),v(this,"media",new Br),v(this,"_muted",!1),v(this,"precision",Io.editor.precision),v(this,"readOnly",!1),v(this,"_rect",void 0),v(this,"_selection",void 0),v(this,"_volume",Io.editor.volume);var i=e.autoplay,n=e.precision,r=e.loop,a=e.fps,o=e.volume,s=e.buffer,u=e.baseUrl,c=e.editType,l=e.readOnly,f=e.dimensions,d=e.mash,p=us(f)?fs(f):hs,y=Ea(f)?Xa(f):Oa;this._rect=m(m({},p),y),Pt(c)&&(this._editType=c),l&&(this.readOnly=!0),this.editing=!this.readOnly,ee(i)&&(this.autoplay=i),se(n)&&(this.precision=n),ee(r)&&(this._loop=r),se(a)&&(this._fps=a),se(o)&&(this._volume=o),se(s)&&(this._buffer=s),this.actions=new za(this),sn()||on(u),d&&this.load(d)}return f(t,[{key:"addClip",value:function(t,i){var n=this,r=i.clip,a=void 0===r?0:r,o=i.track,s=void 0===o?0:o,u=me(t)?t:[t],c=p(u,1)[0];return c?this.assureMash(t).then((function(){var t=n.mashMedia;ha(t);var i=t.tracks;ve(i.length);var r=he(s),o=r?i[s]:void 0,l=(null===o||void 0===o?void 0:o.clips)||[],h=null===o||void 0===o?void 0:o.dense,f=m(m({},n.selection.object),{},{clip:c}),d=r?0:u.length,p={clips:u,type:e.ActionType.AddClipToTrack,trackIndex:s,redoSelection:f,createTracks:d};if(h){var v=he(a)?a:l.length;p.insertIndex=v}else if(d)p.redoFrame=he(a)?a:0;else{Fo(o);var y=he(a)?a:o.frames;p.redoFrame=o.frameForClipNearFrame(c,y)}return n.actions.create(p),n.loadMashAndDraw()})):Promise.resolve()}},{key:"addEffect",value:function(t,i){var n=this.selection,r=this.actions,a=n.clip,o=n.mash;ha(o),xo(a);var s=a.content;as(s);var u=s.effects,c=he(i)?i:u.length,l=d(u);l.splice(c,0,t);var h={objects:u,undoObjects:d(u),redoObjects:l,type:e.ActionType.Move};r.create(h),o.draw()}},{key:"addFiles",value:function(t,i){var n=this,r=(this.eventTarget,this.rect),a=Promise.resolve([]);return Dh(t,r).forEach((function(e){a=a.then((function(t){return Jo("activity"),e.then((function(e){var i=e.mediaObject;return e.error,Er(i)?t.push(i):console.log(n.constructor.name,"addFiles NOT media object",i),t}))}))})),a.then((function(t){return n.addMedia(t,i).then((function(t){if(t.length){var i=nn(t.map((function(e){return e.type})));n.eventTarget.emit(e.EventType.Added,{definitionTypes:i})}return t}))}))}},{key:"addMedia",value:function(e,t){var i=this,n=me(e)?e:[e];if(!n.length)return Promise.resolve([]);var r=n.map((function(e){return Se(e),i.media.fromObject(e)}));if(!t)return Promise.resolve(r);var a=r.map((function(e){var t=e.id,i=e.type,n={};return e.isVector?n.containerId=t:n.contentId=t,i===Be&&(n.containerId=""),Ol(n)}));return this.addClip(a,t).then((function(){return r}))}},{key:"addTrack",value:function(){var t={mash:this.mashMedia};this.actions.create({redoSelection:t,type:e.ActionType.AddTrack,createTracks:1})}},{key:"assureMash",value:function(e){var t=this.selection.mash;if(!la(t)){var i={label:(me(e)?e[0]:e).content.definition.label,media:[],id:Ko()};return this.load(i)}return Promise.resolve()}},{key:"buffer",get:function(){return this._buffer},set:function(e){var t=Number(e);if(this._buffer!==t){this._buffer=t;var i=this.mashMedia;i&&(i.buffer=t)}}},{key:"can",value:function(t){var i=this.selection,n=i.track,r=i.clip,a=i.mash;switch(t){case e.MasherAction.Save:return this.actions.canSave;case e.MasherAction.Undo:return this.actions.canUndo;case e.MasherAction.Redo:return this.actions.canRedo;case e.MasherAction.Remove:return!(!r&&!n);case e.MasherAction.Render:return!this.actions.canSave&&!(null===a||void 0===a||!a.id||Xo(a.id))}}},{key:"clearActions",value:function(){this.actions.instances.length&&(this.actions=new za(this),this.eventTarget.emit(e.EventType.Action))}},{key:"clips",get:function(){var e;return(null===(e=this.mashMedia)||void 0===e?void 0:e.clips)||[]}},{key:"create",value:function(){return this.load({id:Ko()})}},{key:"currentTime",get:function(){var e=this.mashMedia;return e&&e.drawnTime?e.drawnTime.seconds:0}},{key:"define",value:function(e){var t=this;(Array.isArray(e)?e:[e]).forEach((function(e){var i=e.id;if(e.type,Te(i,"define id"),t.media.installed(i))console.warn(t.constructor.name,"define NOT redefining",i);else{var n=jr(e);t.media.install(n)}}))}},{key:"definitions",get:function(){var e=this,t=this.mashMedia;return t?t.definitionIds.map((function(t){return e.media.fromId(t)})):[]}},{key:"definitionsUnsaved",get:function(){return this.definitions.filter((function(e){var t=e.type,i=e.id;return!!lt(t)&&Xo(i)}))}},{key:"destroy",value:function(){var e=this.mashMedia;e&&(this.paused=!0,e.destroy(),delete this.mashMedia,this.clearActions(),this.selection.clear(),this.media.undefineAll())}},{key:"duration",get:function(){var e;return(null===(e=this.mashMedia)||void 0===e?void 0:e.duration)||0}},{key:"editType",get:function(){return this._editType||(this._editType=Je)}},{key:"endTime",get:function(){var e=this.mashMedia;return e?e.endTime.scale(this.fps,"floor"):fo()}},{key:"fps",get:function(){var e;return this._fps||(null===(e=this.mashMedia)||void 0===e?void 0:e.quantize)||Io.editor.fps},set:function(t){var i=Number(t);this._fps!==i&&(this._fps=i,this.eventTarget.emit(e.EventType.Fps),this.time=this.time.scale(this.fps))}},{key:"frame",get:function(){return this.time.frame},set:function(e){this.goToTime(fo(Number(e),this.fps))}},{key:"frames",get:function(){return this.endTime.frame}},{key:"gain",get:function(){return this.muted?0:this.volume}},{key:"goToTime",value:function(e){var t,i=this.fps,n=this.time.frame,r=(e?e.scaleToFps(i):fo(0,i)).frame,a=this.endTime.frame-1,o=a<1?0:Math.min(r,a);if(e&&n===o)return Promise.resolve();var s=null===(t=this.mashMedia)||void 0===t?void 0:t.seekToTime(fo(o,i));return s||Promise.resolve()}},{key:"handleAction",value:function(t){var i=this,n=this.mashMedia;Ce(n);var r=t.selection,a=r.mash;if(la(a)&&(a.clearPreview(),t instanceof Ta)){var o=t.property,s=t.target;"gain"===o&&Po(s)&&a.composition.adjustClipGain(s,a.quantize)}this.selection.object=r,(n.reload()||Promise.resolve()).then((function(){a||i.handleDraw(),i.eventTarget.emit(e.EventType.Action,{action:t})}))}},{key:"handleDraw",value:function(t){var i,n=this;!this.drawTimeout&&null!==(i=this.mashMedia)&&void 0!==i&&i.loading&&(this.drawTimeout=setTimeout((function(){n.eventTarget.dispatch(e.EventType.Draw),delete n.drawTimeout}),10))}},{key:"load",value:function(e){return this.mashMediaObject=e,this.loadMashMediaObject()}},{key:"loadMashMediaObject",value:function(){var e=this,t=this.rect,i=this.mashMediaObject;K(i,"mashMediaObject");var n=i.kind;return Ga(t)||n===Be?(delete this.mashMediaObject,this.mashMediaObjectLoadPromise(i).then((function(){return e.goToTime().then((function(){var t=e.mashMedia;la(t)&&t.clearPreview(),e.autoplay&&(e.paused=!1)}))}))):Promise.resolve()}},{key:"loadMashAndDraw",value:function(){var e=this.mashMedia;ha(e);var t={editing:!0,visible:!0};return this.paused||(t.audible=!0),e.loadPromise(t).then((function(){e.draw()}))}},{key:"mashMediaFromObject",value:function(e){var t=this.rect,i=this.buffer,n=this.gain,r=this.loop,a=m(m({},e),{},{mediaCollection:this.media,editor:this,emitter:this.eventTarget,size:Xa(t),buffer:i,gain:n,loop:r});return this.destroy(),this.mashMedia=wh(e,a)}},{key:"mashMediaObjectLoadPromise",value:function(e){var t=this,i=this.mashMediaFromObject(e);return i.loadPromise({editing:!0,visible:!0}).then((function(){t.selection.set(i),t.handleDraw()}))}},{key:"loop",get:function(){return this._loop},set:function(e){var t=!!e;this._loop=t;var i=this.mashMedia;i&&(i.loop=t)}},{key:"move",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Se(e,"clip"),Po(e))this.moveClip(e,t);else{To(e);var i=t.clip,n=void 0===i?0:i;this.moveEffect(e,n)}}},{key:"moveClip",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};xo(t);var n=i.clip,r=void 0===n?0:n,a=i.track,o=void 0===a?0:a;fe(r);var s=this.mashMedia;ha(s);var u=s.tracks,c=t.trackNumber,l={clip:t,trackIndex:o,undoTrackIndex:c,type:e.ActionType.MoveClip},h=!he(o);h&&(l.createTracks=1);var f=he(c)&&u[c].dense,d=he(o)&&u[o].dense,p=h?-1:u[o].clips.indexOf(t);if(d&&(l.insertIndex=r),f&&(l.undoInsertIndex=p,r<p&&(l.undoInsertIndex+=1)),!d||!f){var v=t.frame,m=(h?0:u[o].frameForClipNearFrame(t,r))-v;if(!m&&o===c)return;l.undoFrame=v,l.redoFrame=v+m}this.actions.create(l)}},{key:"moveEffect",value:function(t,i){var n=this.selection,r=this.actions,a=n.clip,o=n.mash;xo(a),ha(o);var s=a.content;as(s);var u=s.effects,c=u.indexOf(t),l=he(i)?i:u.length,h=c<l?l-1:l,f=u.filter((function(e){return e!==t}));f.splice(h,0,t);var p={type:e.ActionType.Move,objects:u,undoObjects:d(u),redoObjects:f};r.create(p),o.draw()}},{key:"moveTrack",value:function(){console.debug(this.constructor.name,"moveTrack coming soon...")}},{key:"muted",get:function(){return this._muted},set:function(e){var t=!!e;if(this._muted!==t){this._muted=t;var i=this.mashMedia;i&&(i.gain=this.gain)}}},{key:"pause",value:function(){this.paused=!0}},{key:"paused",get:function(){var e=this.mashMedia;return!e||e.paused},set:function(e){var t=this.mashMedia;t&&(t.paused=e),e&&this.redraw()}},{key:"play",value:function(){this.paused=!1}},{key:"position",get:function(){var e=0;return this.time.frame&&1!==(e=this.time.seconds/this.duration)&&(e=parseFloat(e.toFixed(this.precision))),e},set:function(e){this.goToTime(po(this.duration*Number(e),this.fps))}},{key:"positionStep",get:function(){return parseFloat("0.".concat("0".repeat(this.precision-1),"1"))}},{key:"rect",get:function(){return this._rect},set:function(t){var i=this;Ha(t),ks(this.rect,t)||(this._rect=t,(this.mashMediaObject?this.loadMashMediaObject():Promise.resolve()).then((function(){var n=i.mashMedia,r=i.rect,a=i.eventTarget;n&&(n.imageSize=Xa(r),a.emit(e.EventType.Resize,{rect:t}),i.redraw())})))}},{key:"redo",value:function(){this.actions.canRedo&&this.handleAction(this.actions.redo())}},{key:"redraw",value:function(){var t=this.mashMedia;t&&(t.clearPreview(),this.eventTarget.dispatch(e.EventType.Draw))}},{key:"removeClip",value:function(t){ha(this.mashMedia);var i=t.track,n=this.selection,r=(n.clip,{redoSelection:s(n,w),clip:t,track:i,index:i.clips.indexOf(t),type:e.ActionType.RemoveClip});this.actions.create(r)}},{key:"removeEffect",value:function(t){var i=this.selection,n=this.actions,r=i.clip,a=i.mash;xo(r),ha(a);var o=r.content;as(o);var s=o.effects,u={type:e.ActionType.Move,objects:s,undoObjects:d(s),redoObjects:s.filter((function(e){return e!==t}))};n.create(u),a.draw()}},{key:"removeTrack",value:function(e){console.debug(this.constructor.name,"removeTrack coming soon...")}},{key:"saved",value:function(t){var i=this;if(t){var n=this.mashMedia;Ce(n),Object.entries(t).forEach((function(e){var t=p(e,2),r=t[0],a=t[1];n.id===r?n.id=a:i.media.installed(r)?i.media.updateDefinitionId(r,a):console.warn(i.constructor.name,"saved could not find",r)}))}this.actions.save(),this.eventTarget.emit(e.EventType.Action)}},{key:"selection",get:function(){if(this._selection)return this._selection;var e=Do();return e.editor=this,this._selection=e}},{key:"svgElement",get:function(){return uu()},set:function(e){cu(e)}},{key:"previewItems",value:function(e){var t=this.mashMedia,i=this.rect,n=t?t.color:void 0,r=Xa(i),a=gu(r,mu(r,"",n)),o=Promise.resolve([a]);if(!t)return o;var s=e&&this.paused?this:void 0;return o.then((function(e){return t.previewItemsPromise(s).then((function(t){return[].concat(d(e),d(t))}))}))}},{key:"time",get:function(){var e;return(null===(e=this.mashMedia)||void 0===e?void 0:e.time)||fo(0,this.fps)},set:function(e){this.goToTime(e)}},{key:"timeRange",get:function(){var e;return(null===(e=this.mashMedia)||void 0===e?void 0:e.timeRange)||uo(0,this.fps)}},{key:"undo",value:function(){this.actions.canUndo&&this.handleAction(this.actions.undo())}},{key:"unload",value:function(){this.destroy()}},{key:"updateDefinition",value:function(e,t){var i=e.id,n=(e.type,e.id||t.id);Te(n);var r=t||this.media.fromId(i),a=r.id,o=a!==n;console.log(this.constructor.name,"updateDefinition",o,e),o&&(this.media.updateDefinitionId(r.id,n),console.log(this.constructor.name,"updateDefinition called updateDefinitionId",r.id,n),Object.assign(r,e),Vr(r)&&(delete r.request.response,Sc(r)&&delete r.loadedVideo,$l(r)&&delete r.loadedAudio,Sh(r)&&delete r.loadedImage));var s=this.mashMedia;return s&&o?(s.tracks.flatMap((function(e){return e.clips})).forEach((function(e){e.containerId===a&&e.setValue(i,"containerId"),e.contentId===a&&e.setValue(i,"contentId")})),this.loadMashAndDraw()):Promise.resolve()}},{key:"volume",get:function(){return this._volume},set:function(t){var i=Number(t);if(this._volume!==i){fe(i),this._volume=i,pe(i)&&(this.muted=!1);var n=this.mashMedia;n&&(n.gain=this.gain),this.eventTarget.emit(e.EventType.Volume)}}}]),t}();e.editorSingleton=void 0;var Eh=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return m({autoplay:Io.editor.autoplay,precision:Io.editor.precision,loop:Io.editor.loop,fps:Io.editor.fps,volume:Io.editor.volume,buffer:Io.editor.buffer},e)},Vh=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.editorSingleton=new zh(Eh(t))},Rh=function(e){return J(e)&&"changeHandler"in e},Oh=function(e,t,i){var n=e.filter((function(e){return!!Rh(e)&&e.property.group===t&&e.selectType===i}));return Object.fromEntries(n.map((function(e){var t=e.name,i=e.property.name;return[t||i,e]})))},_h=function(e){return Object.fromEntries(Object.entries(e).map((function(e){return[e[0],e[1].value]})))},jh=function(e){c(i,e);var t=l(i);function i(){return h(this,i),t.apply(this,arguments)}return f(i,[{key:"contentPreviewItemPromise",value:function(e,t,i,n){return console.trace(this.constructor.name,"contentPreviewItemPromise"),Promise.resolve(mu(e,"","currentColor"))}},{key:"mutable",value:function(){return!0}}]),i}(th(Fl(Fc(Qs)))),Nh=function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),v(u(e),"type",Be),e}return f(i,[{key:"instanceFromObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new jh(this.instanceArgs(e))}},{key:"loadPromise",value:function(e){var t=this,i=e.editing;if(!e.audible)return Promise.resolve();if(this.loadedAudio)return Promise.resolve();var n=(i?this.preferredTranscoding(Be):this).request;return Xc(n).then((function(e){if(qe(e))return W(e.error);var i=e.data;t.loadedAudio=i}))}}]),i}(ch(ss(ul(dl)))),qh=function(e){return e.id?new Nh(e):W(V.MediaId)},Bh=function(e){return qh({id:e})},Uh=function(e){var t=e.mediaId;return(e.definition||Bh(t)).instanceFromObject(e)},Lh=function(e){return Uh({id:e})};_r[Be]=qh;var Gh=function(e){return ts(e)&&"path"in e},Hh=function(t){c(n,t);var i=l(n);function n(){var t;h(this,n);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];t=i.call.apply(i,[this].concat(a)),v(u(t),"effects",[]),v(u(t),"hasIntrinsicSizing",!0);var s=a[0];return t.addProperties(s,Lo({tweenable:!0,name:"width",type:e.DataType.Percent,group:e.DataGroup.Size,defaultValue:1,max:2})),t.addProperties(s,Lo({tweenable:!0,name:"height",type:e.DataType.Percent,group:e.DataGroup.Size,defaultValue:1,max:2})),t}return f(n,[{key:"audibleCommandFiles",value:function(e){throw new Error("Method not implemented.")}},{key:"audibleCommandFilters",value:function(e){throw new Error("Method not implemented.")}},{key:"contentPreviewItemPromise",value:function(e,t,i,n){throw new Error("Method not implemented.")}},{key:"contentRects",value:function(e){throw new Error("Method not implemented.")}},{key:"contentSvgFilter",value:function(e,t,i,n,r){throw new Error("Method not implemented.")}},{key:"contentSvgItemPromise",value:function(e,t,i,n){throw new Error("Method not implemented.")}},{key:"effectsCommandFiles",value:function(e){throw new Error("Method not implemented.")}},{key:"svgItemForPlayerPromise",value:function(e,t,i){throw new Error("Method not implemented.")}},{key:"svgItemForTimelinePromise",value:function(e,t,i){throw new Error("Method not implemented.")}},{key:"canColor",value:function(e){return!this.isDefault&&!this.isTweeningColor(e)}},{key:"containerColorCommandFilters",value:function(e){var t=[],i=this.colorFilter,n=this.isDefault,r=e.contentColors,a=e.containerRects,o=e.videoRate,s=e.duration;we(r,"contentColors");var u=p(a,2),c=u[0],l=u[1],h=p(r,2),f=h[0],v=h[1],m=n?c:Es.apply(void 0,d(a)),y={videoRate:o,duration:s};i.setValue(f||er,"color"),i.setValue(v,"color".concat(Cr)),i.setValue(m.width,"width"),i.setValue(m.height,"height");var g=n;return i.setValue(g?l.width:void 0,"width".concat(Cr)),i.setValue(g?l.height:void 0,"height".concat(Cr)),t.push.apply(t,d(i.commandFilters(y))),t}},{key:"containerCommandFilters",value:function(e,t){var i=[],r=e.contentColors,u=e.commandFiles,c=e.filterInput,l=be(r);if(this.requiresAlpha(e,!!t.size)){Te(c,"container input"),e.contentColors;var h=s(e,F),f=m(m({},h),{},{filterInput:c});i.push.apply(i,d(a(o(n.prototype),"containerCommandFilters",this).call(this,f,t)))}else if(this.isDefault||l){var p=this.id;c||(c=$s(u,p,!0)),Te(c,"final input"),i.push.apply(i,d(this.containerFinalCommandFilters(m(m({},e),{},{filterInput:c}))))}return i}},{key:"initialCommandFilters",value:function(e,t){var i=[],n=(e.contentColors,s(e,S)),r=n.commandFiles,a=n.track,o=n.filterInput,u=n.containerRects,c=n.videoRate,l=o,h=this.requiresAlpha(e,!!t.size),f=this.isDefault,p=t.size?Es.apply(void 0,d(u)):u[0],v=ja(p),y="content-".concat(a),g="container-".concat(a);if(!t.canColor&&ke(l)&&!f)if(h){var k="format",T=Jo(k),b={inputs:[l],ffmpegFilter:k,options:{pix_fmts:"yuv420p"},outputs:[T]};i.push(b),l=T}else if(!Ra(v,p)){var w=m(m({},e),{},{contentColors:[rr,rr],outputSize:v});i.push.apply(i,d(this.colorBackCommandFilters(w,"".concat(y,"-back"))));var F=Qi(Qi(i).outputs);Te(l,"overlay input"),i.push.apply(i,d(this.overlayCommandFilters(F,l))),l=Qi(Qi(i).outputs)}if(i.length?Qi(i).outputs=[y]:ke(l)&&y!==l&&i.push(this.copyCommandFilter(l,a)),h){var I=this.id,C=$s(r,I,!0);Te(C,"scale input");var P=m(m({},e),{},{contentColors:[rr,rr],outputSize:p});i.push.apply(i,d(this.colorBackCommandFilters(P,"".concat(g,"-back"))));var x=Qi(Qi(i).outputs);i.push.apply(i,d(this.scaleCommandFilters(m(m({},e),{},{filterInput:C})))),Te(l=Qi(Qi(i).outputs),"overlay input"),i.push.apply(i,d(this.overlayCommandFilters(x,l)));var A={duration:0,videoRate:c};Te(l=Qi(Qi(i).outputs),"crop input");var M=this.cropFilter;M.setValue(p.width,"width"),M.setValue(p.height,"height"),M.setValue(0,"x"),M.setValue(0,"y"),i.push.apply(i,d(M.commandFilters(m(m({},A),{},{filterInput:l})))),Te(l=Qi(Qi(i).outputs),"format input");var D={inputs:[l],ffmpegFilter:"format",options:{pix_fmts:h?"yuv420p":"yuva420p"},outputs:[g]};i.push(D)}return i}},{key:"intrinsicRect",value:function(){var e=this.definition,t=e.pathHeight,i=e.pathWidth;return m({width:i,height:t},hs)}},{key:"intrinsicsKnown",value:function(e){return!0}},{key:"isTweeningColor",value:function(e){var t=e.contentColors;if(!be(t))return!1;var i=p(t,2);return i[0]!==i[1]}},{key:"isTweeningSize",value:function(e){var t=e.containerRects;return!!be(t)&&!ks.apply(void 0,d(t))}},{key:"loadPromise",value:function(e){return Promise.resolve()}},{key:"pathElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=this.definition,n=this.intrinsicRect(!0);if(!Ga(n))return mu(e,"",t);var r=i.path,a=bu(r,"");return Ru(a,n,e),a}},{key:"requiresAlpha",value:function(e,t){var i=e.contentColors,n=be(i);return this.isDefault?!n&&(ee(t)?t:this.isTweeningSize(e)):!n||this.isTweeningColor(e)}},{key:"visibleCommandFiles",value:function(t){var i=this.isDefault,n=this.id,r=this.requiresAlpha(t),a=this.isTweeningColor(t);if(i&&!r)return[];var o=this.definition,s=o.path,u=t.contentColors,c=void 0===u?[]:u,l=t.containerRects,h=t.time,f=t.videoRate;we(l,"containerRects");var d=De(h)?h.lengthSeconds:0,v=p(l,2),y=v[0],g=v[1],k=m(m({},hs),Es(y,g)),T=k.width,b=k.height,w=p(c,1)[0];r?w=er:a&&(w=Qn);var F="none";i?F=er:r&&(F=Qn);var S=i?k:this.intrinsicRect(),I=S.width,C=S.height,P='width="'.concat(I,'" height="').concat(C,'"'),x=Vu(S,k),A=[];A.push('<svg viewBox="0 0 '.concat(T," ").concat(b,'" xmlns="').concat(qi,'">')),A.push("<g ".concat(P,' transform="').concat(x,'" >')),A.push("<rect ".concat(P,' fill="').concat(F,'"/>')),i||A.push('<path d="'.concat(s,'" fill="').concat(w,'"/>')),A.push("</g>"),A.push("</svg>");var M=A.join(""),D={};return d&&(D.loop=1,D.framerate=f,D.t=d),[{type:e.GraphFileType.Svg,file:n,content:M,input:!0,inputId:n,definition:o,options:D}]}}]),n}(ol(Fc(Qs))),Wh=function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=r[0];e=t.call(this,o),v(u(e),"isVector",!0),v(u(e),"path",""),v(u(e),"pathHeight",0),v(u(e),"pathWidth",0),v(u(e),"type",Ge);var s=o.path,c=o.pathHeight,l=o.pathWidth;return s&&(e.path=s),pe(l)&&(e.pathWidth=l),pe(c)&&(e.pathHeight=c),e}return f(i,[{key:"definitionIcon",value:function(e){var t=this.id,i=this.pathHeight,n=this.pathWidth,r=this.path;if(t===Yo)return Promise.resolve(gu(e,mu(e,"","currentColor")));var a={width:n,height:i};if(Ga(a)&&ke(r)){var o=La(a,e,!0),s=m(m({},o),Is(e,o)),u=bu(r);return Ru(u,a,s),Promise.resolve(gu(e,u))}}},{key:"instanceFromObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new Hh(this.instanceArgs(e))}},{key:"toJSON",value:function(){var e=a(o(i.prototype),"toJSON",this).call(this);return this.path&&(e.path=this.path),pe(this.pathHeight)&&(e.pathHeight=this.pathHeight),pe(this.pathWidth)&&(e.pathWidth=this.pathWidth),e}}]),i}(pl(ul(dl))),Jh=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=[],n=2,r=3600,a=!1,o=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)||e;return o>=r&&(e>=r?(i.push(String(Math.floor(e/r)).padStart(n,"0")),a=!0,e%=r):i.push("00:")),r=60,(a||o>=r)&&(a&&i.push(":"),e>=r?(i.push(String(Math.floor(e/r)).padStart(n,"0")),a=!0,e%=r):i.push("00:")),r=1,a||o>=r?(a&&i.push(":"),e>=r?(i.push(String(Math.floor(e/r)).padStart(n,"0")),a=!0,e%=r):i.push("00")):i.push("00"),t>1&&(10===t&&(n=1),i.push("."),e?(e=1===n?Math.round(10*e)/10:Math.round(100*e)/100,e=Number(String(e).slice(2)),i.push(String(e).padEnd(n,"0"))):i.push("0".padStart(n,"0"))),i.join("")},Kh=function(e,t,i){if(!ke(e)||!pe(i))return Ts;var n=globalThis.document.createElement("canvas").getContext("2d");K(n,"ctx"),n.font="".concat(i,"px ").concat(t);var r=n.measureText(e),a=r.actualBoundingBoxAscent,o=r.actualBoundingBoxDescent,s=r.actualBoundingBoxLeft;return{x:s,y:a,width:s+r.actualBoundingBoxRight,height:a+o}},Xh=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return ke(t)?"".concat(e," ").concat(t).concat(1===e?"":i):t},Yh=1e3,Zh=function(t){c(n,t);var i=l(n);function n(){var e;h(this,n);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var o=r[0];o.lock||(o.lock=""),e=i.call.apply(i,[this].concat(r)),v(u(e),"_colorFilter",void 0),v(u(e),"hasIntrinsicSizing",!0),v(u(e),"_intrinsicRect",void 0),v(u(e),"_textFilter",void 0);var s=o.intrinsic;return ys(s)&&(e._intrinsicRect=s),e}return f(n,[{key:"canColor",value:function(e){return!0}},{key:"canColorTween",value:function(e){return!0}},{key:"colorFilter",get:function(){return this._colorFilter||(this._colorFilter=wc("color"))}},{key:"initialCommandFilters",value:function(t,i){var n,r=this,a=[],o=t.contentColors,s=void 0===o?[]:o,u=t.outputSize,c=t.track,l=t.filterInput,h=t.containerRects,f=t.videoRate,y=t.commandFiles,g=t.duration,k=l;k&&a.push(this.copyCommandFilter(k,c));var T=p(h,2),b=T[0],w=T[1],F=b.height,S=b.width,I=Es.apply(void 0,d(h)),C="",P=!!k||i.size;if(P){var x=k?Qn:ir,A=m(m({},t),{},{contentColors:[x,x],outputSize:I});a.push.apply(a,d(this.colorBackCommandFilters(A))),C=Qi(Qi(a).outputs)}var M=y.find((function(t){return t.inputId===r.id&&t.type===e.GraphFileType.Txt}));Ce(M,"text file");var D=M.resolved;Te(D,"textfile");var z=y.find((function(e){return e.inputId===r.id&&e.type===Le}));Ce(z,"font file");var E=z.resolved;Te(E,"fontfile");var V=this.textFilter,R=this.lock,O=this.intrinsicRect(),_=O.x*(b.width/O.width),j=0,N=p(s,2),q=N[0],B=void 0===q?er:q,U=N[1];Te(B);var L=O.x*(w.width/O.width),G=0,H=Yh/O.height,W=Math.round(F*H),J=Math.round(w.height*H),K=(n={x:_,y:j,width:S,height:W,color:B,textfile:D,fontfile:E,stretch:!Xt(R),intrinsicHeight:O.height,intrinsicWidth:O.width},v(n,"x".concat(Cr),L),v(n,"y".concat(Cr),G),v(n,"color".concat(Cr),U),v(n,"height".concat(Cr),J),v(n,"width".concat(Cr),w.width),n);V.setValues(K);var X={dimensions:u,videoRate:f,duration:g,filterInput:k};if(a.push.apply(a,d(V.commandFilters(X))),P){Te(k=Qi(Qi(a).outputs),"overlay filterInput"),a.push.apply(a,d(this.overlayCommandFilters(C,k))),Te(k=Qi(Qi(a).outputs),"crop filterInput");var Y={duration:0,videoRate:f,filterInput:k},Z=this.cropFilter;Z.setValue(I.width,"width"),Z.setValue(I.height,"height"),Z.setValue(0,"x"),Z.setValue(0,"y"),a.push.apply(a,d(Z.commandFilters(Y)))}return a}},{key:"intrinsicRect",value:function(){return this._intrinsicRect||(this._intrinsicRect=this.intrinsicRectInitialize())}},{key:"intrinsicRectInitialize",value:function(){var e=this.definition.family;Te(e);var t=this.string,i=Yh,n=m({width:0,height:i},hs);return t?Kh(t,e,i):n}},{key:"intrinsicsKnown",value:function(e){return!(e.size&&!ys(this._intrinsicRect)&&!this.definition.family)}},{key:"loadPromise",value:function(e){return this.definition.loadPromise(e)}},{key:"pathElement",value:function(e){var t=this.string,i=this.definition.family,n=Vu(this.intrinsicRect(!0),e);return Nu(t,i,Yh,n)}},{key:"setValue",value:function(e,t,i){a(o(n.prototype),"setValue",this).call(this,e,t,i),i||"string"!==t||delete this._intrinsicRect}},{key:"textFilter",get:function(){return this._textFilter||(this._textFilter=wc("text"))}},{key:"toJSON",value:function(){var e=a(o(n.prototype),"toJSON",this).call(this);return e.intrinsic=this.intrinsicRect(!0),e}},{key:"visibleCommandFiles",value:function(t){var i=a(o(n.prototype),"visibleCommandFiles",this).call(this,t),r=this.string,s={definition:this.definition,type:e.GraphFileType.Txt,file:this.id,inputId:this.id,content:r};return i.push(s),i}}]),n}(ol(Fc(Qs))),$h=1e3,Qh=function(t){c(n,t);var i=l(n);function n(t){var r;h(this,n),r=i.call(this,t),v(u(r),"_family",""),v(u(r),"_intrinsicRect",void 0),v(u(r),"isVector",!0),v(u(r),"loadedFont",void 0),v(u(r),"string",""),v(u(r),"type",Le);var a=t.string,o=t.label;return r.string=a||o||Io.font.string,r.properties.push(Lo({name:"string",custom:!0,type:e.DataType.String,defaultValue:r.string})),r.properties.push(Lo({name:"height",tweenable:!0,custom:!0,type:e.DataType.Percent,defaultValue:.3,max:2,group:e.DataGroup.Size})),r.properties.push(Lo({name:"width",tweenable:!0,custom:!0,type:e.DataType.Percent,defaultValue:.8,max:2,group:e.DataGroup.Size})),r}return f(n,[{key:"definitionIcon",value:function(e){var t=this;return this.loadFontPromise(this.preferredTranscoding(Le)).then((function(){var i=t.string,n=t.family;Te(n),Te(i);var r=t.intrinsicRect,a=La(r,e,!0),o=m(m({},a),Is(e,a)),s=Vu(r,o),u=Nu(t.string,n,$h,s);return Promise.resolve(gu(e,u))}))}},{key:"family",get:function(){if(!this._family){var e=this.loadedFont;if(Yr(e)){var t=e.family;ke(t)&&(this._family=t)}}return this._family},set:function(e){this._family=e}},{key:"graphFiles",value:function(e){if(!e.visible)return[];var t=this.request.endpoint;In(t);var i=Cn(t);return[{type:Le,file:i,definition:this}]}},{key:"instanceArgs",value:function(t){var i=t||{};return Z(i.lock)&&(i.lock=e.Orientation.V),a(o(n.prototype),"instanceArgs",this).call(this,i)}},{key:"instanceFromObject",value:function(e){return new Zh(this.instanceArgs(e))}},{key:"intrinsicRect",get:function(){return this._intrinsicRect||(this._intrinsicRect=this.intrinsicRectInitialize())}},{key:"intrinsicRectInitialize",value:function(){var e=$h,t=m({width:0,height:e},hs),i=this.family,n=this.string;if(!ke(i)||!ke(n))return t;var r=Kh(n,i,e);return console.log(this.constructor.name,"intrinsicRectInitialize",r),r}},{key:"loadFontPromise",value:function(e){var t=this;if(this.loadedFont)return Promise.resolve(this.loadedFont);var i=e.request;return Yc(i).then((function(e){if(qe(e))return W(e.error);var i=e.data;return t.family=i.family,t.loadedFont=i,i}))}},{key:"loadPromise",value:function(e){if(this.family)return Promise.resolve();var t=(e.editing?this.findTranscoding(Le,"woff","woff2"):void 0)||this;return this.loadFontPromise(t).then(Ni)}},{key:"toJSON",value:function(){var e=this.string;return m(m({},a(o(n.prototype),"toJSON",this).call(this)),{},{string:e})}}]),n}(pl(ul(dl))),ef={label:"Butcherman",id:"com.moviemasher.font.butcherman",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Butcherman"}}},tf={label:"Croissant One",id:"com.moviemasher.font.croissant-one",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Croissant+One"}}},nf={label:"Germania One",id:"com.moviemasher.font.germania-one",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Germania+One"}}},rf={label:"Kenia",id:"com.moviemasher.font.kenia",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Kenia"}}},af={label:"Luckiest Guy",id:"com.moviemasher.font.luckiest-guy",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Luckiest+Guy"}}},of={label:"Monoton",id:"com.moviemasher.font.monoton",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Monoton"}}},sf={label:"Oleo Script",id:"com.moviemasher.font.oleo-script",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Oleo+Script"}}},uf={label:"Shojumaru",id:"com.moviemasher.font.shojumaru",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Shojumaru"}}},cf={label:"Rubik+Dirt",id:"com.moviemasher.font.rubik-dirt",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=Rubik+Dirt"}}},lf=function(e){var t=Nr[Le].find((function(t){return t.id===e}));if(t)return t},hf=function(e){var t=e.id,i=void 0===t?Bl:t,n=lf(i);if(n)return n;var r=m(m({},e),{},{type:Le,id:i});return new Qh(r)},ff=hf(m({id:Bl},{label:"League Spartan",type:"font",request:{endpoint:{protocol:"https:",hostname:"fonts.googleapis.com",pathname:"/css2",search:"?family=League+Spartan"}}})),df=function(e){return hf({id:e})};_r[Le]=hf,Nr[Le].push(ff,hf(ef),hf(tf),hf(rf),hf(nf),hf(af),hf(of),hf(sf),hf(uf),hf(cf));var pf=function(e){c(i,e);var t=l(i);function i(){return h(this,i),t.apply(this,arguments)}return f(i,[{key:"visibleCommandFiles",value:function(e){var t=[],i=e.visible,n=e.time,r=e.videoRate;if(!i)return t;var a=this.graphFiles(e),o=p(a,1)[0],s=De(n)?n.lengthSeconds:0,u={loop:1,framerate:r};s&&(u.t=s);var c=this.id,l=m(m({},o),{},{inputId:c,options:u});return t.push(l),t.push.apply(t,d(this.effectsCommandFiles(e))),t}},{key:"graphFiles",value:function(e){var t=e.visible,i=(e.editing,[]);if(!t)return i;var n=this.definition,r=n.request,a=Cn(r.endpoint);a||console.log(this.constructor.name,"graphFiles",r),Te(a);var o={input:!0,type:Ge,file:a,definition:n};return i.push(o),i}},{key:"svgItemForTimelinePromise",value:function(e,t,i){var n=this.definition.preferredTranscoding(Ge).request;return Zc(n).then((function(t){if(qe(t))return W(t.error);var i=t.data.src,n=m({},e);return qu(i,n)}))}}]),i}(mh(Fl(ol(Fc(Qs))))),vf=function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),v(u(e),"loadedImage",void 0),v(u(e),"type",Ge),e}return f(i,[{key:"definitionIcon",value:function(e){var t=this.preferredTranscoding(Ge);return Zc(t.request).then((function(t){if(qe(t))return W(t.error);var i=t.data;Ha(i);var n=i.width,r=i.height,a=i.src,o=La({width:n,height:r},e,!0),s=m(m({},o),Is(e,o)),u=m({},s);return qu(a,u).then((function(t){return gu(e,t)}))}))}},{key:"instanceFromObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new pf(this.instanceArgs(e))}},{key:"loadPromise",value:function(e){var t=this,i=e.editing;if(!e.visible)return Promise.resolve();if(this.loadedImage)return Promise.resolve();var n=(i?this.preferredTranscoding(Ge):this).request;return Zc(n).then((function(e){if(qe(e))return W(e.error);var i=e.data;t.loadedImage=i}))}}]),i}(yh(ss(pl(ul(dl))))),mf={label:"Color",type:"image",request:{response:{color:"#FFFFFF"}}},yf={label:"Rectangle",type:"image",request:{response:{}}},gf=function(e){return Te(e.id,"imageDefinition id"),new vf(e)},kf=function(e){var t=Nr[Ge].find((function(t){return t.id===e}));return t||gf({id:e})},Tf=function(e){var t=e.mediaId;return(e.definition||kf(t)).instanceFromObject(e)},bf=function(e){return Tf({id:e})};_r[Ge]=gf,Nr[Ge].push(new xl(m({id:ns},mf)),new Wh(m({id:Yo},yf)));var wf=function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),v(u(e),"speed",1),e}return f(i,[{key:"visibleCommandFiles",value:function(e){var t=a(o(i.prototype),"visibleCommandFiles",this).call(this,e),n=e.streaming;return e.visible&&n?(t.forEach((function(e){var t=e.options,i=void 0===t?{}:t;i.loop=1,i.re="",e.options=i})),t):t}},{key:"graphFiles",value:function(e){var t=e.time,n=e.clipTime,r=e.editing,s=e.visible,u=this.definitionTime(t,n),c=m(m({},e),{},{time:u}),l=a(o(i.prototype),"graphFiles",this).call(this,c);if(s){var h=this.definition;if(r){var f=h.framesArray(u).map((function(e){return{type:Ge,file:"",input:!0,definition:h}}));f.push.apply(f,d(f))}else{var p={type:Je,file:"",definition:h,input:!0};l.push(p)}}return l}},{key:"toJSON",value:function(){var e=a(o(i.prototype),"toJSON",this).call(this);return 1!==this.speed&&(e.speed=this.speed),e}}]),i}(th(mh(Fl(ol(Fc(Qs)))))),Ff=function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o=r[0];e=t.call(this,o),v(u(e),"begin",Io.definition.videosequence.begin),v(u(e),"fps",Io.definition.videosequence.fps),v(u(e),"increment",Io.definition.videosequence.increment),v(u(e),"padding",void 0),v(u(e),"pattern","%.jpg"),v(u(e),"type",We);var s=o.padding,c=o.begin,l=o.fps,f=o.increment,d=o.pattern;if(he(c)&&(e.begin=c),l&&(e.fps=l),f&&(e.increment=f),d&&(e.pattern=d),s)e.padding=s;else{var p=e.begin+(e.increment*e.framesMax-e.begin);e.padding=String(p).length}return e}return f(i,[{key:"framesArray",value:function(e){var t=this.duration,i=this.fps;return e.durationFrames(t,i)}},{key:"framesMax",get:function(){var e=this.fps,t=this.duration;return Math.floor(e*t)-2}},{key:"instanceFromObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new wf(this.instanceArgs(e))}},{key:"toJSON",value:function(){var e=a(o(i.prototype),"toJSON",this).call(this),t=Io.definition.videosequence,n=this.pattern,r=this.increment,s=this.begin,u=this.fps,c=this.padding;return n!==t.pattern&&(e.pattern=n),r!==t.increment&&(e.increment=r),s!==t.begin&&(e.begin=s),u!==t.fps&&(e.fps=u),c!==t.padding&&(e.padding=c),e}}]),i}(ch(yh(ss(ul(dl))))),Sf=function(e){return Te(e.id),new Ff(e)},If=function(e){return Sf({id:e})},Cf=function(e){var t=e.mediaId;return(e.definition||If(t)).instanceFromObject(e)},Pf=function(e){return Cf({id:e})};_r[We]=Sf;var xf=function(e){c(i,e);var t=l(i);function i(){var e;h(this,i);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r)),v(u(e),"_foreignElement",void 0),v(u(e),"loadedVideo",void 0),e}return f(i,[{key:"foreignElement",get:function(){var e=this._foreignElement;if(e)return e;var t=globalThis.document.createElementNS(qi,"foreignObject");return this._foreignElement=t}},{key:"graphFiles",value:function(e){var t=[],i=e.audible,n=e.visible,r=e.icon,a=this.definition,o=a.request,s=Cn(o.endpoint);if(Te(s),n&&!r){var u={input:!0,type:Je,file:s,definition:a};t.push(u)}if(i&&(!a.duration||this.mutable())&&!this.muted){var c={input:!0,type:Be,definition:a,file:""};t.push(c)}return t}},{key:"loadPromise",value:function(e){console.log(this.constructor.name,"loadPromise",e);var t=[],i=this.definition,n=i.audio,r=e.visible,a=e.audible;if(n&&a&&t.push(i.preloadAudioPromise),r){var o=i.preferredTranscoding(We,Je);if(Vn(o)){var s=n&&a&&i.preferredTranscoding(Be,Je);if(o!==s){var u=o.type,c=o.request;console.log(this.constructor.name,"loadPromise visibleTranscoding",o),u===Je?t.push(el(c).then((function(e){if(qe(e))return W(e.error)}))):t.push(this.sequenceImagesPromise(e))}else console.log(this.constructor.name,"loadPromise",o,"===",s)}else console.log(this.constructor.name,"loadPromise NOT isTranscoding",o)}return Promise.all(t).then(Ni)}},{key:"previewVideoPromise",value:function(e){var t=this,i=this.loadedVideo;if(i)return Promise.resolve(i);var n=e.request;return el(n).then((function(e){if(qe(e))return W(e.error);var i=e.data.cloneNode();return t.loadedVideo=i,t.foreignElement.appendChild(i),i}))}},{key:"sequenceImagesPromise",value:function(e){var t=this,i=e.time,n=e.clipTime,r=[];if(i.isRange){ze(i);var a=i.times.map((function(e){return t.definitionTime(e,n)})),o=p(a,2),s=o[0],u=o[1],c=ho(s,u);r.push.apply(r,d(c.frameTimes))}else r.push(this.definitionTime(i,n));var l=r.map((function(e){return t.definition.loadedImagePromise(e)}));return Promise.all(l).then(Ni)}},{key:"sequenceItemPromise",value:function(e,t){return this.definition.loadedImagePromise(t).then((function(t){var i=t.src,n=La(Xa(t),Xa(e));return qu(i,n)}))}},{key:"serverPromise",value:function(e){console.log(this.constructor.name,"serverPromise",e);var t=this.definition.audio;return e.visible||t?this.definition.serverPromise(e):Promise.resolve()}},{key:"svgItemForPlayerPromise",value:function(e,t,i){var n=this.loadedVideo,r=this.definitionTime(t,i);if(n)return Promise.resolve(this.videoForPlayerPromise(e,r));var a=this.definition.previewTranscoding;switch(a.type){case Je:return this.videoItemForPlayerPromise(a,e,r);case We:return this.sequenceItemPromise(e,r)}return W(V.Type)}},{key:"svgItemForTimelinePromise",value:function(e,t,i){var n=this.definitionTime(t,i);return this.sequenceItemPromise(e,n)}},{key:"unload",value:function(){delete this._foreignElement,delete this.loadedVideo}},{key:"videoForPlayerPromise",value:function(e,t){var n=this.loadedVideo;Hr(n);var r=i.clientCanMaskVideo;r&&du(this.foreignElement,e),n.currentTime=t.seconds;var a=e.width,o=e.height;return n.width=a,n.height=o,r?this.foreignElement:n}},{key:"videoItemForPlayerPromise",value:function(e,t,i){var n=this;return console.log(this.constructor.name,"videoItemForPlayerPromise",i,e),this.previewVideoPromise(e).then((function(){return n.videoForPlayerPromise(t,i)}))}}],[{key:"clientCanMaskVideo",get:function(){var e=this._clientCanMaskVideo;if(ee(e))return e;var t=globalThis.navigator.userAgent,i=t.includes("Safari")&&!t.includes("Chrome");return this._clientCanMaskVideo=!i}}]),i}(th(mh(Fl(ol(Fc(Qs))))));v(xf,"_clientCanMaskVideo",void 0);var Af=new Map,Mf=function(e,t){t.currentTime=e.seconds},Df=function(e,t){console.log("videoImagePromise",e.currentTime);var i=Xa(e),n=Ga(t)?La(i,t):i,r=n.width,a=n.height,o=zf(n),s=p(o,2),u=s[0];s[1].drawImage(e,0,0,r,a);var c=new Image;return c.src=u.toDataURL(),c.decode().then((function(){return c}))},zf=function(e){var t=globalThis.document.createElement("canvas"),i=e.width,n=e.height;t.height=n,t.width=i;var r=t.getContext("2d");return Ce(r),[t,r]},Ef=function(e,t){var i=t.currentTime;return!i&&!e.frame||!po(i,e.fps).equalsTime(e)},Vf=function(e,t,i){console.log("imageFromVideoPromise",t);var n=new Promise((function(n){if(!Ef(t,e))return console.log("imageFromVideoPromise !seekNeeded",t),Af.delete(e),Df(e,i);console.log("imageFromVideoPromise seekNeeded",t),e.onseeked=function(){console.log("imageFromVideoPromise onseeked",t),e.onseeked=null,Df(e,i).then((function(i){console.log("imageFromVideoPromise resolving after videoImagePromise",t),Af.delete(e),n(i)}))},Mf(t,e)})),r=Af.get(e);return Af.set(e,n),r?(console.log("imageFromVideoPromise replacing promise",t),r.then((function(){return n}))):(console.log("imageFromVideoPromise setting promise",t),n)},Rf=function(e){c(i,e);var t=l(i);function i(e){var n;h(this,i),n=t.call(this,e),v(u(n),"loadedImages",new Map),v(u(n),"loadedVideo",void 0),v(u(n),"pattern","%.jpg"),v(u(n),"type",Je);var r=e.loadedVideo;return r&&(n.loadedVideo=r),n}return f(i,[{key:"definitionIcon",value:function(e){var t=this.previewTranscoding,i=fo(1);return this.imageFromTranscodingPromise(t,i).then((function(t){Ha(t);var i=t.width,n=t.height,r=t.src,a=La({width:i,height:n},e,!0),o=m(m({},a),Is(e,a)),s=m({},o);return qu(r,s).then((function(t){return gu(e,t)}))}))}},{key:"loadedImage",value:function(e,t){return this.loadedImages.get(this.loadedImageKey(e,t))}},{key:"loadedImageKey",value:function(e,t){var i=e.frame,n=e.fps,r="".concat(i,"@").concat(n);return Ga(t)?"".concat(r,"-").concat(Za(t)):r}},{key:"imageFromSequencePromise",value:function(e,t,i){throw new Error}},{key:"imageFromTranscodingPromise",value:function(e,t,i){var n=e.type,r=e.request;switch(n){case Ge:return Zc(r).then((function(e){return qe(e)?W(e.error):e.data}));case Je:return this.imageFromVideoTranscodingPromise(e,t,i);case We:return this.imageFromSequencePromise(e,t,i)}return W(V.Internal)}},{key:"imageFromVideoTranscodingPromise",value:function(e,t,i){var n=this;console.log(this.constructor.name,"imageFromVideoTranscodingPromise",t);var r=this.loadedImage(t,i);return r?Promise.resolve(r):el(e.request).then((function(e){if(qe(e))return W(e.error);var r=e.data,a=n.loadedImageKey(t,i);return Vf(r,t,i).then((function(e){return n.loadedImages.set(a,e),e}))}))}},{key:"instanceFromObject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new xf(this.instanceArgs(e))}},{key:"loadedImagePromise",value:function(e,t){console.log(this.constructor.name,"loadedImagePromise",e);var i=this.previewTranscoding;return this.imageFromTranscodingPromise(i,e,t)}},{key:"iconTranscoding",get:function(){return this.preferredTranscoding(Ge,We,Je)}},{key:"previewTranscoding",get:function(){return this.preferredTranscoding(We,Je)}}]),i}(ch(yh(ss(pl(ul(dl)))))),Of=function(e){return Te(e.id),new Rf(e)},_f=function(e){return Of({id:e})},jf=function(e){var t=e.mediaId;return(e.definition||_f(t)).instanceFromObject(e)},Nf=function(e){return jf({id:e})};_r[Je]=Of;var qf=function(e){return Pi(e)&&"type"in e&&rh(e.type)};function Bf(e){qf(e)||W(e,"DecodeOutput")}var Uf="alpha",Lf="audible",Gf="duration",Hf="size",Wf=[Uf,Lf,Gf,Hf],Jf=function(e){return J(e)&&"types"in e&&me(e.types)};function Kf(e){Jf(e)||W(e,"ProbeOptions")}var Xf=function(e){return qf(e)&&"options"in e&&Jf(e.options)};function Yf(e){Xf(e)||W(e,"ProbeOutput")}var Zf="en",$f={},Qf=function(e){if(e)return $f[e]},ed=function(e,t,i){var n=Qf(t);if(n)return(0,n.requestPromise)(e).then((function(e){return al(e,i)}));var r={path:e};return Promise.resolve(r)},td=function(e,t){var i=Qf(t);return i?i.requestPromise(e).then(al):{path:e}},id=function(e,t){var i=Qf(t);return i?i.extension:Jc(e)},nd=function(e){return Pi(e)&&"type"in e&&nt(e.type)};e.Action=fa,e.ActionFactory=Da,e.Actions=za,e.AddClipToTrackAction=ga,e.AddTrackAction=ya,e.AlphaProbe=Uf,e.AlphamergeFilter=vc,e.Anchors=ti,e.ApiVersion=Ti,e.AudibleContext=oa,e.AudibleContextInstance=sa,e.AudibleProbe=Lf,e.AudioClass=jh,e.AudioMediaClass=Nh,e.AudioPreviewClass=gh,e.AudioStreamType=Ke,e.AudioType=Be,e.BlobProtocol=Lc,e.ChangeAction=Ta,e.ChangeFramesAction=Fa,e.ChangeMultipleAction=Ca,e.ChromaKeyFilter=Bu,e.ClassButton=Ji,e.ClassCollapsed=Ki,e.ClassDisabled=Hi,e.ClassDropping=Yi,e.ClassDroppingAfter=$i,e.ClassDroppingBefore=Zi,e.ClassItem=Wi,e.ClassSelected=Xi,e.Clickings=ki,e.ClipClass=Rl,e.ClipSelectTypes=Et,e.ColorChannelMixerFilter=Wu,e.ColorContentClass=Il,e.ColorContentDefinitionClass=xl,e.ColorFilter=Gu,e.ColorizeFilter=Uu,e.ContainerDefinitionMixin=pl,e.ContainerMixin=ol,e.ContainerTypes=mt,e.ContentDefinitionMixin=ss,e.ContentMixin=Fl,e.ContentTypes=kt,e.ContextFactory=ua,e.ConvolutionFilter=Ju,e.CookedTypes=at,e.CropFilter=uc,e.CssContentType=ji,e.CssExtension=Ri,e.DataGroups=Oo,e.DataTypes=Gt,e.DecodeType=xc,e.DecodingClass=hl,e.DecodingTypes=nh,e.Default=Io,e.DefaultContainerId=Yo,e.DefaultContentId=ns,e.DefaultFontId=Bl,e.Directions=Zt,e.DurationProbe=Gf,e.EditTypes=Ct,e.EditorClass=zh,e.EditorSelectionClass=Mo,e.EffectClass=sl,e.EffectMediaClass=vl,e.EffectType=Ue,e.Emitter=eo,e.EmptyMethod=Ni,e.EncodeType=Ac,e.EncodingClass=Wl,e.EncodingTypes=Ot,e.Endpoints=Ci,e.ErrorName=V,e.ErrorNames=R,e.EventTypes=ci,e.ExtJpeg=zi,e.FileProtocol=Gc,e.FillTypes=jt,e.FilterClass=au,e.FilterDefinitionClass=ou,e.FilterIdPrefix=gc,e.FilterType=Ec,e.Filters=tu,e.FontClass=Zh,e.FontMediaClass=Qh,e.FontType=Le,e.FpsFilter=dc,e.GraphFileTypes=Bt,e.HttpProtocol=Bc,e.HttpsProtocol=Uc,e.IdPrefix=Li,e.IdSuffix=Gi,e.ImageClass=pf,e.ImageMediaClass=vf,e.ImageType=Ge,e.JsonExtension=Ei,e.JsonType=Ye,e.LanguageEnglish=Zf,e.LanguageType=zc,e.LoadTypes=ct,e.MashMediaClass=Th,e.MashType=He,e.MediaBase=dl,e.MediaCollection=Br,e.MediaDefaults=Nr,e.MediaFactories=_r,e.MediaInstanceBase=Qs,e.MediaTypes=Qe,e.MoveAction=Pa,e.MoveClipAction=Sa,e.Mp4Extension=Oi,e.NamespaceLink=Ui,e.NamespaceSvg=qi,e.NamespaceXhtml=Bi,e.NonePreview=ql,e.OpacityFilter=hc,e.OrderAscending=Mi,e.OrderDecending=Di,e.Orientations=Kt,e.OverlayFilter=cc,e.Parameter=eu,e.Plugins=Rc,e.PngExtension=_i,e.PointZero=hs,e.PreviewClass=Vl,e.ProbeKinds=Wf,e.ProbeType=ih,e.PropertiedClass=Pr,e.PropertyTweenSuffix=Cr,e.PropertyTypesNumeric=kr,e.ProtocolType=Dc,e.RawTypes=st,e.RecordType=Ze,e.RecordsType=$e,e.RectZero=Ts,e.RemoveClipAction=Ia,e.RequestableClass=Ar,e.ResolveType=Vc,e.Resolvers=$f,e.ScaleFilter=lc,e.SelectTypes=At,e.SequenceClass=wf,e.SequenceMediaClass=Ff,e.SequenceType=We,e.ServerTypes=di,e.SetptsFilter=pc,e.SetsarFilter=fc,e.ShapeContainerClass=Hh,e.ShapeContainerDefinitionClass=Wh,e.SizeIcon=Ka,e.SizeOutput=Wa,e.SizePreview=Ja,e.SizeProbe=Hf,e.SizeZero=Oa,e.SizingMediaTypes=ft,e.Sizings=yi,e.StandardErrorName=O,e.TextContainerId=Zo,e.TextExtension=Vi,e.TextFilter=yc,e.TimeClass=oo,e.TimeRangeClass=so,e.TimingMediaTypes=pt,e.Timings=vi,e.TrackClass=_l,e.TrackFactory=Nl,e.TrackPreviewClass=El,e.TrackPreviewHandleSize=Dl,e.TrackPreviewLineSize=zl,e.TranscodeType=Mc,e.TranscodingClass=cl,e.TranscodingTypes=it,e.TriggerTypes=ri,e.TrimFilter=mc,e.TweenableDefinitionMixin=ul,e.TweenableMixin=Fc,e.UpdatableDurationDefinitionMixin=ch,e.UpdatableDurationMediaTypes=Kl,e.UpdatableDurationMixin=th,e.UpdatableSizeDefinitionMixin=yh,e.UpdatableSizeMediaType=lh,e.UpdatableSizeMixin=mh,e.VideoClass=xf,e.VideoMediaClass=Rf,e.VideoStreamType=Xe,e.VideoType=Je,e.actionInstance=Ma,e.arrayLast=Qi,e.arrayReversed=tn,e.arraySet=en,e.arrayUnique=nn,e.assertAboveZero=ve,e.assertAction=pa,e.assertArray=ye,e.assertBoolean=te,e.assertChangeAction=wa,e.assertClientAudio=Xr,e.assertClientFont=Zr,e.assertClientImage=Jr,e.assertClientMedia=ta,e.assertClientVideo=Hr,e.assertClip=xo,e.assertContainer=is,e.assertContainerObject=Qo,e.assertContainerType=gt,e.assertContent=as,e.assertContentType=bt,e.assertConvolutionServerFilter=Xu,e.assertDataGroup=jo,e.assertDataType=Wt,e.assertDecodeOutput=Bf,e.assertDecoding=oh,e.assertDefined=ae,e.assertDirection=Qt,e.assertEditType=xt,e.assertEffect=To,e.assertEndpoint=In,e.assertFilterDefinition=nu,e.assertFont=Ll,e.assertFontMedia=Hl,e.assertIdentified=Ai,e.assertInteger=ce,e.assertLoadType=ht,e.assertLoaderType=Qr,e.assertMashMedia=ha,e.assertMedia=Rr,e.assertMediaType=tt,e.assertMethod=ne,e.assertMoveAction=Aa,e.assertNumber=Q,e.assertObject=K,e.assertPlugin=_c,e.assertPoint=cs,e.assertPopulatedArray=we,e.assertPopulatedObject=Se,e.assertPopulatedString=Te,e.assertPositive=fe,e.assertProbeOptions=Kf,e.assertProbeOutput=Yf,e.assertProbing=uh,e.assertProperty=qo,e.assertRect=gs,e.assertRequest=zn,e.assertRgb=xe,e.assertSelectType=Dt,e.assertSize=Va,e.assertSizeAboveZero=Ha,e.assertString=Y,e.assertTime=Me,e.assertTimeRange=ze,e.assertTrack=Fo,e.assertTranscodingType=rt,e.assertTrue=Ce,e.assertTweenable=mo,e.assertTweenableDefinition=go,e.assertTyped=Lr,e.assertUpdatableDuration=Yl,e.assertUpdatableDurationDefinition=Ql,e.assertUpdatableSize=fh,e.assertUpdatableSizeDefinition=vh,e.assertValue=Re,e.assertValueObject=_e,e.assertVideo=Pc,e.assertVideoMedia=Ic,e.audioDefinition=qh,e.audioDefinitionFromId=Bh,e.audioFromId=Lh,e.audioInstance=Uh,e.audioPreviewInstance=kh,e.centerPoint=Is,e.clipInstance=Ol,e.colorBlack=Qn,e.colorBlackOpaque=rr,e.colorBlackTransparent=ir,e.colorBlue=ur,e.colorFromRgb=vr,e.colorGreen=ar,e.colorMixRbg=gr,e.colorMixRbga=yr,e.colorRed=sr,e.colorRgbDifference=mr,e.colorRgbKeys=Yn,e.colorRgbToHex=cr,e.colorRgbaKeys=Zn,e.colorRgbaToHex=lr,e.colorToRgb=dr,e.colorToRgba=pr,e.colorTransparent=$n,e.colorValid=hr,e.colorValidHex=fr,e.colorWhite=er,e.colorWhiteOpaque=nr,e.colorWhiteTransparent=tr,e.colorYellow=or,e.commandFilesInput=$s,e.commandFilesInputIndex=Zs,e.decodingInstance=fl,e.editorArgs=Eh,e.editorInstance=Vh,e.editorSelectionInstance=Do,e.effectDefinition=yl,e.effectDefinitionFromId=gl,e.effectFromId=Tl,e.effectInstance=kl,e.encodingInstance=Jl,e.endpointAbsolute=Mn,e.endpointFromAbsolute=Pn,e.endpointFromUrl=xn,e.endpointIsAbsolute=An,e.endpointUrl=Cn,e.error=U,e.errorCaught=L,e.errorMessage=j,e.errorName=B,e.errorObject=N,e.errorObjectCaught=q,e.errorPromise=G,e.errorThrow=W,e.eventStop=Ml,e.filePromises=Dh,e.filterDefinition=kc,e.filterDefinitionFromId=Tc,e.filterFromId=wc,e.filterInstance=bc,e.fontDefault=ff,e.fontDefinition=hf,e.fontDefinitionFromId=df,e.fontFind=lf,e.idGenerate=Jo,e.idGenerateString=Wo,e.idIsTemporary=Xo,e.idTemporary=Ko,e.imageDefinition=gf,e.imageDefinitionFromId=kf,e.imageFromId=bf,e.imageFromVideoPromise=Vf,e.imageInstance=Tf,e.isAboveZero=pe,e.isAction=da,e.isActionEvent=ma,e.isActionInit=va,e.isArray=me,e.isAudio=bl,e.isAudioMedia=wl,e.isBelowOne=de,e.isBoolean=ee,e.isChangeAction=ba,e.isChangeActionObject=ka,e.isClientAudio=Kr,e.isClientFont=Yr,e.isClientImage=Wr,e.isClientMedia=ea,e.isClientVideo=Gr,e.isClip=Po,e.isClipObject=Co,e.isClipSelectType=Vt,e.isColorContent=Sl,e.isContainer=ts,e.isContainerDefinition=es,e.isContainerObject=$o,e.isContainerType=yt,e.isContent=rs,e.isContentDefinition=os,e.isContentType=Tt,e.isConvolutionServerFilter=Ku,e.isCookedType=ot,e.isDataGroup=_o,e.isDataType=Ht,e.isDecodeOutput=qf,e.isDecoding=ah,e.isDecodingType=rh,e.isDefined=re,e.isDefiniteError=qe,e.isDirection=$t,e.isEditType=Pt,e.isEffect=ko,e.isEffectMedia=bo,e.isEndpoint=Sn,e.isErrorName=_,e.isEventType=li,e.isFillType=Nt,e.isFilterDefinition=iu,e.isFloat=le,e.isFont=Ul,e.isFontMedia=Gl,e.isGraphFileType=Ut,e.isIdentified=xi,e.isImage=Fh,e.isImageMedia=Sh,e.isInteger=ue,e.isJsonRecord=je,e.isJsonRecords=Ne,e.isLoadType=lt,e.isLoaderType=$r,e.isMashAndMediaObject=ca,e.isMashMedia=la,e.isMedia=Vr,e.isMediaInstance=zr,e.isMediaInstanceObject=Dr,e.isMediaObject=Er,e.isMediaType=et,e.isMethod=ie,e.isMoveAction=xa,e.isNan=oe,e.isNumber=se,e.isNumberOrNaN=$,e.isNumeric=Ie,e.isObject=J,e.isOrientation=Xt,e.isOutput=Pi,e.isPlugin=Oc,e.isPoint=us,e.isPopulatedArray=be,e.isPopulatedObject=Fe,e.isPopulatedString=ke,e.isPositive=he,e.isProbeOptions=Jf,e.isProbeOutput=Xf,e.isProbing=sh,e.isPropertied=xr,e.isProperty=No,e.isRawMedia=na,e.isRawType=ut,e.isRect=ys,e.isRequest=Dn,e.isRequestable=Vn,e.isRequestableObject=En,e.isRgb=Pe,e.isSelectType=Mt,e.isSelectedProperty=Rh,e.isShapeContainer=Gh,e.isSize=Ea,e.isSizingMediaType=dt,e.isString=X,e.isTime=Ae,e.isTimeRange=De,e.isTimingMediaType=vt,e.isTrack=wo,e.isTranscodeOutput=nd,e.isTranscoding=Mr,e.isTranscodingType=nt,e.isTriggerType=ai,e.isTrueValue=Ve,e.isTweenable=vo,e.isTweenableDefinition=yo,e.isTyped=Ur,e.isUndefined=Z,e.isUpdatableDuration=Xl,e.isUpdatableDurationDefinition=$l,e.isUpdatableDurationType=Zl,e.isUpdatableSize=hh,e.isUpdatableSizeDefinition=ph,e.isUpdatableSizeType=dh,e.isValue=Ee,e.isValueObject=Oe,e.isVideo=Cc,e.isVideoMedia=Sc,e.mashDefault=bh,e.mashMedia=wh,e.mediaDefinition=jr,e.mediaInfo=Mh,e.mediaTypeFromMime=Ih,e.pixelToFrame=Al,e.plugin=Nc,e.pluginId=jc,e.pluginPromise=qc,e.pointCopy=fs,e.pointNegate=ms,e.pointRound=ds,e.pointString=ps,e.pointValueString=vs,e.pointsEqual=ls,e.propertyInstance=Lo,e.propertyTypeCoerce=Ir,e.propertyTypeDefault=wr,e.propertyTypeIsString=br,e.propertyTypeValid=Sr,e.protocolLoadPromise=Hc,e.rectCopy=Fs,e.rectFromSize=bs,e.rectRound=Ss,e.rectString=Cs,e.rectsEqual=ks,e.rectsFromSizes=ws,e.requestAudioPromise=Xc,e.requestExtension=Jc,e.requestFontPromise=Yc,e.requestImagePromise=Zc,e.requestMediaPromise=rl,e.requestPromise=al,e.requestProtocol=Kc,e.requestProtocolPromise=$c,e.requestRawPromise=nl,e.requestRecordPromise=tl,e.requestRecordsPromise=il,e.requestVideoPromise=el,e.resolverExtension=id,e.resolverLoad=Qf,e.resolverPathPromise=td,e.resolverPromise=ed,e.roundMethod=to,e.roundWithMethod=io,e.selectedPropertiesScalarObject=_h,e.selectedPropertyObject=Oh,e.sequenceDefinition=Sf,e.sequenceDefinitionFromId=If,e.sequenceFromId=Pf,e.sequenceInstance=Cf,e.sizeAboveZero=Ga,e.sizeCeil=qa,e.sizeCopy=Xa,e.sizeCover=La,e.sizeEven=ja,e.sizeFloor=Ba,e.sizeFromElement=Qa,e.sizeLock=Ya,e.sizeLockNegative=$a,e.sizeRound=Na,e.sizeScale=Ua,e.sizeString=Za,e.sizedEven=_a,e.sizesEqual=Ra,e.sortByFrame=zo,e.sortByIndex=Eo,e.sortByLabel=Ro,e.sortByTrack=Vo,e.stringFamilySizeRect=Kh,e.stringPluralize=Xh,e.stringSeconds=Jh,e.svgAddClass=Du,e.svgAppend=Su,e.svgDefsElement=Cu,e.svgDifferenceDefs=Au,e.svgElement=uu,e.svgElementInitialize=cu,e.svgFeImageElement=Pu,e.svgFilter=Fu,e.svgFilterElement=xu,e.svgFunc=Ou,e.svgGroupElement=fu,e.svgId=lu,e.svgImageElement=Tu,e.svgImagePromise=ju,e.svgImagePromiseWithOptions=qu,e.svgMaskElement=wu,e.svgPathElement=bu,e.svgPatternElement=Iu,e.svgPolygonElement=mu,e.svgRectPoints=vu,e.svgSet=Mu,e.svgSetBox=yu,e.svgSetChildren=_u,e.svgSetDimensions=du,e.svgSetDimensionsLock=ku,e.svgSetTransform=Eu,e.svgSetTransformPoint=pu,e.svgSetTransformRects=Ru,e.svgSvgElement=gu,e.svgText=Nu,e.svgTransform=Vu,e.svgUrl=hu,e.svgUseElement=zu,e.timeEqualizeRates=ao,e.timeFromArgs=fo,e.timeFromSeconds=po,e.timeRangeFromArgs=uo,e.timeRangeFromSeconds=co,e.timeRangeFromTime=lo,e.timeRangeFromTimes=ho,e.trackInstance=jl,e.transcodingInstance=ll,e.tweenColorStep=As,e.tweenColors=Ds,e.tweenCoverPoints=Gs,e.tweenCoverSizes=Ls,e.tweenInputTime=Ys,e.tweenMaxSize=Es,e.tweenMinMax=Xs,e.tweenMinSize=Vs,e.tweenNumberObject=js,e.tweenNumberStep=xs,e.tweenOption=Rs,e.tweenOverPoint=qs,e.tweenOverRect=Ns,e.tweenOverSize=Bs,e.tweenPad=Ps,e.tweenPosition=_s,e.tweenRectLock=Hs,e.tweenRectStep=Ms,e.tweenRects=zs,e.tweenRectsLock=Ws,e.tweenScaleSizeRatioLock=Js,e.tweenScaleSizeToRect=Us,e.tweenableRects=Os,e.tweeningPoints=Ks,e.urlBase=an,e.urlBaseInitialize=on,e.urlBaseInitialized=sn,e.urlCombine=dn,e.urlEndpoint=un,e.urlExtension=bn,e.urlFilename=wn,e.urlForEndpoint=mn,e.urlFromCss=Fn,e.urlFromEndpoint=vn,e.urlHasProtocol=fn,e.urlIsBlob=hn,e.urlIsHttp=ln,e.urlIsObject=cn,e.urlOptions=kn,e.urlOptionsObject=gn,e.urlPrependProtocol=Tn,e.urlProtocol=yn,e.urlResolve=pn,e.videoDefinition=Of,e.videoDefinitionFromId=_f,e.videoFromId=Nf,e.videoInstance=jf}(t)}}]);
//# sourceMappingURL=982.032b4307.chunk.js.map